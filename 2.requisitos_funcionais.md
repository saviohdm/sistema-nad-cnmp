# Especifica√ß√£o de Requisitos Funcionais
## Sistema de Acompanhamento de Proposi√ß√µes - CNMP

**Vers√£o:** 1.5
**Data:** 10/12/2025
**Projeto:** Sistema NAD - N√∫cleo de Acompanhamento de Decis√µes
**Organiza√ß√£o:** Conselho Nacional do Minist√©rio P√∫blico (CNMP)

---

## Hist√≥rico de Revis√µes

| Vers√£o | Data | Autor | Descri√ß√£o |
|--------|------|-------|-----------|
| 1.0 | 10/12/2025 | Documenta√ß√£o T√©cnica | Parte 2.1 - Introdu√ß√£o, Autentica√ß√£o e Dashboard |
| 1.1 | 10/12/2025 | Documenta√ß√£o T√©cnica | Parte 2.2 - Gest√£o de Correi√ß√µes e Proposi√ß√µes |
| 1.2 | 10/12/2025 | Documenta√ß√£o T√©cnica | Parte 2.3 - Workflows de Publica√ß√£o, Comprova√ß√£o e Avalia√ß√£o |
| 1.3 | 10/12/2025 | Documenta√ß√£o T√©cnica | Parte 2.4 - Busca, Exporta√ß√£o, Hist√≥rico e Notifica√ß√µes |
| 1.4 | 10/12/2025 | Documenta√ß√£o T√©cnica | Parte 2.5 - Casos de Uso Detalhados (10 casos de uso) |
| 1.5 | 10/12/2025 | Documenta√ß√£o T√©cnica | Parte 2.6 - Regras de Neg√≥cio Consolidadas (110 regras) e Matriz de Rastreabilidade |

---

## Sum√°rio

1. [Introdu√ß√£o](#1-introdu√ß√£o)
2. [Requisitos Funcionais](#2-requisitos-funcionais)
   - 2.1 [RF-AUTH: Autentica√ß√£o e Controle de Acesso](#21-rf-auth-autentica√ß√£o-e-controle-de-acesso)
   - 2.2 [RF-DASH: Dashboard Executivo](#22-rf-dash-dashboard-executivo)
   - 2.3 [RF-COR: Gest√£o de Correi√ß√µes](#23-rf-cor-gest√£o-de-correi√ß√µes) *(A elaborar)*
   - 2.4 [RF-PROP: Gest√£o de Proposi√ß√µes](#24-rf-prop-gest√£o-de-proposi√ß√µes) *(A elaborar)*
   - 2.5 [RF-PUB: Publica√ß√£o de Proposi√ß√µes](#25-rf-pub-publica√ß√£o-de-proposi√ß√µes) *(A elaborar)*
   - 2.6 [RF-COMP: Comprova√ß√£o](#26-rf-comp-comprova√ß√£o) *(A elaborar)*
   - 2.7 [RF-AVAL: Avalia√ß√£o](#27-rf-aval-avalia√ß√£o) *(A elaborar)*
   - 2.8 [RF-BUSCA: Busca e Filtros](#28-rf-busca-busca-e-filtros) *(A elaborar)*
   - 2.9 [RF-EXP: Exporta√ß√£o de Dados](#29-rf-exp-exporta√ß√£o-de-dados) *(A elaborar)*
   - 2.10 [RF-HIST: Hist√≥rico e Auditoria](#210-rf-hist-hist√≥rico-e-auditoria) *(A elaborar)*
   - 2.11 [RF-NOTIF: Notifica√ß√µes](#211-rf-notif-notifica√ß√µes) *(A elaborar)*
3. [Casos de Uso Detalhados](#3-casos-de-uso-detalhados) *(A elaborar)*
4. [Regras de Neg√≥cio Consolidadas](#4-regras-de-neg√≥cio-consolidadas) *(A elaborar)*
5. [Matriz de Rastreabilidade](#5-matriz-de-rastreabilidade) *(A elaborar)*

---

## 1. Introdu√ß√£o

### 1.1 Prop√≥sito

Este documento especifica todos os requisitos funcionais do **Sistema de Acompanhamento de Proposi√ß√µes** do Conselho Nacional do Minist√©rio P√∫blico (CNMP). O objetivo √© fornecer √† equipe de desenvolvimento uma descri√ß√£o completa e inequ√≠voca de todas as funcionalidades que o sistema deve implementar.

**P√∫blico-alvo:**
- Equipe de desenvolvimento da f√°brica de software
- Analistas de sistemas e arquitetos
- Equipe de testes e qualidade
- Gerentes de projeto
- Stakeholders t√©cnicos do CNMP

### 1.2 Escopo

Este documento cobre os requisitos funcionais de todos os m√≥dulos do sistema:
- Autentica√ß√£o e controle de acesso
- Dashboard executivo com indicadores e gr√°ficos
- Gest√£o de correi√ß√µes (CRUD completo)
- Gest√£o de proposi√ß√µes (CRUD completo)
- Workflow de publica√ß√£o de proposi√ß√µes
- Workflow de comprova√ß√£o de cumprimento
- Workflow de avalia√ß√£o de comprova√ß√µes
- Sistema de busca e filtros avan√ßados
- Sistema de exporta√ß√£o de dados (JSON/PDF)
- Sistema de hist√≥rico e auditoria
- Sistema de notifica√ß√µes

**N√£o est√£o cobertos neste documento:**
- Requisitos n√£o-funcionais (performance, seguran√ßa, etc.) - ver documento espec√≠fico
- Especifica√ß√µes de interface (wireframes, design) - ver documento espec√≠fico
- Arquitetura t√©cnica do sistema - ver documento de arquitetura
- Modelo de dados - ver `modelo_de_dados.md`

### 1.3 Conven√ß√µes do Documento

#### 1.3.1 Identificadores de Requisitos

Cada requisito funcional possui um identificador √∫nico no formato:

**RF-[M√ìDULO]-[N√öMERO]**

Exemplos:
- `RF-AUTH-001` - Primeiro requisito do m√≥dulo de autentica√ß√£o
- `RF-DASH-005` - Quinto requisito do m√≥dulo de dashboard
- `RF-COR-012` - D√©cimo segundo requisito do m√≥dulo de correi√ß√µes

#### 1.3.2 Prioridades

Cada requisito √© classificado com uma das seguintes prioridades:

| Prioridade | Sigla | Descri√ß√£o |
|------------|-------|-----------|
| **Essencial** | [E] | Requisito cr√≠tico para o MVP. Sistema n√£o funciona sem ele. |
| **Importante** | [I] | Requisito necess√°rio para opera√ß√£o completa. Pode ser entregue em Fase 2. |
| **Desej√°vel** | [D] | Requisito que agrega valor mas n√£o √© essencial. Pode ser entregue em fases posteriores. |

#### 1.3.3 Estrutura de Cada Requisito

Cada requisito funcional √© documentado com a seguinte estrutura:

**RF-XXX-NNN: [Nome do Requisito]**
- **Prioridade:** [E/I/D]
- **Descri√ß√£o:** Descri√ß√£o detalhada do requisito
- **Entrada:** Dados de entrada necess√°rios
- **Processamento:** L√≥gica de processamento a ser executada
- **Sa√≠da:** Resultado esperado
- **Regras de Neg√≥cio:** Refer√™ncias a regras aplic√°veis (RN-XXX)
- **Crit√©rios de Aceite:** Condi√ß√µes que devem ser satisfeitas para considerar o requisito implementado

#### 1.3.4 Refer√™ncias a Outros Documentos

- **[VIS]** - Documento de Vis√£o do Produto (`visao_do_produto.md`)
- **[MD]** - Modelo de Dados (`modelo_de_dados.md`)
- **[RN]** - Regra de Neg√≥cio (definida no modelo de dados ou neste documento)
- **[UC]** - Caso de Uso (definido na se√ß√£o 3 deste documento)

### 1.4 Vis√£o Geral

O Sistema de Acompanhamento de Proposi√ß√µes implementa um workflow completo de gest√£o de correi√ß√µes e proposi√ß√µes com tr√™s atores principais:

**Atores:**
1. **Administrador (Corregedoria Nacional)** - Gerencia correi√ß√µes, publica proposi√ß√µes, avalia comprova√ß√µes
2. **Usu√°rio (MP Correicionado)** - Visualiza proposi√ß√µes, envia comprova√ß√µes
3. **Sistema** - Executa opera√ß√µes autom√°ticas (c√°lculo de status, notifica√ß√µes, etc.)

**Fluxo Principal:**
```
1. Admin cadastra Correi√ß√£o
2. Admin cadastra e publica Proposi√ß√µes para MP
3. MP recebe notifica√ß√£o e visualiza Proposi√ß√£o
4. MP prepara e envia Comprova√ß√£o
5. Admin recebe notifica√ß√£o e avalia Comprova√ß√£o
6. Sistema registra decis√£o e atualiza status
7. Se parcial/em_andamento: retorna ao passo 2 (republica√ß√£o)
8. Se finalizada/prejudicada: ciclo encerrado
```

---

## 2. Requisitos Funcionais

### 2.1 RF-AUTH: Autentica√ß√£o e Controle de Acesso

#### RF-AUTH-001: Login de Usu√°rio

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir que usu√°rios autentiquem-se atrav√©s de sele√ß√£o de MP e senha.
- **Entrada:**
  - MP selecionado (dropdown com 27 op√ß√µes + "Corregedoria Nacional")
  - Senha (campo texto, tipo password)
- **Processamento:**
  1. Validar que MP foi selecionado
  2. Validar que senha foi preenchida
  3. Verificar credenciais no banco de dados
  4. Se v√°lido: criar sess√£o de usu√°rio
  5. Se inv√°lido: exibir mensagem de erro
- **Sa√≠da:**
  - Sucesso: Redirecionamento para dashboard + sess√£o criada
  - Falha: Mensagem "Credenciais inv√°lidas. Tente novamente."
- **Regras de Neg√≥cio:**
  - RN-AUTH-01: Senha deve ter m√≠nimo 8 caracteres
  - RN-AUTH-02: Ap√≥s 5 tentativas falhas, bloquear conta por 15 minutos
  - RN-AUTH-03: Sess√£o expira ap√≥s 8 horas de inatividade
- **Crit√©rios de Aceite:**
  - ‚úì Admin consegue fazer login selecionando "Corregedoria Nacional"
  - ‚úì Usu√°rio consegue fazer login selecionando seu MP (ex: "MPBA")
  - ‚úì Credenciais inv√°lidas exibem mensagem de erro clara
  - ‚úì Ap√≥s login bem-sucedido, usu√°rio √© redirecionado para dashboard
  - ‚úì Sess√£o persiste ao navegar entre p√°ginas

---

#### RF-AUTH-002: Logout de Usu√°rio

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir que usu√°rios encerrem sua sess√£o de forma segura.
- **Entrada:** Clique no bot√£o "Sair" no menu de usu√°rio
- **Processamento:**
  1. Destruir sess√£o atual
  2. Limpar dados de autentica√ß√£o (localStorage/sessionStorage)
  3. Redirecionar para p√°gina de login
- **Sa√≠da:** Usu√°rio redirecionado para tela de login sem sess√£o ativa
- **Regras de Neg√≥cio:**
  - RN-AUTH-04: Logout deve limpar todos os tokens de sess√£o
  - RN-AUTH-05: Ap√≥s logout, bot√£o "Voltar" do navegador n√£o deve restaurar sess√£o
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "Sair" vis√≠vel em todas as p√°ginas autenticadas
  - ‚úì Ap√≥s logout, tentativa de acessar p√°ginas protegidas redireciona para login
  - ‚úì Dados sens√≠veis s√£o limpos do navegador

---

#### RF-AUTH-003: Controle de Acesso por Perfil

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve controlar o acesso √†s funcionalidades baseado no perfil do usu√°rio (Admin ou Usu√°rio).
- **Entrada:** Perfil do usu√°rio autenticado
- **Processamento:**
  1. Identificar perfil do usu√°rio na sess√£o
  2. Renderizar menu lateral com itens permitidos para o perfil
  3. Bloquear acesso direto a URLs restritas
- **Sa√≠da:** Interface personalizada conforme perfil
- **Regras de Neg√≥cio:**
  - RN-AUTH-06: Perfil Admin tem acesso total
  - RN-AUTH-07: Perfil Usu√°rio tem acesso restrito (sem p√°ginas de cadastro, publica√ß√£o e avalia√ß√£o)
  - RN-AUTH-08: Tentativa de acesso n√£o autorizado deve redirecionar para p√°gina apropriada com mensagem
- **Crit√©rios de Aceite:**
  - ‚úì **Admin v√™ no menu:** Dashboard, Correi√ß√µes, Proposi√ß√µes, Publicar, Avaliar, Cadastro de Correi√ß√£o, Cadastro de Proposi√ß√£o
  - ‚úì **Usu√°rio v√™ no menu:** Dashboard, Correi√ß√µes, Proposi√ß√µes, Enviar Comprova√ß√£o
  - ‚úì Usu√°rio tentando acessar `/publicacao.html` √© redirecionado para `index.html` com erro
  - ‚úì Usu√°rio tentando acessar `/avaliacao.html` √© redirecionado para `index.html` com erro

---

#### RF-AUTH-004: Filtragem de Dados por Perfil

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve filtrar dados exibidos conforme o perfil do usu√°rio.
- **Entrada:** Perfil e ramoMP do usu√°rio autenticado
- **Processamento:**
  1. Se perfil = Admin: exibir todos os dados
  2. Se perfil = Usu√°rio: exibir apenas dados do seu ramoMP
- **Sa√≠da:** Listas e dropdowns filtrados
- **Regras de Neg√≥cio:**
  - RN-AUTH-09: Admin visualiza todas as correi√ß√µes de todos os MPs
  - RN-AUTH-10: Usu√°rio visualiza apenas correi√ß√µes onde `correicao.ramoMP = usuario.ramoMP`
  - RN-AUTH-11: Usu√°rio visualiza apenas proposi√ß√µes vinculadas √†s suas correi√ß√µes
- **Crit√©rios de Aceite:**
  - ‚úì Admin logado v√™ todas as 27 correi√ß√µes cadastradas
  - ‚úì Usu√°rio MPBA logado v√™ apenas correi√ß√µes onde `ramoMP = 'MPBA'`
  - ‚úì Filtros em dashboards e dropdowns respeitam regra de visibilidade
  - ‚úì API backend valida permiss√µes (n√£o apenas frontend)

---

#### RF-AUTH-005: Persist√™ncia de Sess√£o

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve manter a sess√£o do usu√°rio ativa entre navega√ß√µes e recarregamentos de p√°gina.
- **Entrada:** Token de sess√£o armazenado localmente
- **Processamento:**
  1. Ao carregar qualquer p√°gina, verificar exist√™ncia de sess√£o v√°lida
  2. Se sess√£o v√°lida: restaurar contexto do usu√°rio
  3. Se sess√£o inv√°lida ou expirada: redirecionar para login
- **Sa√≠da:** Usu√°rio permanece autenticado durante navega√ß√£o normal
- **Regras de Neg√≥cio:**
  - RN-AUTH-03: Sess√£o expira ap√≥s 8 horas de inatividade
  - RN-AUTH-12: Sess√£o n√£o deve expirar se usu√°rio estiver ativo
  - RN-AUTH-13: Token deve ser renovado a cada intera√ß√£o
- **Crit√©rios de Aceite:**
  - ‚úì Recarregar p√°gina (F5) n√£o desloga usu√°rio
  - ‚úì Navegar entre p√°ginas mant√©m sess√£o ativa
  - ‚úì Ap√≥s 8 horas sem intera√ß√£o, pr√≥ximo acesso requer novo login
  - ‚úì Fechar e reabrir navegador mant√©m sess√£o (se dentro do prazo)

---

#### RF-AUTH-006: Identifica√ß√£o de Usu√°rio na Interface

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve exibir claramente a identidade do usu√°rio logado na interface.
- **Entrada:** Dados do usu√°rio autenticado (ramoMP, ramoMPNome)
- **Processamento:**
  1. Renderizar √°rea de usu√°rio no cabe√ßalho
  2. Exibir nome do MP e perfil (Admin/Usu√°rio)
  3. Incluir bot√£o de logout
- **Sa√≠da:** Box de usu√°rio vis√≠vel no topo direito da interface
- **Regras de Neg√≥cio:** N/A
- **Crit√©rios de Aceite:**
  - ‚úì Nome completo do MP exibido (ex: "MPBA - Minist√©rio P√∫blico do Estado da Bahia")
  - ‚úì Badge de perfil vis√≠vel (ex: "Administrador" ou "Usu√°rio")
  - ‚úì Bot√£o "Sair" acess√≠vel no mesmo componente
  - ‚úì Componente vis√≠vel em todas as p√°ginas autenticadas

---

### 2.2 RF-DASH: Dashboard Executivo

#### RF-DASH-001: Visualiza√ß√£o de Indicadores Principais

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir 5 cards de indicadores principais no dashboard com dados em tempo real.
- **Entrada:** Filtro de correi√ß√£o selecionado (ou "Todas")
- **Processamento:**
  1. Buscar todas as correi√ß√µes e proposi√ß√µes aplicando filtro de correi√ß√£o
  2. Aplicar filtro de perfil do usu√°rio (Admin v√™ tudo, Usu√°rio v√™ apenas seu MP)
  3. Calcular 5 m√©tricas:
     - **Correi√ß√µes Realizadas:** COUNT(correicoes)
     - **Correi√ß√µes Ativas:** COUNT(correicoes WHERE status='ativo')
     - **Total de Proposi√ß√µes:** COUNT(proposicoes)
     - **Proposi√ß√µes Ativas:** COUNT(proposicoes WHERE statusProcessual != 'encerrada')
     - **Prazo Vencido:** COUNT(proposicoes WHERE statusProcessual='aguardando_comprovacao' AND prazoComprovacao < HOJE)
  4. Renderizar cards com valores e √≠cones
- **Sa√≠da:** 5 cards exibidos em grid responsivo
- **Regras de Neg√≥cio:**
  - RN-DASH-01: C√°lculos devem refletir estado atual do banco de dados
  - RN-DASH-02: Se filtro de correi√ß√£o ativo, apenas dados dessa correi√ß√£o s√£o considerados
  - RN-DASH-03: Card "Prazo Vencido" deve ter destaque visual (vermelho) se valor > 0
- **Crit√©rios de Aceite:**
  - ‚úì Cards exibidos em ordem: Correi√ß√µes Realizadas, Ativas, Total Proposi√ß√µes, Ativas, Prazo Vencido
  - ‚úì √çcones apropriados: üèõÔ∏è, üîÑ, üìÑ, üî•, ‚ö†Ô∏è
  - ‚úì Valores atualizados ao mudar filtro de correi√ß√£o
  - ‚úì Card "Prazo Vencido" com fundo vermelho se > 0
  - ‚úì Layout responsivo: 5 colunas desktop, 2 colunas tablet, 1 coluna mobile

---

#### RF-DASH-002: Filtro de Dashboard por Correi√ß√£o

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir filtrar todos os dados do dashboard por uma correi√ß√£o espec√≠fica.
- **Entrada:**
  - Dropdown de correi√ß√µes (op√ß√£o padr√£o: "Todas as Correi√ß√µes")
  - Correi√ß√µes listadas conforme perfil do usu√°rio
- **Processamento:**
  1. Ao carregar dashboard, popular dropdown com correi√ß√µes dispon√≠veis
  2. Ao selecionar correi√ß√£o:
     - Armazenar filtro no estado da aplica√ß√£o
     - Recalcular todos os indicadores
     - Redesenhar ambos os gr√°ficos
  3. Ao selecionar "Todas as Correi√ß√µes":
     - Limpar filtro
     - Exibir dados agregados
- **Sa√≠da:** Dashboard atualizado refletindo o filtro aplicado
- **Regras de Neg√≥cio:**
  - RN-DASH-04: Dropdown deve listar apenas correi√ß√µes vis√≠veis ao usu√°rio (conforme perfil)
  - RN-DASH-05: Filtro deve persistir ao navegar entre p√°ginas do dashboard
  - RN-DASH-06: Ao cadastrar nova correi√ß√£o, dropdown deve ser atualizado
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown posicionado acima dos cards de indicadores
  - ‚úì Primeira op√ß√£o √© "Todas as Correi√ß√µes" (padr√£o selecionado)
  - ‚úì Admin v√™ todas as correi√ß√µes no dropdown
  - ‚úì Usu√°rio v√™ apenas correi√ß√µes do seu MP
  - ‚úì Ao selecionar correi√ß√£o espec√≠fica, cards e gr√°ficos atualizam dinamicamente
  - ‚úì Indicador visual de filtro ativo (ex: badge "Filtro: COR-2024-01")

---

#### RF-DASH-003: Gr√°fico de Fluxo de Trabalho

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir gr√°fico de barras mostrando distribui√ß√£o de proposi√ß√µes por status processual.
- **Entrada:** Proposi√ß√µes filtradas (por correi√ß√£o e perfil)
- **Processamento:**
  1. Contar proposi√ß√µes por statusProcessual:
     - Pendente
     - Aguardando Comprova√ß√£o
     - Em An√°lise
     - Encerrada
  2. Calcular largura proporcional das barras (base 100%)
  3. Renderizar gr√°fico com 4 barras coloridas verticalmente
- **Sa√≠da:** Gr√°fico de barras verticais com t√≠tulo "Fluxo de Trabalho"
- **Regras de Neg√≥cio:**
  - RN-DASH-07: Cores devem seguir padr√£o:
    - Pendente: amarelo (#ffc107)
    - Aguardando Comprova√ß√£o: laranja escuro (#ff8c00)
    - Em An√°lise: azul (#0066cc)
    - Encerrada: azul escuro (#003366)
  - RN-DASH-08: Altura da barra proporcional ao valor (escala autom√°tica)
  - RN-DASH-09: Exibir r√≥tulo com n√∫mero absoluto acima de cada barra
- **Crit√©rios de Aceite:**
  - ‚úì Gr√°fico exibido no lado esquerdo do grid de gr√°ficos
  - ‚úì 4 barras verticais com cores distintas
  - ‚úì R√≥tulos claros: "Pendente (4)", "Aguardando Comprova√ß√£o (5)", etc.
  - ‚úì Gr√°fico atualiza ao mudar filtro de correi√ß√£o
  - ‚úì Eixo Y escala automaticamente baseado no valor m√°ximo
  - ‚úì Legenda ou tooltip ao passar mouse sobre barra

---

#### RF-DASH-004: Gr√°fico de Valora√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir gr√°fico de barras mostrando distribui√ß√£o de proposi√ß√µes por valora√ß√£o.
- **Entrada:** Proposi√ß√µes filtradas (por correi√ß√£o e perfil)
- **Processamento:**
  1. Contar proposi√ß√µes por valoracao:
     - Nova
     - Finalizada
     - Parcial
     - Em Andamento
     - Prejudicada
  2. Calcular largura proporcional das barras (base 100%)
  3. Renderizar gr√°fico com 5 barras coloridas verticalmente
- **Sa√≠da:** Gr√°fico de barras verticais com t√≠tulo "Valora√ß√£o"
- **Regras de Neg√≥cio:**
  - RN-DASH-10: Cores devem seguir padr√£o:
    - Nova: cinza (#6c757d)
    - Finalizada: verde (#28a745)
    - Parcial: laranja (#ffa500)
    - Em Andamento: vermelho (#dc3545)
    - Prejudicada: cinza escuro (#495057)
  - RN-DASH-11: Altura da barra proporcional ao valor (escala autom√°tica)
  - RN-DASH-12: Exibir r√≥tulo com n√∫mero absoluto acima de cada barra
- **Crit√©rios de Aceite:**
  - ‚úì Gr√°fico exibido no lado direito do grid de gr√°ficos
  - ‚úì 5 barras verticais com cores distintas
  - ‚úì R√≥tulos claros: "Nova (8)", "Finalizada (2)", "Parcial (1)", etc.
  - ‚úì Gr√°fico atualiza ao mudar filtro de correi√ß√£o
  - ‚úì Eixo Y escala automaticamente baseado no valor m√°ximo
  - ‚úì Legenda ou tooltip ao passar mouse sobre barra

---

#### RF-DASH-005: Layout Responsivo de Gr√°ficos

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve adaptar o layout dos gr√°ficos conforme tamanho da tela.
- **Entrada:** Resolu√ß√£o da tela do usu√°rio
- **Processamento:**
  1. Detectar largura da janela do navegador
  2. Se > 768px: renderizar gr√°ficos lado a lado (2 colunas)
  3. Se ‚â§ 768px: renderizar gr√°ficos empilhados (1 coluna)
- **Sa√≠da:** Layout de gr√°ficos adaptado ao dispositivo
- **Regras de Neg√≥cio:**
  - RN-DASH-13: Breakpoint mobile: 768px
  - RN-DASH-14: Gr√°ficos devem manter propor√ß√µes leg√≠veis em qualquer resolu√ß√£o
- **Crit√©rios de Aceite:**
  - ‚úì Desktop (1920x1080): gr√°ficos lado a lado, cada um 50% largura
  - ‚úì Tablet (768x1024): gr√°ficos lado a lado
  - ‚úì Mobile (375x667): gr√°ficos empilhados verticalmente, 100% largura cada
  - ‚úì Redimensionar janela atualiza layout dinamicamente
  - ‚úì Gr√°ficos permanecem leg√≠veis em todas as resolu√ß√µes

---

#### RF-DASH-006: Atualiza√ß√£o Din√¢mica do Dashboard

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve atualizar automaticamente o dashboard ap√≥s opera√ß√µes que alterem dados.
- **Entrada:** Evento de altera√ß√£o de dados (cadastro, edi√ß√£o, publica√ß√£o, avalia√ß√£o)
- **Processamento:**
  1. Detectar opera√ß√£o que alterou dados
  2. Recalcular todos os indicadores
  3. Redesenhar gr√°ficos
  4. Atualizar contadores
- **Sa√≠da:** Dashboard refletindo estado atual sem necessidade de refresh manual
- **Regras de Neg√≥cio:**
  - RN-DASH-15: Atualiza√ß√£o deve ocorrer ao voltar para p√°gina do dashboard
  - RN-DASH-16: Atualiza√ß√£o n√£o deve causar flicker percept√≠vel na interface
- **Crit√©rios de Aceite:**
  - ‚úì Ap√≥s cadastrar correi√ß√£o, contador "Correi√ß√µes Realizadas" incrementa
  - ‚úì Ap√≥s publicar proposi√ß√£o, contadores e gr√°ficos atualizam
  - ‚úì Ap√≥s avaliar comprova√ß√£o, gr√°fico de Valora√ß√£o atualiza
  - ‚úì Transi√ß√£o visual suave (sem flash)
  - ‚úì Filtro de correi√ß√£o mant√©m estado ap√≥s atualiza√ß√£o

---

#### RF-DASH-007: Navega√ß√£o R√°pida a partir de Indicadores

- **Prioridade:** [D] Desej√°vel
- **Descri√ß√£o:** O sistema deve permitir navega√ß√£o direta ao clicar em cards de indicadores.
- **Entrada:** Clique em card de indicador
- **Processamento:**
  1. Identificar card clicado
  2. Navegar para p√°gina relevante com filtro aplicado
  3. Exemplos:
     - "Prazo Vencido" ‚Üí Proposi√ß√µes filtradas por prazo vencido
     - "Correi√ß√µes Ativas" ‚Üí Correi√ß√µes filtradas por status ativo
- **Sa√≠da:** Navega√ß√£o para lista filtrada
- **Regras de Neg√≥cio:**
  - RN-DASH-17: Filtro aplicado deve ser visualmente claro na p√°gina destino
  - RN-DASH-18: Usu√°rio deve poder limpar filtro facilmente
- **Crit√©rios de Aceite:**
  - ‚úì Cards s√£o clic√°veis (cursor pointer ao hover)
  - ‚úì Clicar em "Prazo Vencido" abre p√°gina de Proposi√ß√µes com filtro ativo
  - ‚úì Badge visual indica filtro aplicado (ex: "Filtro: Prazo Vencido")
  - ‚úì Bot√£o "Limpar Filtro" dispon√≠vel

---

### 2.3 RF-COR: Gest√£o de Correi√ß√µes

#### RF-COR-001: Cadastro de Nova Correi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir ao administrador cadastrar uma nova correi√ß√£o com todos os campos obrigat√≥rios e opcionais.
- **Entrada:** Formul√°rio com 12 campos:
  - N√∫mero (texto, obrigat√≥rio)
  - Ramo do MP (dropdown 27 MPs, obrigat√≥rio)
  - Tem√°tica (textarea, opcional)
  - N√∫mero ELO (texto com m√°scara, opcional)
  - Tipo (dropdown: Ordin√°ria/Extraordin√°ria/OCD/Inspe√ß√£o, obrigat√≥rio)
  - MP (radio: MPE/MPU, obrigat√≥rio)
  - UF (select: single para MPE, multiple para MPU, obrigat√≥rio)
  - Data In√≠cio (date, obrigat√≥rio)
  - Data Fim (date, opcional)
  - Observa√ß√µes (textarea 5000 caracteres, opcional)
- **Processamento:**
  1. Validar todos os campos obrigat√≥rios
  2. Validar formato do N√∫mero ELO (NNNNNNN-DD.AAAA.J.TT.OOOO)
  3. Validar que Data Fim ‚â• Data In√≠cio (se preenchida)
  4. Validar UF: 1 para MPE, ‚â•1 para MPU
  5. Gerar ID √∫nico sequencial
  6. Definir status inicial como 'ativo' (default)
  7. Salvar no banco de dados
  8. Atualizar listas e dropdowns no sistema
- **Sa√≠da:**
  - Sucesso: Mensagem "Correi√ß√£o cadastrada com sucesso!" + redirect para tabela
  - Falha: Mensagem de erro espec√≠fica do campo inv√°lido
- **Regras de Neg√≥cio:**
  - [MD] RN-COR-01: Campo `numero` deve ser √∫nico
  - [MD] RN-COR-02: N√∫mero ELO deve seguir formato espec√≠fico
  - [MD] RN-COR-03: MPE ‚Üí 1 UF obrigat√≥rio
  - [MD] RN-COR-04: MPU ‚Üí m√∫ltiplos UFs permitidos
  - [MD] RN-COR-06: Data Fim ‚â• Data In√≠cio
  - [MD] RN-COR-07: UF deve ser c√≥digo v√°lido (27 estados)
- **Crit√©rios de Aceite:**
  - ‚úì Formul√°rio renderizado com todos os campos
  - ‚úì Valida√ß√£o HTML5 funciona (campos required)
  - ‚úì Dropdown UF muda comportamento: MPE=single, MPU=multiple
  - ‚úì N√∫mero duplicado exibe erro: "Este n√∫mero j√° existe"
  - ‚úì N√∫mero ELO inv√°lido exibe erro com formato esperado
  - ‚úì Ap√≥s salvar, correi√ß√£o aparece na tabela imediatamente
  - ‚úì Dropdown de correi√ß√µes em outras p√°ginas √© atualizado

---

#### RF-COR-002: Listagem de Correi√ß√µes em Tabela

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir todas as correi√ß√µes em tabela de 13 colunas com dados completos e indicadores visuais.
- **Entrada:** Filtros aplicados (busca, status) e ordem de classifica√ß√£o
- **Processamento:**
  1. Buscar correi√ß√µes do banco aplicando filtro de perfil
  2. Aplicar filtro de busca textual (se preenchido)
  3. Aplicar filtro de status (se selecionado)
  4. Aplicar ordena√ß√£o conforme coluna clicada
  5. Para cada correi√ß√£o, calcular estat√≠sticas de proposi√ß√µes:
     - Total de proposi√ß√µes
     - Pendente (statusProcessual='pendente')
     - Em An√°lise (statusProcessual='em_analise')
     - Prazo Vencido (statusProcessual='aguardando_comprovacao' AND prazoComprovacao < HOJE)
  6. Renderizar linhas da tabela
- **Sa√≠da:** Tabela HTML com 13 colunas:
  1. N√∫mero
  2. Tem√°tica
  3. N√∫mero ELO
  4. Tipo
  5. MP
  6. UF
  7. Ramo do MP
  8. Total de Proposi√ß√µes
  9. Pendente (amarelo se > 0)
  10. Em An√°lise (azul se > 0)
  11. Prazo Vencido (vermelho se > 0)
  12. Status (badge ativo/inativo)
  13. A√ß√µes (bot√£o "Ver")
- **Regras de Neg√≥cio:**
  - RN-COR-08: Colunas Pendente, Em An√°lise, Prazo Vencido devem ter destaque visual se > 0
  - RN-COR-09: Status √© calculado automaticamente (n√£o edit√°vel pelo usu√°rio)
  - RN-COR-10: Admin v√™ todas, Usu√°rio v√™ apenas do seu MP
- **Crit√©rios de Aceite:**
  - ‚úì Tabela exibe todas as 13 colunas
  - ‚úì UF array renderizado como string separada por v√≠rgula (ex: "DF, SP, RJ")
  - ‚úì Colunas Pendente/Em An√°lise/Prazo Vencido com cor e negrito quando > 0
  - ‚úì Badge de status com cores: ativo=verde, inativo=cinza
  - ‚úì Bot√£o "Ver" abre modal de detalhes
  - ‚úì Tabela responsiva (scroll horizontal em mobile)

---

#### RF-COR-003: Ordena√ß√£o de Tabela por Colunas

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir ordenar a tabela de correi√ß√µes clicando em cabe√ßalhos de 5 colunas espec√≠ficas.
- **Entrada:** Clique em cabe√ßalho de coluna orden√°vel
- **Processamento:**
  1. Identificar coluna clicada
  2. Verificar dire√ß√£o atual (sem ordem / asc / desc)
  3. Se sem ordem: aplicar ordem ascendente
  4. Se asc: inverter para descendente
  5. Se desc: voltar para ascendente
  6. Re-renderizar tabela com nova ordem
  7. Atualizar indicadores visuais (‚ñ≤/‚ñº)
- **Sa√≠da:** Tabela reordenada + indicador visual de ordena√ß√£o
- **Regras de Neg√≥cio:**
  - RN-COR-11: Colunas orden√°veis: N√∫mero, Total de Proposi√ß√µes, Pendente, Em An√°lise, Prazo Vencido
  - RN-COR-12: Apenas uma coluna pode estar ordenada por vez
  - RN-COR-13: Ordena√ß√£o persiste ao aplicar filtros
- **Crit√©rios de Aceite:**
  - ‚úì Cabe√ßalhos orden√°veis mostram √≠cone ‚áÖ (hover)
  - ‚úì Cabe√ßalho ativo mostra ‚ñ≤ (asc) ou ‚ñº (desc)
  - ‚úì Clicar em "N√∫mero" ordena alfabeticamente (COR-2024-01, COR-2024-02...)
  - ‚úì Clicar em "Total de Proposi√ß√µes" ordena numericamente
  - ‚úì Clicar em "Prazo Vencido" mostra correi√ß√µes com mais prazos vencidos primeiro
  - ‚úì Cursor pointer em cabe√ßalhos orden√°veis

---

#### RF-COR-004: Filtro de Correi√ß√µes por Status

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir filtrar a tabela de correi√ß√µes por status (ativo/inativo).
- **Entrada:** Dropdown com 3 op√ß√µes:
  - "Todas (ativas e inativas)" - padr√£o
  - "Apenas Ativas"
  - "Apenas Inativas"
- **Processamento:**
  1. Ao mudar sele√ß√£o do dropdown:
  2. Armazenar filtro no estado
  3. Filtrar lista de correi√ß√µes conforme valor
  4. Re-renderizar tabela
  5. Manter ordena√ß√£o e busca textual aplicadas
- **Sa√≠da:** Tabela exibindo apenas correi√ß√µes do status selecionado
- **Regras de Neg√≥cio:**
  - RN-COR-14: Filtro de status trabalha em conjunto (AND) com busca textual
  - RN-COR-15: Contador de resultados deve refletir quantidade filtrada
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown posicionado acima da tabela
  - ‚úì Op√ß√£o padr√£o √© "Todas (ativas e inativas)"
  - ‚úì Selecionar "Apenas Ativas" mostra apenas status=ativo
  - ‚úì Selecionar "Apenas Inativas" mostra apenas status=inativo
  - ‚úì Contador exibe: "Exibindo X de Y correi√ß√µes"
  - ‚úì Filtro funciona em conjunto com busca textual

---

#### RF-COR-005: Busca Textual de Correi√ß√µes

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir busca textual em m√∫ltiplos campos das correi√ß√µes.
- **Entrada:** Campo de texto com placeholder "Buscar por n√∫mero, MP, tem√°tica..."
- **Processamento:**
  1. Capturar texto digitado (com debounce de 300ms)
  2. Normalizar texto (lowercase, remover acentos)
  3. Filtrar correi√ß√µes onde texto aparece em:
     - numero
     - ramoMP
     - ramoMPNome
     - tematica
     - numeroElo
     - tipo
  4. Re-renderizar tabela
  5. Manter filtro de status e ordena√ß√£o
- **Sa√≠da:** Tabela exibindo apenas correi√ß√µes que correspondem √† busca
- **Regras de Neg√≥cio:**
  - RN-COR-16: Busca √© case-insensitive
  - RN-COR-17: Busca ignora acentua√ß√£o
  - RN-COR-18: Busca funciona em conjunto (AND) com filtro de status
  - RN-COR-19: Busca vazia exibe todas as correi√ß√µes (respeitando filtros)
- **Crit√©rios de Aceite:**
  - ‚úì Campo de busca posicionado acima da tabela
  - ‚úì √çcone de lupa no campo
  - ‚úì Buscar "MPBA" encontra correi√ß√µes do MPBA
  - ‚úì Buscar "meio ambiente" encontra correi√ß√µes com esta tem√°tica
  - ‚úì Buscar "ordin√°ria" encontra correi√ß√µes do tipo Ordin√°ria
  - ‚úì Contador mostra quantidade de resultados encontrados
  - ‚úì Limpar campo restaura lista completa

---

#### RF-COR-006: Visualiza√ß√£o de Detalhes da Correi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir modal com detalhes completos da correi√ß√£o e estat√≠sticas de proposi√ß√µes.
- **Entrada:** Clique no bot√£o "Ver" em qualquer linha da tabela
- **Processamento:**
  1. Identificar ID da correi√ß√£o clicada
  2. Buscar dados completos da correi√ß√£o
  3. Buscar todas as proposi√ß√µes vinculadas
  4. Calcular estat√≠sticas por status processual (4 categorias)
  5. Calcular estat√≠sticas por valora√ß√£o (5 categorias)
  6. Renderizar modal com 3 se√ß√µes organizadas
- **Sa√≠da:** Modal com:
  - **Se√ß√£o 1: Informa√ß√µes da Correi√ß√£o**
    - Todos os 12 campos exibidos
  - **Se√ß√£o 2: Status Processual**
    - Pendente, Aguardando Comprova√ß√£o, Em An√°lise, Encerrada (com contadores coloridos)
  - **Se√ß√£o 3: Valora√ß√£o**
    - Nova, Finalizada, Parcial, Em Andamento, Prejudicada (com contadores coloridos)
- **Regras de Neg√≥cio:**
  - RN-COR-20: Cores dos contadores devem seguir padr√£o de badges
  - RN-COR-21: Valores zero devem ser exibidos (n√£o ocultar)
  - RN-COR-22: UF array deve ser formatado como lista leg√≠vel
- **Crit√©rios de Aceite:**
  - ‚úì Modal ocupa ~70% da largura da tela
  - ‚úì Bot√£o "X" fecha o modal
  - ‚úì Se√ß√µes visualmente separadas com t√≠tulos
  - ‚úì Contadores de status processual com 4 valores
  - ‚úì Contadores de valora√ß√£o com 5 valores
  - ‚úì Cores alinhadas com badges do sistema
  - ‚úì Clicar fora do modal tamb√©m fecha

---

#### RF-COR-007: C√°lculo Autom√°tico de Status da Correi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve calcular automaticamente o status da correi√ß√£o (ativo/inativo) baseado no estado de suas proposi√ß√µes.
- **Entrada:** Estado atual de todas as proposi√ß√µes vinculadas √† correi√ß√£o
- **Processamento:**
  1. Buscar todas as proposi√ß√µes da correi√ß√£o
  2. Verificar valora√ß√£o de cada proposi√ß√£o
  3. Se existe pelo menos 1 proposi√ß√£o com valora√ß√£o != (finalizada OU prejudicada):
     - Status = 'ativo'
  4. Se todas as proposi√ß√µes t√™m valora√ß√£o = (finalizada OU prejudicada):
     - Status = 'inativo'
  5. Se n√£o h√° proposi√ß√µes vinculadas:
     - Status = 'ativo' (default)
  6. Atualizar campo status no banco
- **Sa√≠da:** Campo `status` da correi√ß√£o atualizado
- **Regras de Neg√≥cio:**
  - [MD] RN-COR-05: Status √© calculado, nunca editado manualmente
  - RN-COR-23: Rec√°lculo deve ocorrer ap√≥s qualquer altera√ß√£o em proposi√ß√£o
  - RN-COR-24: Rec√°lculo deve ocorrer ap√≥s avalia√ß√£o de comprova√ß√£o
  - RN-COR-25: Correi√ß√£o sem proposi√ß√µes √© considerada 'ativo'
- **Crit√©rios de Aceite:**
  - ‚úì Cadastrar correi√ß√£o sem proposi√ß√µes ‚Üí status = 'ativo'
  - ‚úì Avaliar √∫ltima proposi√ß√£o como 'finalizada' ‚Üí status = 'inativo'
  - ‚úì Publicar nova proposi√ß√£o em correi√ß√£o inativa ‚Üí status volta para 'ativo'
  - ‚úì Avaliar proposi√ß√£o como 'parcial' ‚Üí status permanece 'ativo'
  - ‚úì N√£o existe interface para editar status manualmente

---

#### RF-COR-008: Valida√ß√£o de Campos no Cadastro

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve validar todos os campos do formul√°rio de correi√ß√£o antes de salvar.
- **Entrada:** Dados preenchidos no formul√°rio
- **Processamento:**
  1. **Valida√ß√µes obrigat√≥rias:**
     - N√∫mero: n√£o vazio, √∫nico no sistema
     - Ramo do MP: selecionado
     - Tipo: selecionado
     - MP: selecionado (MPE ou MPU)
     - UF: pelo menos 1 selecionado
     - Data In√≠cio: preenchida, formato v√°lido
  2. **Valida√ß√µes opcionais (se preenchidas):**
     - N√∫mero ELO: formato NNNNNNN-DD.AAAA.J.TT.OOOO
     - Data Fim: ‚â• Data In√≠cio
     - Observa√ß√µes: ‚â§ 5.000 caracteres
  3. **Valida√ß√µes de consist√™ncia:**
     - Se MP=MPE: exatamente 1 UF
     - Se MP=MPU: pelo menos 1 UF
  4. Exibir erros espec√≠ficos por campo
- **Sa√≠da:**
  - V√°lido: Salvar dados
  - Inv√°lido: Exibir mensagens de erro abaixo dos campos
- **Regras de Neg√≥cio:**
  - [MD] RN-COR-01 a RN-COR-07 (ver modelo de dados)
  - RN-COR-26: Valida√ß√£o deve ocorrer no frontend E backend
  - RN-COR-27: Mensagens de erro devem ser claras e orientativas
- **Crit√©rios de Aceite:**
  - ‚úì Tentar salvar sem n√∫mero exibe: "Campo obrigat√≥rio"
  - ‚úì N√∫mero duplicado exibe: "Este n√∫mero j√° existe no sistema"
  - ‚úì N√∫mero ELO inv√°lido exibe: "Formato esperado: NNNNNNN-DD.AAAA.J.TT.OOOO"
  - ‚úì Data Fim anterior a Data In√≠cio exibe: "Data fim deve ser posterior √† data in√≠cio"
  - ‚úì MPE com 2 UFs selecionados exibe: "MPE deve ter apenas 1 estado"
  - ‚úì Observa√ß√µes > 5.000 caracteres exibe contador vermelho + erro
  - ‚úì Valida√ß√µes tamb√©m ocorrem no backend (n√£o apenas frontend)

---

#### RF-COR-009: Edi√ß√£o de Correi√ß√£o Existente

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir ao administrador editar uma correi√ß√£o existente.
- **Entrada:**
  - A√ß√£o: Bot√£o "Editar" no modal de detalhes ou na linha da tabela
  - Formul√°rio pr√©-preenchido com dados atuais
- **Processamento:**
  1. Abrir formul√°rio de edi√ß√£o
  2. Preencher campos com valores atuais
  3. Permitir altera√ß√£o de todos os campos exceto:
     - ID (imut√°vel)
     - Status (calculado automaticamente)
  4. Validar altera√ß√µes (mesmas regras de cadastro)
  5. Salvar altera√ß√µes no banco
  6. Atualizar todas as visualiza√ß√µes
- **Sa√≠da:**
  - Sucesso: "Correi√ß√£o atualizada com sucesso!"
  - Falha: Mensagem de erro espec√≠fica
- **Regras de Neg√≥cio:**
  - RN-COR-28: Editar correi√ß√£o n√£o altera proposi√ß√µes vinculadas
  - RN-COR-29: Todas as valida√ß√µes de cadastro se aplicam
  - RN-COR-30: N√£o √© poss√≠vel editar correi√ß√£o se usu√°rio n√£o tiver permiss√£o (apenas admin)
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "Editar" vis√≠vel apenas para admin
  - ‚úì Formul√°rio abre pr√©-preenchido
  - ‚úì Alterar tem√°tica e salvar atualiza na tabela
  - ‚úì N√£o √© poss√≠vel alterar status manualmente
  - ‚úì Valida√ß√µes funcionam igual ao cadastro
  - ‚úì Ap√≥s salvar, modal de detalhes reflete mudan√ßas

---

#### RF-COR-010: Exclus√£o de Correi√ß√£o

- **Prioridade:** [D] Desej√°vel
- **Descri√ß√£o:** O sistema deve permitir excluir correi√ß√£o que n√£o possua proposi√ß√µes vinculadas.
- **Entrada:** Bot√£o "Excluir" no modal de detalhes ou linha da tabela
- **Processamento:**
  1. Verificar se correi√ß√£o possui proposi√ß√µes vinculadas
  2. Se possui: exibir erro e bloquear exclus√£o
  3. Se n√£o possui:
     - Exibir confirma√ß√£o: "Tem certeza que deseja excluir a correi√ß√£o [numero]?"
     - Se confirmar: excluir do banco
     - Se cancelar: manter correi√ß√£o
  4. Atualizar listas e dropdowns
- **Sa√≠da:**
  - Sucesso: "Correi√ß√£o exclu√≠da com sucesso!"
  - Bloqueado: "N√£o √© poss√≠vel excluir correi√ß√£o com proposi√ß√µes vinculadas"
- **Regras de Neg√≥cio:**
  - [MD] RI-02: N√£o permitir excluir correi√ß√£o com proposi√ß√µes vinculadas
  - RN-COR-31: Exclus√£o √© permanente (n√£o h√° lixeira)
  - RN-COR-32: Apenas admin pode excluir
  - RN-COR-33: Exclus√£o requer confirma√ß√£o expl√≠cita
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "Excluir" vis√≠vel apenas para admin
  - ‚úì Tentar excluir correi√ß√£o com proposi√ß√µes exibe erro claro
  - ‚úì Excluir correi√ß√£o sem proposi√ß√µes funciona ap√≥s confirma√ß√£o
  - ‚úì Dialog de confirma√ß√£o com bot√µes "Cancelar" e "Confirmar Exclus√£o"
  - ‚úì Ap√≥s exclus√£o, correi√ß√£o n√£o aparece mais em nenhuma lista

---

### 2.4 RF-PROP: Gest√£o de Proposi√ß√µes

#### RF-PROP-001: Cadastro de Nova Proposi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir ao administrador cadastrar uma nova proposi√ß√£o vinculada a uma correi√ß√£o.
- **Entrada:** Formul√°rio com 9 campos:
  - N√∫mero (texto, obrigat√≥rio, √∫nico)
  - Correi√ß√£o (dropdown, obrigat√≥rio)
  - Tipo (dropdown: Determina√ß√£o/Recomenda√ß√£o, obrigat√≥rio)
  - Unidade (texto 200 chars, obrigat√≥rio)
  - Membro (texto 200 chars, obrigat√≥rio)
  - Descri√ß√£o (textarea 5000 chars, obrigat√≥rio)
  - Prioridade (dropdown: urgente/alta/normal, obrigat√≥rio, default: normal)
  - Tags (checkboxes m√∫ltiplas, 11 op√ß√µes, opcional)
- **Processamento:**
  1. Validar todos os campos obrigat√≥rios
  2. Validar que correi√ß√£o existe
  3. Validar que n√∫mero √© √∫nico
  4. Gerar ID √∫nico sequencial
  5. Definir status inicial: ['pendente', 'nova']
  6. Inicializar arrays vazios: historico=[], rascunhos=[]
  7. Definir prazoComprovacao=null, dataPublicacao=null
  8. Salvar no banco de dados
  9. Recalcular status da correi√ß√£o vinculada
  10. Atualizar dropdowns e listas
- **Sa√≠da:**
  - Sucesso: "Proposi√ß√£o cadastrada com sucesso!" + redirect
  - Falha: Mensagem de erro espec√≠fica
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-01: N√∫mero deve ser √∫nico
  - [MD] RN-PROP-02: Toda proposi√ß√£o deve estar vinculada a correi√ß√£o v√°lida
  - [MD] RN-PROP-03: Status inicial sempre ['pendente', 'nova']
  - [MD] RN-PROP-09: Tags devem conter apenas valores predefinidos (11 tags)
  - [MD] RN-PROP-10: Descri√ß√£o limitada a 5.000 caracteres
- **Crit√©rios de Aceite:**
  - ‚úì Formul√°rio renderizado com todos os campos
  - ‚úì Dropdown de correi√ß√£o lista apenas correi√ß√µes dispon√≠veis conforme perfil
  - ‚úì Dropdown de tipo mostra apenas 2 op√ß√µes
  - ‚úì Checkboxes de tags exibem 11 op√ß√µes com cores distintas
  - ‚úì N√∫mero duplicado exibe erro claro
  - ‚úì Contador de caracteres para descri√ß√£o (verde‚Üíamarelo‚Üívermelho)
  - ‚úì Ap√≥s salvar, proposi√ß√£o aparece em todas as listagens
  - ‚úì Status da correi√ß√£o vinculada √© recalculado

---

#### RF-PROP-002: P√°gina Dedicada de Proposi√ß√µes

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir p√°gina standalone (proposicoes.html) para visualiza√ß√£o e gest√£o de proposi√ß√µes.
- **Entrada:** Clique em "Proposi√ß√µes" no menu lateral
- **Processamento:**
  1. Redirecionar para `proposicoes.html`
  2. Carregar dados de localStorage
  3. Restaurar sess√£o do usu√°rio
  4. Exibir estado inicial: placeholder "Selecione uma Correi√ß√£o"
  5. Ocultar filtros e tabela at√© sele√ß√£o de correi√ß√£o
- **Sa√≠da:** P√°gina dedicada com:
  - Sidebar com navega√ß√£o
  - Breadcrumb "‚Üê Voltar para Dashboard"
  - Dropdown de sele√ß√£o de correi√ß√£o (obrigat√≥rio)
  - √Årea de filtros (oculta inicialmente)
  - Tabela de proposi√ß√µes (oculta inicialmente)
- **Regras de Neg√≥cio:**
  - RN-PROP-01: Sele√ß√£o de correi√ß√£o √© obrigat√≥ria para visualizar proposi√ß√µes
  - RN-PROP-02: P√°gina √© standalone (n√£o modal)
  - RN-PROP-03: Dados carregados de localStorage
  - RN-PROP-04: Sess√£o persiste entre navega√ß√µes
- **Crit√©rios de Aceite:**
  - ‚úì Clicar em "Proposi√ß√µes" no menu redireciona para proposicoes.html
  - ‚úì P√°gina carrega independentemente do index.html
  - ‚úì Placeholder vis√≠vel antes de selecionar correi√ß√£o
  - ‚úì Breadcrumb funcional retorna para index.html
  - ‚úì Sess√£o do usu√°rio restaurada automaticamente
  - ‚úì Recarregar p√°gina (F5) mant√©m sess√£o

---

#### RF-PROP-003: Sele√ß√£o Obrigat√≥ria de Correi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exigir sele√ß√£o de correi√ß√£o antes de exibir proposi√ß√µes.
- **Entrada:** Dropdown de correi√ß√µes no topo da p√°gina
- **Processamento:**
  1. Popular dropdown com correi√ß√µes dispon√≠veis (conforme perfil)
  2. Incluir op√ß√£o vazia: "Selecione uma correi√ß√£o..."
  3. Ao selecionar correi√ß√£o:
     - Buscar dados da correi√ß√£o
     - Exibir painel informativo (tem√°tica, per√≠odo, total proposi√ß√µes)
     - Mostrar √°rea de filtros
     - Renderizar tabela com proposi√ß√µes vinculadas
  4. Ao desselecionar (voltar para op√ß√£o vazia):
     - Ocultar painel, filtros e tabela
     - Mostrar placeholder novamente
- **Sa√≠da:**
  - Sem sele√ß√£o: Placeholder vis√≠vel
  - Com sele√ß√£o: Painel info + filtros + tabela vis√≠veis
- **Regras de Neg√≥cio:**
  - RN-PROP-05: Progressive disclosure (mostrar informa√ß√£o progressivamente)
  - RN-PROP-06: Filtros s√≥ aparecem ap√≥s sele√ß√£o de correi√ß√£o
  - RN-PROP-07: Tabela s√≥ mostra proposi√ß√µes da correi√ß√£o selecionada
- **Crit√©rios de Aceite:**
  - ‚úì Estado inicial: placeholder "Selecione uma Correi√ß√£o" + filtros/tabela ocultos
  - ‚úì Selecionar correi√ß√£o: painel info aparece + filtros/tabela aparecem
  - ‚úì Painel info mostra: tem√°tica, per√≠odo (dataInicio-dataFim), total de proposi√ß√µes
  - ‚úì Desselecionar correi√ß√£o: volta para estado inicial
  - ‚úì Dropdown lista apenas correi√ß√µes do perfil do usu√°rio

---

#### RF-PROP-004: Tabela Simplificada de 7 Colunas

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir proposi√ß√µes em tabela simplificada focada em informa√ß√µes essenciais.
- **Entrada:** Correi√ß√£o selecionada + filtros aplicados
- **Processamento:**
  1. Buscar proposi√ß√µes onde correicaoId = correi√ß√£o selecionada
  2. Aplicar filtros (busca, tipo, status, tag, prioridade)
  3. Para cada proposi√ß√£o, renderizar linha com 7 colunas
  4. Aplicar destaque visual conforme prioridade
- **Sa√≠da:** Tabela HTML com 7 colunas:
  1. **N√∫mero** - identificador √∫nico
  2. **Tipo** - badge Determina√ß√£o/Recomenda√ß√£o
  3. **Unidade** - √≥rg√£o respons√°vel
  4. **Descri√ß√£o** - texto truncado (100 chars) com retic√™ncias
  5. **Tags** - badges coloridos (m√°x 3 vis√≠veis + contador)
  6. **Status** - badges bidimensionais empilhados (processual + valora√ß√£o)
  7. **A√ß√µes** - 3 bot√µes: üëÅÔ∏è Visualizar, ‚öñÔ∏è Avaliar, ‚úèÔ∏è Editar
- **Regras de Neg√≥cio:**
  - RN-PROP-08: Tabela mostra apenas proposi√ß√µes da correi√ß√£o selecionada
  - RN-PROP-09: Descri√ß√£o truncada em 100 caracteres
  - RN-PROP-10: Prioridade urgente tem destaque visual (fundo vermelho claro)
  - RN-PROP-11: Status bidimensional sempre vis√≠vel (2 badges)
- **Crit√©rios de Aceite:**
  - ‚úì Tabela exibe exatamente 7 colunas
  - ‚úì Descri√ß√£o truncada com "..." se > 100 chars
  - ‚úì Tags renderizadas como badges coloridos
  - ‚úì Se > 3 tags, exibir "+X" ao final
  - ‚úì Status exibido como 2 badges empilhados verticalmente
  - ‚úì Linha com prioridade=urgente tem fundo diferenciado
  - ‚úì 3 bot√µes de a√ß√£o vis√≠veis e funcionais

---

#### RF-PROP-005: A√ß√£o "Visualizar" - Modal de Detalhes

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir modal com detalhes completos da proposi√ß√£o e timeline.
- **Entrada:** Clique no bot√£o "üëÅÔ∏è Visualizar" em qualquer linha
- **Processamento:**
  1. Identificar ID da proposi√ß√£o
  2. Buscar dados completos (incluindo correi√ß√£o vinculada)
  3. Renderizar modal com 3 se√ß√µes:
     - Informa√ß√µes da Proposi√ß√£o (todos os campos)
     - Informa√ß√µes da Correi√ß√£o (dados b√°sicos)
     - Timeline Completa (hist√≥rico cronol√≥gico)
  4. Renderizar timeline com cores diferenciadas:
     - üì§ Publica√ß√£o (fundo laranja)
     - üìé Comprova√ß√£o (fundo azul)
     - ‚öñÔ∏è Avalia√ß√£o (fundo verde)
- **Sa√≠da:** Modal fullscreen com scroll interno
- **Regras de Neg√≥cio:**
  - RN-PROP-12: Timeline em ordem cronol√≥gica (mais antigo ‚Üí mais recente)
  - RN-PROP-13: Cada entrada mostra: √≠cone, data, usu√°rio, descri√ß√£o, observa√ß√µes
  - RN-PROP-14: Publica√ß√µes mostram prazoComprovacao
  - RN-PROP-15: Comprova√ß√µes mostram lista de arquivos anexados
  - RN-PROP-16: Avalia√ß√µes mostram transi√ß√£o de status
- **Crit√©rios de Aceite:**
  - ‚úì Modal ocupa 90% da tela
  - ‚úì Se√ß√£o 1: todos os campos da proposi√ß√£o vis√≠veis
  - ‚úì Se√ß√£o 2: n√∫mero, tem√°tica, ramoMP da correi√ß√£o
  - ‚úì Se√ß√£o 3: timeline com cores diferenciadas
  - ‚úì Cada item da timeline tem √≠cone, data formatada, usu√°rio, textos
  - ‚úì Bot√£o "X" e clicar fora fecham o modal
  - ‚úì Modal tem scroll interno se conte√∫do muito grande

---

#### RF-PROP-006: A√ß√£o "Avaliar" - Redirecionamento

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve redirecionar para p√°gina de avalia√ß√£o ao clicar em "Avaliar".
- **Entrada:** Clique no bot√£o "‚öñÔ∏è Avaliar" em qualquer linha
- **Processamento:**
  1. Identificar ID da proposi√ß√£o
  2. Construir URL: `avaliacao.html?id={proposicaoId}`
  3. Redirecionar navegador
  4. P√°gina de avalia√ß√£o carrega proposi√ß√£o via query string
- **Sa√≠da:** Redirecionamento para avaliacao.html
- **Regras de Neg√≥cio:**
  - RN-PROP-17: Bot√£o "Avaliar" dispon√≠vel para qualquer status (n√£o apenas em_analise)
  - RN-PROP-18: Usu√°rio comum n√£o v√™ este bot√£o (apenas admin)
  - RN-PROP-19: Avalia√ß√£o pode ocorrer a qualquer momento (flexibilidade)
- **Crit√©rios de Aceite:**
  - ‚úì Clicar em "Avaliar" redireciona para avaliacao.html?id=X
  - ‚úì Bot√£o vis√≠vel apenas para admin
  - ‚úì Bot√£o dispon√≠vel independente do status da proposi√ß√£o
  - ‚úì Redirecionamento preserva sess√£o do usu√°rio

---

#### RF-PROP-007: A√ß√£o "Editar" - Modal Inline

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve exibir modal de edi√ß√£o para alterar metadata da proposi√ß√£o.
- **Entrada:** Clique no bot√£o "‚úèÔ∏è Editar" em qualquer linha
- **Processamento:**
  1. Identificar ID da proposi√ß√£o
  2. Abrir modal com formul√°rio pr√©-preenchido
  3. Campos edit√°veis:
     - Tipo (dropdown)
     - Prioridade (dropdown)
     - Unidade (texto)
     - Membro (texto)
     - Descri√ß√£o (textarea com contador)
     - Tags (checkboxes)
  4. Campo readonly:
     - N√∫mero (exibido mas n√£o edit√°vel)
  5. Validar altera√ß√µes
  6. Salvar no localStorage
  7. Re-renderizar tabela
- **Sa√≠da:**
  - Sucesso: "Proposi√ß√£o atualizada com sucesso!" + modal fecha + tabela atualiza
  - Falha: Mensagem de erro espec√≠fica
- **Regras de Neg√≥cio:**
  - RN-PROP-20: Apenas admin pode editar
  - RN-PROP-21: N√∫mero da proposi√ß√£o n√£o pode ser alterado
  - RN-PROP-22: Editar n√£o altera status, hist√≥rico ou rascunhos
  - RN-PROP-23: Contador de caracteres em tempo real (5.000 m√°x)
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "Editar" vis√≠vel apenas para admin
  - ‚úì Modal abre com formul√°rio pr√©-preenchido
  - ‚úì Campo "N√∫mero" exibido mas readonly (cinza)
  - ‚úì Alterar descri√ß√£o atualiza contador: verde (0-4000), amarelo (4001-4900), vermelho (4901-5000)
  - ‚úì Selecionar/desselecionar tags reflete imediatamente
  - ‚úì Bot√£o "Cancelar" fecha modal sem salvar
  - ‚úì Bot√£o "Salvar" valida + salva + fecha + atualiza tabela

---

#### RF-PROP-008: Sistema de Tags

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve implementar sistema de categoriza√ß√£o com 11 tags predefinidas.
- **Entrada:** Checkboxes de tags no formul√°rio de cadastro/edi√ß√£o
- **Processamento:**
  1. Renderizar 11 checkboxes com badges visuais:
     - administrativo, recursos-humanos, infraestrutura
     - tecnologia, processual, financeiro
     - capacitacao, gestao-documental, compliance
     - transparencia, outros
  2. Permitir sele√ß√£o m√∫ltipla
  3. Salvar array de IDs das tags selecionadas
  4. Renderizar badges coloridos na tabela
- **Sa√≠da:**
  - Formul√°rio: Checkboxes com badges coloridos
  - Tabela: Badges coloridos (m√°x 3 + contador)
  - Filtro: Dropdown com 11 tags
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-09: Apenas tags predefinidas s√£o permitidas
  - RN-PROP-24: Proposi√ß√£o pode ter 0 a 11 tags
  - RN-PROP-25: Tags n√£o podem ser criadas pelo usu√°rio (fixas)
  - RN-PROP-26: Cada tag tem cor espec√≠fica (definida no CSS)
- **Crit√©rios de Aceite:**
  - ‚úì Cadastro/edi√ß√£o mostra 11 checkboxes com badges
  - ‚úì Tabela renderiza at√© 3 badges + "+X restantes"
  - ‚úì Cada tag tem cor distinta e leg√≠vel
  - ‚úì Filtro por tag funciona (ver RF-PROP-010)
  - ‚úì Proposi√ß√£o sem tags exibe "-" na coluna

---

#### RF-PROP-009: Status Bidimensional

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir status em formato bidimensional (processual + valora√ß√£o).
- **Entrada:** Campo `status` da proposi√ß√£o (array de 2 elementos)
- **Processamento:**
  1. Extrair statusProcessual (√≠ndice 0)
  2. Extrair valoracao (√≠ndice 1)
  3. Renderizar 2 badges empilhados verticalmente:
     - Badge superior: statusProcessual
     - Badge inferior: valoracao
  4. Aplicar cores conforme padr√£o:
     - **Processual:** pendente (amarelo), aguardando_comprovacao (laranja), em_analise (azul), encerrada (azul escuro)
     - **Valora√ß√£o:** nova (cinza), finalizada (verde), parcial (laranja), em_andamento (vermelho), prejudicada (cinza escuro)
- **Sa√≠da:** Container com 2 badges empilhados
- **Regras de Neg√≥cio:**
  - [MD] Status √© array: [statusProcessual, valoracao]
  - RN-PROP-27: Ambos badges sempre vis√≠veis
  - RN-PROP-28: Cores fixas conforme padr√£o
  - RN-PROP-29: Ordem fixa: processual em cima, valora√ß√£o embaixo
- **Crit√©rios de Aceite:**
  - ‚úì Status renderizado como 2 badges empilhados
  - ‚úì Badge superior mostra status processual com cor correta
  - ‚úì Badge inferior mostra valora√ß√£o com cor correta
  - ‚úì Container tem espa√ßamento adequado entre badges
  - ‚úì Cores acess√≠veis (contraste adequado)

---

#### RF-PROP-010: Filtros Avan√ßados de Proposi√ß√µes

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve fornecer 5 filtros independentes combinados com l√≥gica AND.
- **Entrada:** 5 campos de filtro acima da tabela:
  1. **Busca textual** (input texto)
  2. **Tipo** (dropdown: todas/determina√ß√£o/recomenda√ß√£o)
  3. **Status** (dropdown: todos/valores de processual/valores de valora√ß√£o)
  4. **Tags** (dropdown: todas/11 tags)
  5. **Prioridade** (dropdown: todas/urgente/alta/normal)
- **Processamento:**
  1. Capturar valores de todos os filtros
  2. Aplicar l√≥gica AND (todos os filtros ativos simultaneamente)
  3. **Busca:** n√∫mero, unidade, membro, descri√ß√£o (case-insensitive)
  4. **Tipo:** filtrar por campo `tipo`
  5. **Status:** filtrar por `statusProcessual` OU `valoracao`
  6. **Tags:** filtrar se proposi√ß√£o cont√©m a tag selecionada
  7. **Prioridade:** filtrar por campo `prioridade`
  8. Re-renderizar tabela
  9. Exibir contador: "Exibindo X de Y proposi√ß√µes"
- **Sa√≠da:** Tabela filtrada + contador de resultados
- **Regras de Neg√≥cio:**
  - RN-PROP-30: Todos os filtros trabalham em conjunto (AND)
  - RN-PROP-31: Filtros vazios/padr√£o n√£o restringem (mostram tudo)
  - RN-PROP-32: Busca ignora acentua√ß√£o e case
  - RN-PROP-33: Contador mostra quantidade filtrada vs total
- **Crit√©rios de Aceite:**
  - ‚úì 5 filtros posicionados em linha acima da tabela
  - ‚úì Buscar "protocolo" encontra proposi√ß√µes com esta palavra na descri√ß√£o
  - ‚úì Filtrar tipo=Determina√ß√£o + tag=tecnologia mostra apenas determina√ß√µes com tag tecnologia
  - ‚úì Filtrar status=aguardando_comprovacao mostra apenas este status processual
  - ‚úì Filtrar prioridade=urgente mostra apenas proposi√ß√µes urgentes
  - ‚úì Bot√£o "Limpar Filtros" reseta todos para padr√£o

---

#### RF-PROP-011: Bot√£o "Limpar Filtros"

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve fornecer bot√£o para resetar todos os filtros de uma vez.
- **Entrada:** Clique no bot√£o "Limpar Filtros"
- **Processamento:**
  1. Resetar campo de busca (vazio)
  2. Resetar dropdown tipo para "Todas"
  3. Resetar dropdown status para "Todos"
  4. Resetar dropdown tag para "Todas"
  5. Resetar dropdown prioridade para "Todas"
  6. Re-renderizar tabela sem filtros
  7. Atualizar contador
- **Sa√≠da:** Todos os filtros resetados + tabela completa exibida
- **Regras de Neg√≥cio:**
  - RN-PROP-34: Limpar filtros n√£o altera correi√ß√£o selecionada
  - RN-PROP-35: Limpar filtros n√£o altera ordena√ß√£o (se aplicada)
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o posicionado no final da linha de filtros
  - ‚úì √çcone de "X" ou "Limpar" vis√≠vel
  - ‚úì Um clique reseta todos os 5 filtros simultaneamente
  - ‚úì Tabela atualiza mostrando todas as proposi√ß√µes da correi√ß√£o
  - ‚úì Contador volta para "Exibindo X de X proposi√ß√µes"

---

#### RF-PROP-012: Contador de Resultados

- **Prioridade:** [D] Desej√°vel
- **Descri√ß√£o:** O sistema deve exibir contador din√¢mico de proposi√ß√µes exibidas vs total.
- **Entrada:** Estado atual dos filtros
- **Processamento:**
  1. Contar proposi√ß√µes ap√≥s aplicar filtros (N)
  2. Contar total de proposi√ß√µes da correi√ß√£o (M)
  3. Renderizar texto: "Exibindo N de M proposi√ß√µes"
  4. Atualizar em tempo real ao mudar filtros
- **Sa√≠da:** Texto acima ou abaixo da tabela
- **Regras de Neg√≥cio:**
  - RN-PROP-36: Contador atualiza dinamicamente
  - RN-PROP-37: Se N=M, exibir: "Exibindo todas as M proposi√ß√µes"
- **Crit√©rios de Aceite:**
  - ‚úì Contador vis√≠vel sempre que h√° proposi√ß√µes
  - ‚úì Texto atualiza ao aplicar/limpar filtros
  - ‚úì Formato: "Exibindo 5 de 10 proposi√ß√µes"
  - ‚úì Se todas exibidas: "Exibindo todas as 10 proposi√ß√µes"
  - ‚úì Se nenhuma: "Nenhuma proposi√ß√£o encontrada"

---

### 2.5 RF-PUB: Publica√ß√£o de Proposi√ß√µes

#### RF-PUB-001: P√°gina Dedicada de Publica√ß√£o (Admin-only)

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve fornecer p√°gina standalone para administradores publicarem proposi√ß√µes em lote.
- **Entrada:** Clique em "Publicar Proposi√ß√µes" no menu lateral
- **Processamento:**
  1. Verificar se usu√°rio √© admin
  2. Se n√£o √© admin: redirecionar para index.html com mensagem de erro
  3. Se √© admin: carregar publicacao.html
  4. Carregar dados de localStorage
  5. Restaurar sess√£o
  6. Exibir estado inicial: placeholder "Selecione uma Correi√ß√£o"
- **Sa√≠da:** P√°gina dedicada com:
  - Sidebar com navega√ß√£o
  - Breadcrumb "‚Üê Voltar para Dashboard"
  - Dropdown de correi√ß√£o (obrigat√≥rio)
  - Filtros (ocultos inicialmente)
  - Tabela com checkboxes (oculta inicialmente)
  - Formul√°rio de publica√ß√£o (oculto inicialmente)
- **Regras de Neg√≥cio:**
  - RN-PUB-01: Acesso restrito a admins
  - RN-PUB-02: Usu√°rio comum redirecionado com erro
  - RN-PUB-03: P√°gina standalone (n√£o modal)
  - RN-PUB-04: Dados carregados de localStorage
- **Crit√©rios de Aceite:**
  - ‚úì Admin consegue acessar publicacao.html
  - ‚úì Usu√°rio comum √© redirecionado para index.html
  - ‚úì Mensagem clara: "Acesso restrito a administradores"
  - ‚úì Sess√£o restaurada automaticamente
  - ‚úì Estado inicial: placeholder vis√≠vel, tabela/formul√°rio ocultos

---

#### RF-PUB-002: Sele√ß√£o de Correi√ß√£o e Filtro Pendentes

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exigir sele√ß√£o de correi√ß√£o e exibir apenas proposi√ß√µes pendentes.
- **Entrada:** Dropdown de correi√ß√µes no topo da p√°gina
- **Processamento:**
  1. Popular dropdown com todas as correi√ß√µes (admin v√™ todas)
  2. Ao selecionar correi√ß√£o:
     - Buscar dados da correi√ß√£o
     - Filtrar proposi√ß√µes onde:
       - correicaoId = correi√ß√£o selecionada
       - statusProcessual = 'pendente'
     - Exibir painel informativo (tem√°tica, √≥rg√£o, total pendentes)
     - Mostrar √°rea de filtros
     - Renderizar tabela com proposi√ß√µes pendentes
  3. Se n√£o h√° pendentes: mostrar mensagem "Nenhuma proposi√ß√£o pendente"
- **Sa√≠da:** Tabela com APENAS proposi√ß√µes pendentes da correi√ß√£o selecionada
- **Regras de Neg√≥cio:**
  - RN-PUB-05: Apenas proposi√ß√µes com statusProcessual='pendente' s√£o public√°veis
  - RN-PUB-06: Proposi√ß√µes aguardando_comprovacao n√£o aparecem (j√° publicadas)
  - RN-PUB-07: Progressive disclosure ap√≥s sele√ß√£o
- **Crit√©rios de Aceite:**
  - ‚úì Selecionar correi√ß√£o exibe painel info
  - ‚úì Painel mostra: tem√°tica, ramoMP, quantidade de pendentes
  - ‚úì Tabela mostra APENAS proposi√ß√µes com status ['pendente', *]
  - ‚úì Proposi√ß√µes j√° publicadas n√£o aparecem
  - ‚úì Se zero pendentes: mensagem informativa exibida

---

#### RF-PUB-003: Tabela com Sistema de Sele√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir tabela de 8 colunas com checkboxes para sele√ß√£o em lote.
- **Entrada:** Correi√ß√£o selecionada + filtros aplicados
- **Processamento:**
  1. Renderizar tabela com 8 colunas:
     - Checkbox (sele√ß√£o individual)
     - N√∫mero
     - Tipo
     - Unidade
     - Descri√ß√£o (truncada)
     - Tags (badges)
     - Prioridade (com cor)
     - A√ß√µes (bot√£o "Ver")
  2. Checkbox master no cabe√ßalho (seleciona/desmarca todas vis√≠veis)
  3. Ao marcar checkbox: aplicar classe `.row-selected` na linha
  4. Manter array de IDs selecionados em mem√≥ria
- **Sa√≠da:** Tabela com visual de sele√ß√£o
- **Regras de Neg√≥cio:**
  - RN-PUB-08: Checkbox permite sele√ß√£o m√∫ltipla
  - RN-PUB-09: Linha selecionada tem destaque visual (fundo azul claro)
  - RN-PUB-10: Master checkbox afeta apenas linhas vis√≠veis (respeitando filtros)
- **Crit√©rios de Aceite:**
  - ‚úì Tabela exibe 8 colunas incluindo checkbox
  - ‚úì Checkbox master no cabe√ßalho funcional
  - ‚úì Marcar checkbox destaca linha (fundo #e7f3ff + borda esquerda azul)
  - ‚úì Desmarcar checkbox remove destaque
  - ‚úì Visual claro de quais linhas est√£o selecionadas

---

#### RF-PUB-004: Bot√µes de Sele√ß√£o em Lote

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve fornecer bot√µes para selecionar/desmarcar todas as proposi√ß√µes de uma vez.
- **Entrada:** Clique nos bot√µes "Selecionar Todas" ou "Desmarcar Todas"
- **Processamento:**
  1. **Selecionar Todas:**
     - Marcar todos os checkboxes vis√≠veis (ap√≥s filtros)
     - Aplicar classe `.row-selected` em todas as linhas vis√≠veis
     - Atualizar array de IDs selecionados
     - Atualizar contador
     - Mostrar formul√°rio de publica√ß√£o
  2. **Desmarcar Todas:**
     - Desmarcar todos os checkboxes
     - Remover classe `.row-selected`
     - Limpar array de IDs
     - Atualizar contador para "0 selecionada(s)"
     - Ocultar formul√°rio de publica√ß√£o
- **Sa√≠da:** Todas as proposi√ß√µes selecionadas/desmarcadas + contador atualizado
- **Regras de Neg√≥cio:**
  - RN-PUB-11: Bot√µes afetam apenas proposi√ß√µes vis√≠veis (ap√≥s filtros)
  - RN-PUB-12: "Desmarcar Todas" tamb√©m oculta formul√°rio
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "‚òëÔ∏è Selecionar Todas" posicionado acima da tabela
  - ‚úì Bot√£o "‚òê Desmarcar Todas" ao lado do anterior
  - ‚úì Clicar "Selecionar Todas" marca todas + mostra formul√°rio
  - ‚úì Clicar "Desmarcar Todas" desmarca todas + oculta formul√°rio
  - ‚úì Contador reflete quantidade correta

---

#### RF-PUB-005: Contador de Sele√ß√£o em Tempo Real

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve exibir contador din√¢mico de proposi√ß√µes selecionadas.
- **Entrada:** Estado atual dos checkboxes
- **Processamento:**
  1. Contar quantidade de checkboxes marcados (N)
  2. Renderizar texto: "N selecionada(s)"
  3. Atualizar em tempo real ao marcar/desmarcar
  4. Posicionar pr√≥ximo aos bot√µes de sele√ß√£o
- **Sa√≠da:** Texto com quantidade atualizada dinamicamente
- **Regras de Neg√≥cio:**
  - RN-PUB-13: Contador atualiza instantaneamente
  - RN-PUB-14: Formato singular/plural correto
- **Crit√©rios de Aceite:**
  - ‚úì Contador exibe "0 selecionada(s)" inicialmente
  - ‚úì Marcar 1 checkbox: "1 selecionada(s)"
  - ‚úì Marcar 5 checkboxes: "5 selecionada(s)"
  - ‚úì Desmarcar atualiza decrescendo
  - ‚úì Visualmente destacado (negrito ou cor)

---

#### RF-PUB-006: Formul√°rio de Publica√ß√£o (Progressive Disclosure)

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir formul√°rio de publica√ß√£o apenas quando proposi√ß√µes estiverem selecionadas.
- **Entrada:** Estado de sele√ß√£o (quantidade > 0)
- **Processamento:**
  1. Monitorar array de IDs selecionados
  2. Se length > 0:
     - Mostrar formul√°rio
     - Fazer scroll suave at√© o formul√°rio
  3. Se length = 0:
     - Ocultar formul√°rio
  4. Formul√°rio cont√©m:
     - Campo "Prazo de Comprova√ß√£o" (date, obrigat√≥rio)
     - Campo "Observa√ß√µes" (textarea 1000 chars, opcional, com contador)
     - Resumo: "Publicar X Proposi√ß√£o(√µes)"
     - Bot√µes: "Cancelar" e "Publicar"
- **Sa√≠da:** Formul√°rio vis√≠vel abaixo da tabela
- **Regras de Neg√≥cio:**
  - RN-PUB-15: Formul√°rio s√≥ aparece com sele√ß√£o > 0
  - RN-PUB-16: Prazo aplica-se a TODAS as selecionadas (√∫nico prazo)
  - RN-PUB-17: Observa√ß√µes s√£o opcionais e aplicam-se a todas
  - RN-PUB-18: Contador de caracteres em tempo real (verde‚Üíamarelo‚Üívermelho)
- **Crit√©rios de Aceite:**
  - ‚úì Formul√°rio oculto inicialmente
  - ‚úì Selecionar 1+ proposi√ß√µes: formul√°rio aparece + auto-scroll
  - ‚úì Desmarcar todas: formul√°rio desaparece
  - ‚úì Campo prazo obrigat√≥rio (n√£o permite submeter sem)
  - ‚úì Observa√ß√µes limitadas a 1.000 caracteres
  - ‚úì Contador: verde (0-700), amarelo (701-900), vermelho (901-1000)
  - ‚úì Resumo exibe quantidade correta: "Publicar 5 Proposi√ß√£o(√µes)"

---

#### RF-PUB-007: Bot√£o "Cancelar Publica√ß√£o"

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir cancelar publica√ß√£o em andamento.
- **Entrada:** Clique no bot√£o "Cancelar"
- **Processamento:**
  1. Exibir dialog de confirma√ß√£o: "Deseja cancelar a publica√ß√£o? As sele√ß√µes ser√£o perdidas."
  2. Se confirmar:
     - Desmarcar todos os checkboxes
     - Limpar array de IDs
     - Resetar formul√°rio (prazo + observa√ß√µes)
     - Ocultar formul√°rio
     - Atualizar contador para "0 selecionada(s)"
  3. Se cancelar: manter estado atual
- **Sa√≠da:** Sele√ß√£o e formul√°rio resetados
- **Regras de Neg√≥cio:**
  - RN-PUB-19: Cancelar requer confirma√ß√£o
  - RN-PUB-20: Dados do formul√°rio s√£o perdidos (n√£o salvos)
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "Cancelar" ao lado do bot√£o "Publicar"
  - ‚úì Dialog de confirma√ß√£o com texto claro
  - ‚úì Confirmar: reseta tudo (sele√ß√£o + formul√°rio)
  - ‚úì Cancelar dialog: mant√©m estado atual

---

#### RF-PUB-008: Publica√ß√£o em Lote

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve publicar m√∫ltiplas proposi√ß√µes simultaneamente com mesmo prazo.
- **Entrada:**
  - Array de IDs selecionados
  - Prazo de comprova√ß√£o
  - Observa√ß√µes (opcional)
- **Processamento:**
  1. Validar que h√° sele√ß√£o (length > 0)
  2. Validar que prazo foi preenchido
  3. Exibir dialog de confirma√ß√£o:
     - "Confirma publica√ß√£o de X proposi√ß√µes com prazo [data]?"
  4. Se confirmar, para CADA proposi√ß√£o selecionada:
     - Buscar correi√ß√£o vinculada
     - Atualizar status: ['aguardando_comprovacao', valoracao]
     - Definir prazoComprovacao = prazo informado
     - Definir dataPublicacao = hoje
     - Adicionar entrada no historico:
       ```
       {
         tipo: 'publicacao',
         data: hoje (ISO),
         usuario: 'Corregedoria Nacional',
         descricao: 'Proposi√ß√£o publicada para [ramoMP] - [ramoMPNome]',
         observacoes: observa√ß√µes | null,
         prazoComprovacao: prazo,
         statusAnterior: ['pendente', valoracao],
         statusNovo: ['aguardando_comprovacao', valoracao]
       }
       ```
  5. Salvar todas no localStorage
  6. Recalcular status das correi√ß√µes afetadas
  7. Exibir mensagem de sucesso
  8. Limpar sele√ß√£o e formul√°rio
  9. Atualizar tabela (publicadas removidas da lista de pendentes)
- **Sa√≠da:**
  - Sucesso: "X proposi√ß√µes publicadas com sucesso! Os √≥rg√£os correicionados ser√£o notificados por e-mail."
  - Falha: Mensagem de erro espec√≠fica
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-03: Publica√ß√£o registrada no hist√≥rico
  - RN-PUB-21: Prazo √∫nico para todas as selecionadas
  - RN-PUB-22: Publica√ß√£o √© permanente (registrada no hist√≥rico)
  - RN-PUB-23: Status muda de pendente ‚Üí aguardando_comprovacao
  - RN-PUB-24: Valora√ß√£o √© preservada (n√£o resetada)
- **Crit√©rios de Aceite:**
  - ‚úì Publicar sem prazo exibe erro de valida√ß√£o
  - ‚úì Dialog de confirma√ß√£o exibe prazo e quantidade
  - ‚úì Ap√≥s confirmar: todas as X proposi√ß√µes atualizadas
  - ‚úì Cada uma tem entrada no historico
  - ‚úì Status correto: ['aguardando_comprovacao', valoracao_anterior]
  - ‚úì prazoComprovacao e dataPublicacao definidos
  - ‚úì Mensagem de sucesso menciona notifica√ß√£o por e-mail
  - ‚úì Tabela atualiza: publicadas desaparecem da lista de pendentes
  - ‚úì Sele√ß√£o e formul√°rio resetados

---

#### RF-PUB-009: Filtros de Proposi√ß√µes Pendentes

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir filtrar proposi√ß√µes pendentes antes de selecionar.
- **Entrada:** 4 campos de filtro:
  1. Busca textual
  2. Tipo (Determina√ß√£o/Recomenda√ß√£o)
  3. Tags (11 op√ß√µes)
  4. Prioridade (urgente/alta/normal)
- **Processamento:**
  1. Aplicar filtros em conjunto (AND)
  2. Filtrar apenas dentro das proposi√ß√µes pendentes da correi√ß√£o
  3. Re-renderizar tabela
  4. Manter sele√ß√µes existentes (se linhas ainda vis√≠veis)
  5. Atualizar contador de resultados
- **Sa√≠da:** Tabela filtrada + contador
- **Regras de Neg√≥cio:**
  - RN-PUB-25: Filtros trabalham apenas em proposi√ß√µes pendentes
  - RN-PUB-26: Master checkbox afeta apenas linhas vis√≠veis
  - RN-PUB-27: Sele√ß√µes de linhas filtradas s√£o mantidas
- **Crit√©rios de Aceite:**
  - ‚úì 4 filtros posicionados acima da tabela
  - ‚úì Filtrar tipo=Determina√ß√£o + prioridade=urgente mostra apenas determina√ß√µes urgentes pendentes
  - ‚úì Bot√£o "Limpar Filtros" reseta todos
  - ‚úì Contador: "Exibindo X de Y proposi√ß√µes pendentes"
  - ‚úì Sele√ß√µes mantidas ao aplicar filtros (se linhas permanecem)

---

#### RF-PUB-010: Gera√ß√£o de Of√≠cio de Publica√ß√£o

- **Prioridade:** [D] Desej√°vel
- **Descri√ß√£o:** O sistema deve gerar documento PDF oficial (of√≠cio) para formalizar publica√ß√£o.
- **Entrada:**
  - Proposi√ß√µes selecionadas
  - Prazo de comprova√ß√£o (do formul√°rio ou da publica√ß√£o j√° realizada)
- **Processamento:**
  1. Abrir nova janela de impress√£o
  2. Gerar HTML com estrutura formal:
     - Cabe√ßalho institucional CNMP
     - Of√≠cio n¬∫ (placeholder)
     - Local e data
     - Destinat√°rio (ramoMPNome)
     - Refer√™ncia √† correi√ß√£o
     - Corpo do texto (Lei Complementar 75/1993, Regimento Interno)
     - Lista numerada de proposi√ß√µes com tipo, unidade e descri√ß√£o
     - Prazo de comprova√ß√£o destacado
     - Assinatura (Corregedor Nacional)
  3. Aplicar estilos: Times New Roman, 12pt, espa√ßamento 1.8
  4. Acionar dialog de impress√£o do navegador
- **Sa√≠da:** PDF formatado conforme padr√µes oficiais
- **Regras de Neg√≥cio:**
  - RN-PUB-28: Of√≠cio gerado em font Times New Roman (padr√£o documentos oficiais)
  - RN-PUB-29: Estrutura deve seguir modelo institucional
  - RN-PUB-30: Prazo destacado visualmente
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "üìÑ Gerar Of√≠cio" no menu de exporta√ß√£o
  - ‚úì PDF gerado com formata√ß√£o profissional
  - ‚úì Cabe√ßalho institucional presente
  - ‚úì Todas as proposi√ß√µes listadas numericamente
  - ‚úì Prazo de comprova√ß√£o destacado
  - ‚úì Layout print-friendly (margem, quebras de p√°gina)

---

### 2.6 RF-COMP: Comprova√ß√£o

#### RF-COMP-001: P√°gina Dedicada de Comprova√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve fornecer p√°gina standalone para correicionados enviarem comprova√ß√µes.
- **Entrada:** Clique em bot√£o "Adicionar" (nova comprova√ß√£o) ou "Editar" (rascunho existente) + ID da proposi√ß√£o via URL
- **Processamento:**
  1. Redirecionar para `comprovacao.html?id={proposicaoId}`
  2. Carregar dados de localStorage
  3. Restaurar sess√£o do usu√°rio
  4. Validar que proposi√ß√£o existe e pertence ao MP do usu√°rio
  5. Validar que statusProcessual = 'aguardando_comprovacao'
  6. Verificar exist√™ncia de rascunho para esta proposi√ß√£o
  7. Se rascunho existe: carregar dados automaticamente
  8. Renderizar p√°gina
- **Sa√≠da:** P√°gina dedicada com:
  - Sidebar com navega√ß√£o
  - Breadcrumb "‚Üê Voltar"
  - Se√ß√£o de informa√ß√µes da proposi√ß√£o
  - Alerta de prazo (com countdown)
  - Formul√°rio de comprova√ß√£o
- **Regras de Neg√≥cio:**
  - RN-COMP-01: Usu√°rio s√≥ v√™ proposi√ß√µes do seu MP
  - RN-COMP-02: Apenas proposi√ß√µes com status 'aguardando_comprovacao' podem receber comprova√ß√£o
  - RN-COMP-03: Rascunho existente √© carregado automaticamente
  - RN-COMP-04: P√°gina standalone (n√£o modal)
- **Crit√©rios de Aceite:**
  - ‚úì URL com ID v√°lido carrega p√°gina corretamente
  - ‚úì ID inv√°lido ou sem permiss√£o exibe erro + redirect
  - ‚úì Status diferente de 'aguardando_comprovacao' exibe erro
  - ‚úì Rascunho existente pr√©-preenche formul√°rio
  - ‚úì Indicador visual quando editando rascunho

---

#### RF-COMP-002: Visualiza√ß√£o de Informa√ß√µes da Proposi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir contexto completo da proposi√ß√£o antes do formul√°rio.
- **Entrada:** Dados da proposi√ß√£o carregados
- **Processamento:**
  1. Renderizar grid informativo com:
     - N√∫mero
     - Tipo (badge)
     - Correi√ß√£o vinculada (n√∫mero + tem√°tica)
     - Unidade respons√°vel
     - Membro designado
     - Descri√ß√£o completa
     - Tags (badges)
     - Status (badges bidimensionais)
     - Prioridade (com cor)
- **Sa√≠da:** Grid de informa√ß√µes acima do formul√°rio
- **Regras de Neg√≥cio:**
  - RN-COMP-05: Informa√ß√µes s√£o readonly (n√£o edit√°veis)
  - RN-COMP-06: Formata√ß√£o visual consistente com demais p√°ginas
- **Crit√©rios de Aceite:**
  - ‚úì Grid exibe todos os campos da proposi√ß√£o
  - ‚úì Descri√ß√£o completa vis√≠vel (n√£o truncada)
  - ‚úì Tags renderizadas como badges coloridos
  - ‚úì Status bidimensional empilhado
  - ‚úì Layout organizado e leg√≠vel

---

#### RF-COMP-003: Alerta de Prazo com Countdown

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve exibir alerta visual sobre prazo de comprova√ß√£o com indicador de tempo restante.
- **Entrada:** Campo `prazoComprovacao` da proposi√ß√£o
- **Processamento:**
  1. Calcular diferen√ßa entre prazo e hoje
  2. Se prazo no futuro:
     - Calcular dias restantes
     - Exibir alerta azul/verde: "Prazo: [data] (X dias restantes)"
  3. Se prazo √© hoje:
     - Exibir alerta amarelo: "Aten√ß√£o: prazo vence hoje!"
  4. Se prazo vencido:
     - Exibir alerta vermelho: "Prazo vencido h√° X dias"
- **Sa√≠da:** Box de alerta destacado acima do formul√°rio
- **Regras de Neg√≥cio:**
  - RN-COMP-07: Cores mudam conforme proximidade do prazo
  - RN-COMP-08: Prazo vencido n√£o impede envio (flexibilidade)
  - RN-COMP-09: Contador atualiza diariamente
- **Crit√©rios de Aceite:**
  - ‚úì Prazo futuro: alerta verde/azul com dias restantes
  - ‚úì Prazo hoje: alerta amarelo com texto de aten√ß√£o
  - ‚úì Prazo vencido: alerta vermelho com dias de atraso
  - ‚úì Data formatada em PT-BR: DD/MM/YYYY
  - ‚úì √çcone de rel√≥gio (‚è∞) vis√≠vel

---

#### RF-COMP-004: Formul√°rio de Comprova√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve fornecer formul√°rio completo para registro de comprova√ß√£o de cumprimento.
- **Entrada:** Campos do formul√°rio:
  - Descri√ß√£o do Adimplemento (textarea 7500 chars, obrigat√≥rio)
  - Observa√ß√µes Adicionais (textarea 1000 chars, opcional)
  - Arquivos Anexos (m√∫ltiplos, upload)
- **Processamento:**
  1. Renderizar formul√°rio com 3 se√ß√µes
  2. Implementar contadores de caracteres em tempo real:
     - Descri√ß√£o: verde (0-6000), amarelo (6001-7200), vermelho (7201-7500)
     - Observa√ß√µes: verde (0-700), amarelo (701-900), vermelho (901-1000)
  3. Implementar √°rea de upload com drag-and-drop
  4. Validar campos obrigat√≥rios ao submeter
- **Sa√≠da:** Formul√°rio interativo com valida√ß√µes
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-10: Descri√ß√£o limitada a 7.500 caracteres (campo comprova√ß√£o usa mesmo limite aumentado)
  - RN-COMP-10: Observa√ß√µes limitadas a 1.000 caracteres
  - RN-COMP-11: Pelo menos 1 arquivo anexo √© recomendado (mas n√£o obrigat√≥rio)
  - RN-COMP-12: Contadores visuais com feedback de cor
- **Crit√©rios de Aceite:**
  - ‚úì Campo "Descri√ß√£o" obrigat√≥rio com contador
  - ‚úì Campo "Observa√ß√µes" opcional com contador
  - ‚úì Contador muda cor conforme limite
  - ‚úì √Årea de upload vis√≠vel e funcional
  - ‚úì Valida√ß√£o impede submeter sem descri√ß√£o

---

#### RF-COMP-005: Upload de M√∫ltiplos Arquivos

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir upload de m√∫ltiplos arquivos como evid√™ncias de cumprimento.
- **Entrada:**
  - Bot√£o "Selecionar Arquivos" (input file)
  - √Årea drag-and-drop
- **Processamento:**
  1. Aceitar m√∫ltiplos arquivos (atributo multiple)
  2. Validar formato: PDF, DOC, DOCX, JPG, PNG, ZIP
  3. Validar tamanho: m√°ximo 10 MB por arquivo
  4. Armazenar nomes dos arquivos em array
  5. Renderizar lista de arquivos selecionados com:
     - Nome do arquivo
     - Tamanho formatado (KB/MB)
     - Bot√£o "Remover" (X)
  6. Implementar feedback visual drag-and-drop:
     - Hover: borda destacada
     - Drop: adicionar √† lista
- **Sa√≠da:** Lista de arquivos anexados com preview
- **Regras de Neg√≥cio:**
  - [MD] RT-05: Limite de 10 MB por arquivo
  - [MD] RT-06: Formatos: PDF, DOC, DOCX, JPG, PNG, ZIP
  - RN-COMP-13: M√°ximo de 10 arquivos por comprova√ß√£o
  - RN-COMP-14: Arquivos anexados s√£o obrigat√≥rios na l√≥gica de neg√≥cio (recomendado fortemente)
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "Selecionar Arquivos" funcional
  - ‚úì Drag-and-drop funciona (arrastar arquivo sobre √°rea)
  - ‚úì Arquivo > 10 MB exibe erro: "Tamanho m√°ximo: 10 MB"
  - ‚úì Formato inv√°lido exibe erro: "Formato n√£o suportado"
  - ‚úì Lista de arquivos atualiza dinamicamente
  - ‚úì Cada arquivo mostra nome e tamanho
  - ‚úì Bot√£o "X" remove arquivo da lista
  - ‚úì Visual de hover ao arrastar arquivo sobre √°rea

---

#### RF-COMP-006: Sistema de Rascunhos

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir salvar comprova√ß√£o como rascunho para edi√ß√£o posterior.
- **Entrada:**
  - Clique no bot√£o "Salvar como Rascunho"
  - Dados preenchidos no formul√°rio
- **Processamento:**
  1. Validar que descri√ß√£o foi preenchida (m√≠nimo 10 caracteres)
  2. Capturar dados atuais:
     - descricao
     - observacoes
     - arquivos[]
     - dataCriacao (se novo) ou dataModificacao (se editando)
  3. Se j√° existe rascunho para esta proposi√ß√£o:
     - Substituir rascunho existente (n√£o criar novo)
  4. Se n√£o existe:
     - Criar novo rascunho
  5. Salvar em `proposicao.rascunhos[]` no localStorage
  6. Exibir mensagem de sucesso
  7. Manter usu√°rio na p√°gina (n√£o redirecionar)
- **Sa√≠da:**
  - Sucesso: "Rascunho salvo com sucesso! Voc√™ pode continuar editando ou voltar mais tarde."
  - Falha: Mensagem de erro espec√≠fica
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-11: M√°ximo 1 rascunho ativo por proposi√ß√£o
  - RN-COMP-15: Salvar rascunho n√£o altera status da proposi√ß√£o
  - RN-COMP-16: Rascunho √© substitu√≠do (n√£o versionado)
  - RN-COMP-17: Descri√ß√£o m√≠nima de 10 caracteres para salvar
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "Salvar como Rascunho" separado do "Enviar"
  - ‚úì Descri√ß√£o < 10 chars exibe erro
  - ‚úì Salvar com sucesso: mensagem + permanece na p√°gina
  - ‚úì Rascunho existente √© substitu√≠do (n√£o duplicado)
  - ‚úì Indicador visual de "√∫ltima edi√ß√£o"
  - ‚úì Status da proposi√ß√£o permanece 'aguardando_comprovacao'

---

#### RF-COMP-007: Carregamento Autom√°tico de Rascunho

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve detectar e carregar automaticamente rascunho existente ao abrir p√°gina.
- **Entrada:** ID da proposi√ß√£o na URL
- **Processamento:**
  1. Ao carregar p√°gina, verificar `proposicao.rascunhos[]`
  2. Se array n√£o vazio:
     - Buscar rascunho (deve ter apenas 1)
     - Pr√©-preencher formul√°rio com:
       - descricao
       - observacoes
       - arquivos[] (renderizar lista)
     - Exibir badge: "Editando rascunho salvo em [data]"
  3. Se array vazio:
     - Formul√°rio em branco
     - Badge: "Nova comprova√ß√£o"
- **Sa√≠da:** Formul√°rio pr√©-preenchido (se rascunho existe)
- **Regras de Neg√≥cio:**
  - RN-COMP-18: Carregamento autom√°tico (sem necessidade de clicar)
  - RN-COMP-19: Badge indica modo (novo vs editando rascunho)
  - RN-COMP-20: Data de √∫ltima edi√ß√£o exibida
- **Crit√©rios de Aceite:**
  - ‚úì Abrir p√°gina com rascunho: formul√°rio pr√©-preenchido
  - ‚úì Badge "Editando rascunho" vis√≠vel
  - ‚úì Data de √∫ltima modifica√ß√£o formatada
  - ‚úì Lista de arquivos renderizada
  - ‚úì Contadores refletem texto carregado

---

#### RF-COMP-008: Envio de Comprova√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve processar envio oficial de comprova√ß√£o, alterando status e registrando no hist√≥rico.
- **Entrada:**
  - Clique no bot√£o "Enviar Comprova√ß√£o"
  - Dados do formul√°rio preenchidos
- **Processamento:**
  1. Validar campos obrigat√≥rios:
     - Descri√ß√£o preenchida (m√≠nimo 50 caracteres para envio)
     - Pelo menos 1 arquivo anexado (recomendado)
  2. Exibir dialog de confirma√ß√£o:
     - "Confirma envio da comprova√ß√£o? Ap√≥s enviar, n√£o ser√° poss√≠vel editar."
  3. Se confirmar:
     - Criar entrada no `proposicao.historico[]`:
       ```
       {
         tipo: 'comprovacao',
         data: hoje (ISO),
         usuario: '[ramoMP] - [ramoMPNome]',
         descricao: descri√ß√£o preenchida,
         observacoes: observa√ß√µes | null,
         arquivos: array de nomes de arquivos
       }
       ```
     - Atualizar status: ['em_analise', valoracao]
     - Limpar array `proposicao.rascunhos[]` (rascunho consumido)
     - Salvar no localStorage
     - Recalcular status da correi√ß√£o
     - Exibir mensagem de sucesso
     - Redirecionar para `index.html#enviar`
- **Sa√≠da:**
  - Sucesso: "Comprova√ß√£o enviada com sucesso! A Corregedoria Nacional ser√° notificada." + redirect
  - Falha: Mensagem de erro espec√≠fica
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-04: Comprova√ß√£o registrada no hist√≥rico
  - RN-COMP-21: Descri√ß√£o m√≠nima de 50 caracteres para envio oficial
  - RN-COMP-22: Status muda de 'aguardando_comprovacao' ‚Üí 'em_analise'
  - RN-COMP-23: Envio √© irrevers√≠vel (n√£o pode editar ap√≥s enviar)
  - RN-COMP-24: Rascunho √© deletado ap√≥s envio
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "Enviar Comprova√ß√£o" destacado visualmente
  - ‚úì Descri√ß√£o < 50 chars exibe erro: "M√≠nimo 50 caracteres"
  - ‚úì Sem arquivos exibe aviso (mas permite enviar)
  - ‚úì Dialog de confirma√ß√£o claro
  - ‚úì Ap√≥s confirmar: entrada criada no hist√≥rico
  - ‚úì Status atualizado para ['em_analise', valoracao]
  - ‚úì Rascunho deletado
  - ‚úì Mensagem de sucesso + redirect para index.html#enviar
  - ‚úì Proposi√ß√£o aparece na fila de avalia√ß√£o do admin

---

#### RF-COMP-009: Valida√ß√µes de Formul√°rio

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve validar todos os campos antes de permitir salvar rascunho ou enviar comprova√ß√£o.
- **Entrada:** Dados preenchidos no formul√°rio
- **Processamento:**
  1. **Valida√ß√µes para Rascunho:**
     - Descri√ß√£o: m√≠nimo 10 caracteres
  2. **Valida√ß√µes para Envio:**
     - Descri√ß√£o: m√≠nimo 50 caracteres, m√°ximo 7.500
     - Observa√ß√µes (se preenchidas): m√°ximo 1.000
     - Arquivos: fortemente recomendado (aviso se vazio)
  3. Exibir mensagens de erro espec√≠ficas abaixo dos campos
  4. Destacar campo inv√°lido (borda vermelha)
- **Sa√≠da:**
  - V√°lido: Permite a√ß√£o
  - Inv√°lido: Exibe erros + bloqueia a√ß√£o
- **Regras de Neg√≥cio:**
  - RN-COMP-25: Valida√ß√µes no frontend E backend
  - RN-COMP-26: Mensagens claras e orientativas
  - RN-COMP-27: Rascunho tem valida√ß√£o mais relaxada que envio
- **Crit√©rios de Aceite:**
  - ‚úì Tentar salvar rascunho com descri√ß√£o < 10 chars: erro claro
  - ‚úì Tentar enviar com descri√ß√£o < 50 chars: erro claro
  - ‚úì Descri√ß√£o > 7.500 chars: contador vermelho + erro
  - ‚úì Observa√ß√µes > 1.000 chars: contador vermelho + erro
  - ‚úì Enviar sem arquivos: aviso amarelo (mas permite)
  - ‚úì Campo inv√°lido destacado visualmente

---

#### RF-COMP-010: Cancelamento e Navega√ß√£o

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir cancelar e voltar sem salvar altera√ß√µes.
- **Entrada:** Clique no breadcrumb "‚Üê Voltar" ou bot√£o "Cancelar"
- **Processamento:**
  1. Verificar se formul√°rio foi alterado (dirty state)
  2. Se alterado e n√£o salvo:
     - Exibir confirma√ß√£o: "Deseja sair sem salvar? Altera√ß√µes n√£o salvas ser√£o perdidas."
  3. Se confirmar ou se n√£o alterado:
     - Redirecionar para `index.html#enviar`
  4. Se cancelar confirma√ß√£o:
     - Permanecer na p√°gina
- **Sa√≠da:** Navega√ß√£o para p√°gina anterior
- **Regras de Neg√≥cio:**
  - RN-COMP-28: Alertar sobre perda de dados n√£o salvos
  - RN-COMP-29: Rascunho salvo previamente √© mantido (n√£o √© perdido)
- **Crit√©rios de Aceite:**
  - ‚úì Breadcrumb "‚Üê Voltar" funcional
  - ‚úì Formul√°rio n√£o alterado: sai direto
  - ‚úì Formul√°rio alterado: exibe confirma√ß√£o
  - ‚úì Confirmar: navega e perde altera√ß√µes n√£o salvas
  - ‚úì Cancelar: permanece na p√°gina
  - ‚úì Rascunho salvo anteriormente N√ÉO √© perdido

---

### 2.7 RF-AVAL: Avalia√ß√£o

#### RF-AVAL-001: P√°gina Dedicada de Avalia√ß√£o (Admin-only)

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve fornecer p√°gina standalone para administradores avaliarem comprova√ß√µes recebidas.
- **Entrada:** Clique em bot√£o "Avaliar" + ID da proposi√ß√£o via URL
- **Processamento:**
  1. Verificar se usu√°rio √© admin
  2. Se n√£o √© admin: redirecionar com erro
  3. Redirecionar para `avaliacao.html?id={proposicaoId}`
  4. Carregar dados de localStorage
  5. Restaurar sess√£o
  6. Buscar proposi√ß√£o e validar exist√™ncia
  7. Renderizar p√°gina
- **Sa√≠da:** P√°gina dedicada com:
  - Sidebar com navega√ß√£o
  - Breadcrumb "‚Üê Voltar"
  - Informa√ß√µes da proposi√ß√£o
  - Hist√≥rico completo
  - Comprova√ß√£o atual
  - Formul√°rio de avalia√ß√£o
- **Regras de Neg√≥cio:**
  - RN-AVAL-01: Acesso restrito a admins
  - RN-AVAL-02: Avalia√ß√£o pode ocorrer em qualquer status (flexibilidade)
  - RN-AVAL-03: P√°gina standalone (n√£o modal)
- **Crit√©rios de Aceite:**
  - ‚úì Admin consegue acessar avaliacao.html
  - ‚úì Usu√°rio comum √© redirecionado com erro
  - ‚úì URL com ID v√°lido carrega p√°gina
  - ‚úì ID inv√°lido exibe erro + redirect
  - ‚úì Sess√£o restaurada automaticamente

---

#### RF-AVAL-002: Visualiza√ß√£o Completa da Proposi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir todos os dados da proposi√ß√£o para contexto da avalia√ß√£o.
- **Entrada:** Dados da proposi√ß√£o carregados
- **Processamento:**
  1. Renderizar grid informativo com todos os campos:
     - N√∫mero, Tipo, Correi√ß√£o vinculada
     - Unidade, Membro, Descri√ß√£o
     - Tags, Status, Prioridade
     - prazoComprovacao, dataPublica√ß√£o
  2. Buscar e exibir dados da correi√ß√£o vinculada
- **Sa√≠da:** Se√ß√£o de informa√ß√µes acima do hist√≥rico
- **Regras de Neg√≥cio:**
  - RN-AVAL-04: Informa√ß√µes readonly (n√£o edit√°veis)
  - RN-AVAL-05: Formata√ß√£o visual consistente
- **Crit√©rios de Aceite:**
  - ‚úì Grid exibe todos os campos da proposi√ß√£o
  - ‚úì Descri√ß√£o completa vis√≠vel
  - ‚úì Tags e status renderizados corretamente
  - ‚úì Dados da correi√ß√£o vinculada exibidos
  - ‚úì Layout organizado e leg√≠vel

---

#### RF-AVAL-003: Visualiza√ß√£o do Hist√≥rico Completo

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve exibir timeline completa com todas as intera√ß√µes (publica√ß√µes, comprova√ß√µes, avalia√ß√µes).
- **Entrada:** Array `proposicao.historico[]`
- **Processamento:**
  1. Ordenar hist√≥rico cronologicamente (mais antigo ‚Üí mais recente)
  2. Renderizar timeline com cores diferenciadas:
     - üì§ Publica√ß√£o (fundo laranja)
     - üìé Comprova√ß√£o (fundo azul)
     - ‚öñÔ∏è Avalia√ß√£o (fundo verde)
  3. Para cada entrada, exibir:
     - √çcone e tipo
     - Data formatada (DD/MM/YYYY HH:mm)
     - Usu√°rio respons√°vel
     - Descri√ß√£o
     - Observa√ß√µes (se houver)
     - Campos espec√≠ficos por tipo:
       - Publica√ß√£o: prazoComprovacao, statusAnterior ‚Üí statusNovo
       - Comprova√ß√£o: arquivos anexados (lista)
       - Avalia√ß√£o: statusAnterior ‚Üí statusNovo
- **Sa√≠da:** Timeline visual completa
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-01: Hist√≥rico √© imut√°vel (somente visualiza√ß√£o)
  - RN-AVAL-06: Ordem cronol√≥gica estrita
  - RN-AVAL-07: Todas as entradas vis√≠veis (n√£o paginar)
- **Crit√©rios de Aceite:**
  - ‚úì Timeline renderizada em ordem cronol√≥gica
  - ‚úì Cores diferenciadas por tipo (laranja/azul/verde)
  - ‚úì Cada entrada mostra todos os campos relevantes
  - ‚úì Arquivos de comprova√ß√£o listados
  - ‚úì Transi√ß√µes de status claramente exibidas
  - ‚úì Data/hora formatadas em PT-BR

---

#### RF-AVAL-004: Visualiza√ß√£o da Comprova√ß√£o Atual

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve destacar a √∫ltima comprova√ß√£o enviada para facilitar avalia√ß√£o.
- **Entrada:** Array `proposicao.historico[]`
- **Processamento:**
  1. Buscar √∫ltima entrada com tipo='comprovacao' no hist√≥rico
  2. Se encontrada:
     - Exibir em se√ß√£o destacada "Comprova√ß√£o Atual"
     - Renderizar:
       - Data de envio
       - Usu√°rio (MP)
       - Descri√ß√£o completa
       - Observa√ß√µes (se houver)
       - Lista de arquivos anexados
  3. Se n√£o encontrada:
     - Exibir mensagem: "Nenhuma comprova√ß√£o enviada ainda"
- **Sa√≠da:** Se√ß√£o destacada com √∫ltima comprova√ß√£o
- **Regras de Neg√≥cio:**
  - RN-AVAL-08: Se√ß√£o destaca √∫ltima comprova√ß√£o (mais recente)
  - RN-AVAL-09: Se m√∫ltiplas comprova√ß√µes (republica√ß√µes), mostrar a mais recente
- **Crit√©rios de Aceite:**
  - ‚úì Se√ß√£o "Comprova√ß√£o Atual" vis√≠vel e destacada
  - ‚úì Descri√ß√£o completa exibida (n√£o truncada)
  - ‚úì Arquivos listados com nomes completos
  - ‚úì Observa√ß√µes exibidas (se preenchidas)
  - ‚úì Se sem comprova√ß√£o: mensagem informativa
  - ‚úì Visual diferenciado (box com borda ou fundo)

---

#### RF-AVAL-005: Formul√°rio de Avalia√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve fornecer formul√°rio para admin registrar decis√£o sobre a comprova√ß√£o.
- **Entrada:** Formul√°rio com 2 campos:
  - **Decis√£o** (radio buttons obrigat√≥rio, 4 op√ß√µes)
  - **Parecer** (textarea 7500 chars obrigat√≥rio)
- **Processamento:**
  1. Renderizar 4 radio buttons como cards visuais:
     - ‚úÖ Finalizada (verde)
     - ‚ö†Ô∏è Parcial (laranja)
     - ‚ùå Em Andamento (vermelho)
     - üö´ Prejudicada (cinza)
  2. Renderizar textarea com contador de caracteres:
     - Verde (0-6000), amarelo (6001-7200), vermelho (7201-7500)
  3. Validar campos obrigat√≥rios
- **Sa√≠da:** Formul√°rio interativo com valida√ß√µes
- **Regras de Neg√≥cio:**
  - RN-AVAL-10: Ambos campos s√£o obrigat√≥rios
  - RN-AVAL-11: Parecer m√≠nimo 50 caracteres
  - RN-AVAL-12: Cards visuais facilitam escolha
  - RN-AVAL-13: Contador de caracteres em tempo real
- **Crit√©rios de Aceite:**
  - ‚úì 4 radio buttons renderizados como cards clic√°veis
  - ‚úì Cada card tem √≠cone, cor e texto descritivo
  - ‚úì Card selecionado tem borda destacada
  - ‚úì Textarea obrigat√≥ria com contador
  - ‚úì Contador muda cor conforme limite
  - ‚úì Valida√ß√£o impede submeter sem decis√£o ou parecer

---

#### RF-AVAL-006: L√≥gica de Transi√ß√£o de Status

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve aplicar regras corretas de transi√ß√£o de status baseado na decis√£o do avaliador.
- **Entrada:** Decis√£o selecionada pelo avaliador
- **Processamento:**
  1. **Se decis√£o = Finalizada:**
     - Novo status: ['encerrada', 'finalizada']
     - Ciclo finalizado ‚úì
  2. **Se decis√£o = Prejudicada:**
     - Novo status: ['encerrada', 'prejudicada']
     - Ciclo finalizado ‚úì
  3. **Se decis√£o = Parcial:**
     - Novo status: ['pendente', 'parcial']
     - Aguarda republica√ß√£o (ciclo continua)
  4. **Se decis√£o = Em Andamento:**
     - Novo status: ['pendente', 'em_andamento']
     - Aguarda republica√ß√£o (ciclo continua)
  5. Status processual = 'pendente' volta proposi√ß√£o para fila de publica√ß√£o
- **Sa√≠da:** Status atualizado conforme regra
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-05: Transi√ß√µes seguem l√≥gica do modelo
  - RN-AVAL-14: Finalizada/Prejudicada ‚Üí encerra ciclo
  - RN-AVAL-15: Parcial/Em Andamento ‚Üí volta para 'pendente' (requer republica√ß√£o)
  - RN-AVAL-16: Valora√ß√£o √© sempre atualizada independente do processual
- **Crit√©rios de Aceite:**
  - ‚úì Avaliar como Finalizada: status = ['encerrada', 'finalizada']
  - ‚úì Avaliar como Prejudicada: status = ['encerrada', 'prejudicada']
  - ‚úì Avaliar como Parcial: status = ['pendente', 'parcial']
  - ‚úì Avaliar como Em Andamento: status = ['pendente', 'em_andamento']
  - ‚úì Proposi√ß√µes com Parcial/Em Andamento aparecem em "Publicar Proposi√ß√µes"

---

#### RF-AVAL-007: Registro de Avalia√ß√£o no Hist√≥rico

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve registrar avalia√ß√£o permanentemente no hist√≥rico da proposi√ß√£o.
- **Entrada:**
  - Decis√£o selecionada
  - Parecer preenchido
  - Status anterior da proposi√ß√£o
- **Processamento:**
  1. Capturar status anterior (antes da avalia√ß√£o)
  2. Calcular novo status conforme l√≥gica de transi√ß√£o
  3. Criar entrada no `proposicao.historico[]`:
     ```
     {
       tipo: 'avaliacao',
       data: hoje (ISO),
       usuario: 'Corregedoria Nacional',
       descricao: parecer preenchido,
       observacoes: null,
       statusAnterior: [statusProcessual_anterior, valoracao_anterior],
       statusNovo: [statusProcessual_novo, valoracao_novo]
     }
     ```
  4. Adicionar ao final do array historico
- **Sa√≠da:** Entrada de avalia√ß√£o no hist√≥rico
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-05: Avalia√ß√£o registrada com transi√ß√µes de status
  - RN-AVAL-17: Hist√≥rico √© append-only (n√£o editar entradas anteriores)
  - RN-AVAL-18: Usu√°rio sempre 'Corregedoria Nacional'
- **Crit√©rios de Aceite:**
  - ‚úì Entrada criada no historico com todos os campos
  - ‚úì tipo = 'avaliacao'
  - ‚úì descricao = parecer completo
  - ‚úì statusAnterior e statusNovo corretamente preenchidos
  - ‚úì Data/hora atual em formato ISO
  - ‚úì Hist√≥rico mant√©m ordem cronol√≥gica

---

#### RF-AVAL-008: Atualiza√ß√£o de Status e Persist√™ncia

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve atualizar status da proposi√ß√£o e salvar todas as altera√ß√µes.
- **Entrada:** Dados da avalia√ß√£o processados
- **Processamento:**
  1. Atualizar campo `proposicao.status` com novo valor
  2. Adicionar entrada no hist√≥rico (ver RF-AVAL-007)
  3. Salvar proposi√ß√£o no localStorage
  4. Recalcular status da correi√ß√£o vinculada
  5. Atualizar todos os registros afetados
  6. Exibir mensagem de sucesso
  7. Redirecionar para `index.html`
- **Sa√≠da:**
  - Sucesso: "Avalia√ß√£o registrada com sucesso!" + redirect
  - Falha: Mensagem de erro espec√≠fica
- **Regras de Neg√≥cio:**
  - RN-AVAL-19: Todas as mudan√ßas salvas atomicamente
  - RN-AVAL-20: Status da correi√ß√£o recalculado automaticamente
  - RN-AVAL-21: Avalia√ß√£o √© irrevers√≠vel (n√£o pode desfazer)
- **Crit√©rios de Aceite:**
  - ‚úì Status da proposi√ß√£o atualizado corretamente
  - ‚úì Hist√≥rico cont√©m nova entrada
  - ‚úì Dados salvos no localStorage
  - ‚úì Status da correi√ß√£o recalculado (ativo/inativo)
  - ‚úì Mensagem de sucesso exibida
  - ‚úì Redirect para index.html funcionaAVAL-22: Valida√ß√µes ocorrem no frontend E backend
  - RN-AVAL-23: Parecer tem m√≠nimo de 50 caracteres
- **Crit√©rios de Aceite:**
  - ‚úì Submeter sem decis√£o: erro "Selecione uma decis√£o"
  - ‚úì Submeter sem parecer: erro "Parecer obrigat√≥rio"
  - ‚úì Parecer < 50 chars: erro "M√≠nimo 50 caracteres"
  - ‚úì Parecer > 7.500 chars: contador vermelho + erro
  - ‚úì Campos v√°lidos: permite submiss√£o

---

#### RF-AVAL-010: Cancelamento e Navega√ß√£o

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir cancelar avalia√ß√£o e voltar sem salvar.
- **Entrada:** Clique no breadcrumb "‚Üê Voltar" ou bot√£o "Cancelar"
- **Processamento:**
  1. Verificar se formul√°rio foi alterado (dirty state)
  2. Se alterado:
     - Exibir confirma√ß√£o: "Deseja sair sem salvar? A avalia√ß√£o ser√° perdida."
  3. Se confirmar ou se n√£o alterado:
     - Redirecionar para `index.html`
  4. Se cancelar confirma√ß√£o:
     - Permanecer na p√°gina
- **Sa√≠da:** Navega√ß√£o para p√°gina anterior
- **Regras de Neg√≥cio:**
  - RN-AVAL-24: Alertar sobre perda de dados n√£o salvos
  - RN-AVAL-25: Proposi√ß√£o permanece com status original
- **Crit√©rios de Aceite:**
  - ‚úì Breadcrumb "‚Üê Voltar" funcional
  - ‚úì Formul√°rio n√£o alterado: sai direto
  - ‚úì Formul√°rio alterado: exibe confirma√ß√£o
  - ‚úì Confirmar: navega sem salvar
  - ‚úì Cancelar: permanece na p√°gina
  - ‚úì Status da proposi√ß√£o n√£o √© alterado ao cancelar

---

### 2.8 RF-BUSCA: Busca e Filtros

Este m√≥dulo define funcionalidades de busca e filtragem que s√£o utilizadas de forma transversal em diversas p√°ginas do sistema (Dashboard, Correi√ß√µes, Proposi√ß√µes, Publica√ß√£o).

---

#### RF-BUSCA-001: Busca Textual Multi-campo

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir busca textual simult√¢nea em m√∫ltiplos campos relevantes.
- **Entrada:** Texto digitado no campo de busca
- **Processamento:**
  1. **Correi√ß√µes Table:** Buscar em `numero`, `ramoMP`, `ramoMPNome`, `tematica`, `numeroElo`, `tipo`
  2. **Proposi√ß√µes Table:** Buscar em `numero`, `tipo`, `unidade`, `membro`, `descricao`
  3. **Publica√ß√£o Table:** Buscar em `numero`, `tipo`, `unidade`, `membro`, `descricao`
  4. Aplicar busca case-insensitive (ignorar mai√∫sculas/min√∫sculas)
  5. Buscar substring (n√£o apenas palavra completa)
  6. Aplicar filtros em tempo real (sem necessidade de bot√£o "Buscar")
  7. Combinar com outros filtros ativos (l√≥gica AND)
- **Sa√≠da:** Lista filtrada de registros + contador de resultados
- **Regras de Neg√≥cio:**
  - RN-BUSCA-01: Busca √© case-insensitive para facilitar uso
  - RN-BUSCA-02: Busca por substring (permite busca parcial)
  - RN-BUSCA-03: Busca em tempo real (sem delay > 300ms)
  - RN-BUSCA-04: Busca combinada com outros filtros (AND logic)
- **Crit√©rios de Aceite:**
  - ‚úì Buscar "MPBA" retorna todos registros com "MPBA" em qualquer campo indexado
  - ‚úì Buscar "cachoeira" encontra "Promotoria de Justi√ßa de Cachoeira"
  - ‚úì Buscar "COR-2024" filtra correi√ß√µes com esse padr√£o no n√∫mero
  - ‚úì Busca + filtro de status funcionam em conjunto
  - ‚úì Contador atualiza dinamicamente: "Mostrando X resultado(s)"
  - ‚úì Campo vazio remove filtro de busca

---

#### RF-BUSCA-002: Filtro por Status Processual

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir filtragem por status processual da proposi√ß√£o.
- **Entrada:** Sele√ß√£o no dropdown "Status Processual"
- **Processamento:**
  1. Apresentar op√ß√µes:
     - "" (vazio) - Todos os status
     - "pendente" - Pendente
     - "aguardando_comprovacao" - Aguardando Comprova√ß√£o
     - "em_analise" - Em An√°lise
     - "encerrada" - Encerrada
  2. Filtrar `proposicao.status[0]` (√≠ndice 0 = status processual)
  3. Aplicar filtro em tempo real
  4. Combinar com outros filtros ativos
- **Sa√≠da:** Lista filtrada de proposi√ß√µes
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-04: Status √© array bidimensional [statusProcessual, valoracao]
  - RN-BUSCA-05: Filtro de status processual independente de valora√ß√£o
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown com 5 op√ß√µes (vazio + 4 status)
  - ‚úì Selecionar "pendente" mostra apenas proposi√ß√µes com status[0] = 'pendente'
  - ‚úì Op√ß√£o vazia mostra todos os status
  - ‚úì Combina com busca textual e outros filtros

---

#### RF-BUSCA-003: Filtro por Valora√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir filtragem por valora√ß√£o da proposi√ß√£o.
- **Entrada:** Sele√ß√£o no dropdown "Valora√ß√£o"
- **Processamento:**
  1. Apresentar op√ß√µes:
     - "" (vazio) - Todas as valora√ß√µes
     - "nova" - Nova (sem avalia√ß√£o)
     - "finalizada" - Finalizada (totalmente cumprida)
     - "parcial" - Parcial (parcialmente cumprida)
     - "em_andamento" - Em Andamento (n√£o cumprida)
     - "prejudicada" - Prejudicada (superada/n√£o aplic√°vel)
  2. Filtrar `proposicao.status[1]` (√≠ndice 1 = valora√ß√£o)
  3. Aplicar filtro em tempo real
  4. Combinar com outros filtros ativos
- **Sa√≠da:** Lista filtrada de proposi√ß√µes
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-04: Status √© array bidimensional [statusProcessual, valoracao]
  - RN-BUSCA-06: Filtro de valora√ß√£o independente de status processual
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown com 6 op√ß√µes (vazio + 5 valora√ß√µes)
  - ‚úì Selecionar "finalizada" mostra apenas proposi√ß√µes com status[1] = 'finalizada'
  - ‚úì Op√ß√£o vazia mostra todas as valora√ß√µes
  - ‚úì Combina com status processual e outros filtros

---

#### RF-BUSCA-004: Filtro por Tags

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir filtragem por tags de categoriza√ß√£o.
- **Entrada:** Sele√ß√£o no dropdown "Tag"
- **Processamento:**
  1. Apresentar op√ß√µes (11 tags predefinidas):
     - "" (vazio) - Todas as tags
     - "administrativo", "recursos-humanos", "infraestrutura", "tecnologia"
     - "processual", "financeiro", "capacitacao", "gestao-documental"
     - "compliance", "transparencia", "outros"
  2. Filtrar proposi√ß√µes onde `tags[]` array cont√©m tag selecionada
  3. Aplicar filtro em tempo real
  4. Combinar com outros filtros ativos
- **Sa√≠da:** Lista filtrada de proposi√ß√µes
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-06: Tags s√£o array de IDs
  - RN-BUSCA-07: Tag filter verifica presen√ßa no array (n√£o igualdade)
  - RN-BUSCA-08: Proposi√ß√µes sem tags n√£o aparecem quando tag selecionada
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown com 12 op√ß√µes (vazio + 11 tags)
  - ‚úì Selecionar "tecnologia" mostra proposi√ß√µes com 'tecnologia' no array tags
  - ‚úì Proposi√ß√£o com m√∫ltiplas tags aparece em qualquer filtro correspondente
  - ‚úì Op√ß√£o vazia mostra todas as proposi√ß√µes (com ou sem tags)

---

#### RF-BUSCA-005: Filtro por Prioridade

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir filtragem por prioridade da proposi√ß√£o.
- **Entrada:** Sele√ß√£o no dropdown "Prioridade"
- **Processamento:**
  1. Apresentar op√ß√µes:
     - "" (vazio) - Todas as prioridades
     - "urgente" - Urgente (prazo cr√≠tico)
     - "alta" - Alta (aten√ß√£o priorit√°ria)
     - "normal" - Normal (prioridade padr√£o)
  2. Filtrar proposi√ß√µes por campo `prioridade`
  3. Aplicar filtro em tempo real
  4. Combinar com outros filtros ativos
- **Sa√≠da:** Lista filtrada de proposi√ß√µes
- **Regras de Neg√≥cio:**
  - RN-BUSCA-09: Prioridades t√™m visual diferenciado (urgente=vermelho, alta=laranja, normal=preto)
  - RN-BUSCA-10: Default √© "normal" se n√£o especificado
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown com 4 op√ß√µes (vazio + 3 prioridades)
  - ‚úì Selecionar "urgente" mostra apenas proposi√ß√µes urgentes
  - ‚úì Visual coding mantido na lista filtrada
  - ‚úì Op√ß√£o vazia mostra todas as prioridades

---

#### RF-BUSCA-006: Filtro por Tipo de Proposi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir filtragem por tipo de proposi√ß√£o (Determina√ß√£o/Recomenda√ß√£o).
- **Entrada:** Sele√ß√£o no dropdown "Tipo"
- **Processamento:**
  1. Apresentar op√ß√µes:
     - "" (vazio) - Todos os tipos
     - "Determina√ß√£o" - Proposi√ß√µes mandat√≥rias
     - "Recomenda√ß√£o" - Proposi√ß√µes consultivas
  2. Filtrar proposi√ß√µes por campo `tipo`
  3. Aplicar filtro em tempo real
  4. Combinar com outros filtros ativos
- **Sa√≠da:** Lista filtrada de proposi√ß√µes
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-02: Tipo aceita apenas "Determina√ß√£o" ou "Recomenda√ß√£o"
  - RN-BUSCA-11: Tipo afeta prioridade de cumprimento (determina√ß√£o > recomenda√ß√£o)
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown com 3 op√ß√µes (vazio + 2 tipos)
  - ‚úì Selecionar "Determina√ß√£o" mostra apenas proposi√ß√µes mandat√≥rias
  - ‚úì Op√ß√£o vazia mostra todos os tipos

---

#### RF-BUSCA-007: Filtro por Correi√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** O sistema deve permitir filtragem de proposi√ß√µes por correi√ß√£o vinculada.
- **Entrada:** Sele√ß√£o no dropdown "Correi√ß√£o"
- **Processamento:**
  1. Apresentar op√ß√µes:
     - "" (vazio) - Todas as correi√ß√µes
     - Lista de correi√ß√µes ativas (numero + ramoMP)
  2. Filtrar proposi√ß√µes por campo `correicaoId`
  3. Aplicar filtro em tempo real
  4. Combinar com outros filtros ativos
- **Sa√≠da:** Lista filtrada de proposi√ß√µes
- **Regras de Neg√≥cio:**
  - [MD] RN-PROP-01: Toda proposi√ß√£o DEVE ter correicaoId v√°lido
  - RN-BUSCA-12: Dropdown respeita permiss√µes (user v√™ apenas seu MP, admin v√™ todos)
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown com todas as correi√ß√µes dispon√≠veis
  - ‚úì Formato exibido: "COR-2024-01 (MPBA)"
  - ‚úì Selecionar correi√ß√£o filtra apenas proposi√ß√µes vinculadas
  - ‚úì User v√™ apenas correi√ß√µes de seu ramoMP
  - ‚úì Admin v√™ todas as correi√ß√µes

---

#### RF-BUSCA-008: Filtro de Status de Correi√ß√£o

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir filtragem de correi√ß√µes por status (ativo/inativo).
- **Entrada:** Sele√ß√£o no dropdown "Status" na p√°gina de Correi√ß√µes
- **Processamento:**
  1. Apresentar op√ß√µes:
     - "" - Todas (ativas e inativas)
     - "ativo" - Apenas Ativas
     - "inativo" - Apenas Inativas
  2. Filtrar correi√ß√µes por campo `status` (calculado automaticamente)
  3. Aplicar filtro em tempo real
  4. Combinar com busca textual
- **Sa√≠da:** Lista filtrada de correi√ß√µes
- **Regras de Neg√≥cio:**
  - [MD] RN-COR-03: Status calculado automaticamente (ativo = tem proposi√ß√µes pendentes)
  - RN-BUSCA-13: Filtro aplicado AP√ìS c√°lculo de status
- **Crit√©rios de Aceite:**
  - ‚úì Dropdown com 3 op√ß√µes
  - ‚úì "Apenas Ativas" mostra correi√ß√µes com proposi√ß√µes n√£o finalizadas
  - ‚úì "Apenas Inativas" mostra correi√ß√µes com todas proposi√ß√µes finalizadas
  - ‚úì Op√ß√£o vazia mostra todas

---

#### RF-BUSCA-009: Bot√£o "Limpar Filtros"

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve permitir resetar todos os filtros ativos com um √∫nico clique.
- **Entrada:** Clique no bot√£o "üîÑ Limpar Filtros"
- **Processamento:**
  1. Resetar campo de busca textual (vazio)
  2. Resetar todos os dropdowns para op√ß√£o vazia
  3. Manter correi√ß√£o selecionada (se aplic√°vel)
  4. Re-renderizar tabela com dados completos
  5. Atualizar contador de resultados
- **Sa√≠da:** Tabela com todos os registros vis√≠veis
- **Regras de Neg√≥cio:**
  - RN-BUSCA-14: Limpar filtros N√ÉO reseta sele√ß√£o de correi√ß√£o (se obrigat√≥ria)
  - RN-BUSCA-15: Limpar filtros N√ÉO reseta sele√ß√£o de checkboxes (em Publica√ß√£o)
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o vis√≠vel pr√≥ximo aos filtros
  - ‚úì Um clique limpa todos os filtros simultaneamente
  - ‚úì Tabela atualiza imediatamente
  - ‚úì Contador mostra total de registros
  - ‚úì Correi√ß√£o selecionada (Proposi√ß√µes/Publica√ß√£o) mantida

---

#### RF-BUSCA-010: Contador de Resultados

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve exibir contador din√¢mico de resultados filtrados.
- **Entrada:** Qualquer mudan√ßa nos filtros ou busca
- **Processamento:**
  1. Contar registros que passaram pelos filtros
  2. Atualizar contador em tempo real
  3. Exibir mensagem contextual
- **Sa√≠da:** Mensagem formatada
- **Formato de Exibi√ß√£o:**
  - Proposi√ß√µes: "Mostrando X de Y proposi√ß√£o(√µes)"
  - Correi√ß√µes: "X correi√ß√£o(√µes) encontrada(s)"
  - Publica√ß√£o: "X proposi√ß√£o(√µes) pendente(s)"
- **Regras de Neg√≥cio:**
  - RN-BUSCA-16: Contador atualiza em tempo real (< 300ms)
  - RN-BUSCA-17: Mensagem muda entre singular/plural dinamicamente
- **Crit√©rios de Aceite:**
  - ‚úì Contador vis√≠vel pr√≥ximo √† tabela
  - ‚úì Atualiza a cada mudan√ßa de filtro
  - ‚úì Formato singular (1 proposi√ß√£o) vs plural (X proposi√ß√µes)
  - ‚úì Mensagem clara e contextual √† p√°gina

---

### 2.9 RF-EXP: Exporta√ß√£o de Dados

Este m√≥dulo define funcionalidades de exporta√ß√£o de dados em formatos JSON e PDF, dispon√≠veis em 5 localiza√ß√µes estrat√©gicas do sistema.

---

#### RF-EXP-001: Dropdown de Exporta√ß√£o (Componente Compartilhado)

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** O sistema deve fornecer componente visual padronizado para exporta√ß√£o de dados.
- **Entrada:** Clique no bot√£o "üì• Exportar"
- **Processamento:**
  1. Exibir menu dropdown com op√ß√µes de exporta√ß√£o
  2. Op√ß√µes variam conforme contexto (Dashboard, Correi√ß√µes, Proposi√ß√µes, Modal, Publica√ß√£o)
  3. Fechar menu ao clicar fora (click-outside-to-close)
  4. Permitir apenas um menu aberto por vez
- **Sa√≠da:** Menu dropdown com 2-3 op√ß√µes de exporta√ß√£o
- **Regras de Neg√≥cio:**
  - RN-EXP-01: Estilos CSS centralizados (`.export-dropdown`, `.export-btn`, `.export-menu`)
  - RN-EXP-02: Comportamento consistente em todas as 5 localiza√ß√µes
  - RN-EXP-03: √çcones visuais para diferenciar JSON (üíæ) e PDF (üìÑ)
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o "üì• Exportar" com seta dropdown (‚ñº)
  - ‚úì Menu abre ao clicar no bot√£o
  - ‚úì Menu fecha ao clicar fora
  - ‚úì Apenas um menu aberto por vez no sistema
  - ‚úì Hover effect nos itens do menu

---

#### RF-EXP-002: Exporta√ß√£o JSON - Padr√£o Estrutural

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Todas as exporta√ß√µes JSON devem seguir estrutura padronizada.
- **Entrada:** Clique em op√ß√£o de exporta√ß√£o JSON
- **Processamento:**
  1. Construir objeto JSON com estrutura padr√£o:
     ```json
     {
       "titulo": "T√≠tulo Descritivo do Export",
       "dataExportacao": "ISO timestamp",
       "usuario": "ramoMP - ramoMPNome" | "Admin",
       "filtrosAplicados": { /* filtros ativos */ },
       "correicaoSelecionada": { /* se aplic√°vel */ },
       "totalRegistros": N,
       "dados": [ /* array de objetos */ ]
     }
     ```
  2. Pretty-print com indenta√ß√£o de 2 espa√ßos
  3. Criar Blob com tipo `application/json`
  4. Gerar nome de arquivo: `descricao-YYYY-MM-DD.json`
  5. Iniciar download via elemento `<a>` tempor√°rio
  6. Liberar mem√≥ria com `URL.revokeObjectURL()`
  7. Fechar menu de exporta√ß√£o
- **Sa√≠da:** Arquivo JSON baixado
- **Regras de Neg√≥cio:**
  - RN-EXP-04: JSON sempre pretty-printed (leg√≠vel)
  - RN-EXP-05: Timestamp em formato ISO 8601
  - RN-EXP-06: Filtros ativos preservados nos metadados
  - RN-EXP-07: Cleanup de mem√≥ria obrigat√≥rio
- **Crit√©rios de Aceite:**
  - ‚úì Arquivo JSON v√°lido e bem formatado
  - ‚úì Nome de arquivo descritivo com data
  - ‚úì Metadados completos (t√≠tulo, data, usu√°rio, filtros)
  - ‚úì Dados completos conforme contexto
  - ‚úì Download autom√°tico ao clicar

---

#### RF-EXP-003: Exporta√ß√£o PDF - Padr√£o Estrutural

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Todas as exporta√ß√µes PDF devem seguir estrutura padronizada.
- **Entrada:** Clique em op√ß√£o de exporta√ß√£o PDF
- **Processamento:**
  1. Construir HTML completo com estrutura:
     - DOCTYPE e meta charset UTF-8
     - T√≠tulo da p√°gina
     - Estilos CSS embutidos (@media print otimizado)
     - Header institucional CNMP
     - Conte√∫do formatado (tabelas/timeline/gr√°ficos)
     - Footer com data de gera√ß√£o
  2. Abrir nova janela com HTML gerado
  3. Aguardar onload ‚Üí disparar print dialog
  4. Aguardar onafterprint ‚Üí fechar janela
  5. Fechar menu de exporta√ß√£o
- **Sa√≠da:** Di√°logo de impress√£o do navegador ‚Üí PDF
- **Regras de Neg√≥cio:**
  - RN-EXP-08: Fonte Arial sans-serif (exceto Of√≠cio = Times New Roman)
  - RN-EXP-09: Header CNMP com borda inferior azul (#003366)
  - RN-EXP-10: Estilos @media print para otimizar impress√£o
  - RN-EXP-11: Page-break-after para relat√≥rios longos
- **Crit√©rios de Aceite:**
  - ‚úì Header institucional CNMP em todas as p√°ginas
  - ‚úì Conte√∫do formatado profissionalmente
  - ‚úì Print dialog abre automaticamente
  - ‚úì Janela fecha ap√≥s impress√£o/cancelamento
  - ‚úì Layout otimizado para papel A4

---

#### RF-EXP-004: Exporta√ß√£o do Dashboard

- **Prioridade:** [D] Desej√°vel
- **Descri√ß√£o:** Permitir exporta√ß√£o de dados do dashboard em JSON e PDF.
- **Localiza√ß√£o:** Header do Dashboard (index.html)
- **Entrada:** Menu dropdown com 2 op√ß√µes
- **Op√ß√µes:**
  1. **üìÑ Exportar PDF** - Relat√≥rio executivo visual
  2. **üíæ Exportar JSON** - Dados estruturados completos
- **Conte√∫do JSON:**
  - T√≠tulo, data, usu√°rio, filtro aplicado (correi√ß√£o ou "todas")
  - Estat√≠sticas (5 cards): correi√ß√µes realizadas/ativas, proposi√ß√µes totais/ativas, prazo vencido
  - Distribui√ß√£o status processual (4 categorias)
  - Distribui√ß√£o valora√ß√£o (5 categorias)
  - Array completo de correi√ß√µes e proposi√ß√µes (filtrado)
- **Conte√∫do PDF:**
  - Header CNMP + t√≠tulo "Dashboard Executivo"
  - Indica√ß√£o de filtro aplicado (se houver)
  - 5 cards de estat√≠sticas em grid 2x3
  - Gr√°fico de Fluxo de Trabalho (barras coloridas)
  - Gr√°fico de Valora√ß√£o (barras coloridas)
  - Footer com data/hora de gera√ß√£o
- **Regras de Neg√≥cio:**
  - RN-EXP-12: Exporta√ß√£o respeita filtro de correi√ß√£o ativo
  - RN-EXP-13: Gr√°ficos em PDF usam cores do sistema
- **Crit√©rios de Aceite:**
  - ‚úì JSON cont√©m estat√≠sticas completas
  - ‚úì PDF reproduz visualmente o dashboard
  - ‚úì Filtro de correi√ß√£o refletido nos dados exportados
  - ‚úì Gr√°ficos leg√≠veis no PDF

---

#### RF-EXP-005: Exporta√ß√£o da Tabela de Correi√ß√µes

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Permitir exporta√ß√£o de correi√ß√µes em 3 formatos.
- **Localiza√ß√£o:** Header da p√°gina Correi√ß√µes (index.html)
- **Entrada:** Menu dropdown com 3 op√ß√µes
- **Op√ß√µes:**
  1. **üìÑ Exportar PDF (Tabela)** - Tabela simples 13 colunas
  2. **üíæ Exportar JSON** - Dados estruturados com estat√≠sticas
  3. **üìã Relat√≥rio Detalhado (PDF)** - Breakdown completo por correi√ß√£o
- **Conte√∫do JSON:**
  - T√≠tulo, data, usu√°rio, total de correi√ß√µes
  - Filtros aplicados (busca, status)
  - Array de correi√ß√µes com estat√≠sticas agregadas:
    - Metadados completos da correi√ß√£o
    - Estat√≠sticas: total proposi√ß√µes, pendente, aguardando, em an√°lise, encerrada, prazo vencido
- **Conte√∫do PDF (Tabela):**
  - Header CNMP + t√≠tulo "Correi√ß√µes CNMP"
  - Tabela com 13 colunas conforme UI
  - Todas as correi√ß√µes filtradas
  - Footer com data/hora e total
- **Conte√∫do PDF (Relat√≥rio Detalhado):**
  - Header CNMP + t√≠tulo "Relat√≥rio Detalhado de Correi√ß√µes"
  - Para cada correi√ß√£o:
    - Se√ß√£o com metadados completos
    - Breakdown "Status Processual" (4 contadores coloridos)
    - Breakdown "Valora√ß√£o" (5 contadores coloridos)
    - Separador visual entre correi√ß√µes
  - Footer com totais gerais
- **Regras de Neg√≥cio:**
  - RN-EXP-14: Exporta√ß√£o respeita filtros de busca e status ativos
  - RN-EXP-15: Relat√≥rio detalhado usa page-break entre correi√ß√µes
- **Crit√©rios de Aceite:**
  - ‚úì 3 op√ß√µes no menu dropdown
  - ‚úì JSON cont√©m correi√ß√µes com estat√≠sticas agregadas
  - ‚úì PDF tabela reproduz visualmente tabela da UI
  - ‚úì PDF detalhado mostra breakdown completo
  - ‚úì Filtros aplicados refletidos nos dados

---

#### RF-EXP-006: Exporta√ß√£o da P√°gina de Proposi√ß√µes

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Permitir exporta√ß√£o de proposi√ß√µes em 3 formatos.
- **Localiza√ß√£o:** Header de proposicoes.html
- **Entrada:** Menu dropdown com 3 op√ß√µes
- **Op√ß√µes:**
  1. **üìÑ Exportar PDF (Vis√£o Atual)** - Tabela 7 colunas filtrada
  2. **üíæ Exportar JSON** - Dados estruturados com filtros
  3. **üìã Relat√≥rio Completo (PDF)** - Detalhes + timelines completas
- **Conte√∫do JSON:**
  - T√≠tulo, data, usu√°rio, total proposi√ß√µes
  - Correi√ß√£o selecionada (obrigat√≥ria): id, numero, tematica, ramoMP, ramoMPNome
  - Filtros aplicados (busca, tipo, status, tag, prioridade)
  - Array de proposi√ß√µes filtradas (dados completos + historico)
- **Conte√∫do PDF (Vis√£o Atual):**
  - Header CNMP + t√≠tulo "Proposi√ß√µes - [Correi√ß√£o]"
  - Informa√ß√µes da correi√ß√£o selecionada
  - Tabela 7 colunas: N√∫mero, Tipo, Unidade, Descri√ß√£o, Tags, Status, (sem a√ß√µes)
  - Todas as proposi√ß√µes filtradas
  - Footer com data/hora e total
- **Conte√∫do PDF (Relat√≥rio Completo):**
  - Header CNMP + t√≠tulo "Relat√≥rio Completo de Proposi√ß√µes"
  - Para cada proposi√ß√£o:
    - Metadados completos (todos os campos)
    - Timeline hist√≥rica completa:
      - üì§ Publica√ß√µes (fundo laranja, mostra prazoComprovacao)
      - üìé Comprova√ß√µes (fundo azul, mostra arquivos)
      - ‚öñÔ∏è Avalia√ß√µes (fundo verde, mostra parecer)
    - Page-break entre proposi√ß√µes
  - Footer com totais
- **Regras de Neg√≥cio:**
  - RN-EXP-16: Exporta√ß√£o REQUER correi√ß√£o selecionada
  - RN-EXP-17: Relat√≥rio completo inclui timeline color-coded
  - RN-EXP-18: Filtros aplicados salvos nos metadados JSON
- **Crit√©rios de Aceite:**
  - ‚úì Alerta se correi√ß√£o n√£o selecionada
  - ‚úì JSON cont√©m correi√ß√£o + proposi√ß√µes + filtros
  - ‚úì PDF vis√£o atual reproduz tabela simplificada
  - ‚úì PDF completo mostra timelines com cores corretas
  - ‚úì Arquivos anexos listados nas comprova√ß√µes

---

#### RF-EXP-007: Exporta√ß√£o do Modal de Detalhes

- **Prioridade:** [D] Desej√°vel
- **Descri√ß√£o:** Permitir exporta√ß√£o de proposi√ß√£o individual a partir do modal de detalhes.
- **Localiza√ß√£o:** Header do modal de detalhes (index.html, proposicoes.html)
- **Entrada:** Menu dropdown com 2 op√ß√µes
- **Op√ß√µes:**
  1. **üìÑ Exportar PDF (Timeline)** - Foco no hist√≥rico audit√°vel
  2. **üíæ Exportar JSON** - Dados completos da proposi√ß√£o
- **Conte√∫do JSON:**
  - T√≠tulo, data, usu√°rio
  - Proposi√ß√£o completa (todos os campos + historico)
  - Correi√ß√£o vinculada (metadados)
- **Conte√∫do PDF (Timeline):**
  - Header CNMP + t√≠tulo "Proposi√ß√£o [n√∫mero]"
  - Metadados da proposi√ß√£o em grid
  - Informa√ß√µes da correi√ß√£o vinculada
  - **Timeline hist√≥rica completa:**
    - Ordena√ß√£o cronol√≥gica (oldest ‚Üí newest)
    - √çcones e cores por tipo: üì§ (laranja), üìé (azul), ‚öñÔ∏è (verde)
    - Cada entrada mostra: data, usu√°rio, descri√ß√£o, observa√ß√µes
    - Publica√ß√£o: mostra prazoComprovacao
    - Comprova√ß√£o: mostra lista de arquivos
    - Avalia√ß√£o: mostra transi√ß√µes statusAnterior ‚Üí statusNovo
  - Footer com data/hora
- **Regras de Neg√≥cio:**
  - RN-EXP-19: Usa `currentDetailProposicaoId` global (definido em viewDetails)
  - RN-EXP-20: PDF focado em auditoria (timeline √© elemento principal)
- **Crit√©rios de Aceite:**
  - ‚úì Bot√£o de exporta√ß√£o compacto no header do modal
  - ‚úì JSON cont√©m proposi√ß√£o + correi√ß√£o completa
  - ‚úì PDF timeline visualmente id√™ntico √† UI
  - ‚úì Cores corretas (laranja/azul/verde)
  - ‚úì Arquivos anexos listados

---

#### RF-EXP-008: Exporta√ß√£o da P√°gina de Publica√ß√£o

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Permitir exporta√ß√£o de proposi√ß√µes pendentes e gera√ß√£o de of√≠cio legal.
- **Localiza√ß√£o:** Header de publicacao.html (admin-only)
- **Entrada:** Menu dropdown com 3 op√ß√µes
- **Op√ß√µes:**
  1. **üíæ Exportar Pendentes (JSON)** - Todas pendentes da correi√ß√£o
  2. **üíæ Exportar Selecionadas (JSON)** - Apenas checkboxes marcados
  3. **üìú Gerar Of√≠cio de Publica√ß√£o (PDF)** - Documento legal formal
- **Conte√∫do JSON (Pendentes):**
  - T√≠tulo "Proposi√ß√µes Pendentes - Publica√ß√£o"
  - Data, usu√°rio, total pendentes
  - Correi√ß√£o selecionada (metadados)
  - Array: todas proposi√ß√µes com status[0] = 'pendente'
- **Conte√∫do JSON (Selecionadas):**
  - T√≠tulo "Proposi√ß√µes Selecionadas para Publica√ß√£o"
  - Data, usu√°rio, total selecionadas
  - Correi√ß√£o selecionada (metadados)
  - Array: apenas proposi√ß√µes com checkbox marcado
- **Conte√∫do PDF (Of√≠cio - FORMATO ESPECIAL):**
  - **Fonte:** Times New Roman 12pt (formal)
  - **Line height:** 1.8 (espa√ßamento formal)
  - **Estrutura:**
    1. Header institucional:
       - CONSELHO NACIONAL DO MINIST√âRIO P√öBLICO
       - Corregedoria Nacional
       - Borda inferior
    2. Identifica√ß√£o:
       - OF√çCIO N¬∫ _____ /CNMP-CN
       - Bras√≠lia-DF, [data atual por extenso]
    3. Destinat√°rio:
       - "Ao(√Ä) Excelent√≠ssimo(a) Senhor(a)"
       - [ramoMPNome da correi√ß√£o]
       - "Ref.: Correi√ß√£o [numero]"
    4. Corpo:
       - Sauda√ß√£o formal: "Senhor(a) Procurador(a)-Geral,"
       - Fundamenta√ß√£o legal (LC 75/1993, Regimento CNMP)
       - Declara√ß√£o de publica√ß√£o com detalhes da correi√ß√£o
       - Prazo de comprova√ß√£o (do formul√°rio ou "[A DEFINIR]")
    5. Lista numerada de proposi√ß√µes:
       - Cada proposi√ß√£o em box estilizado
       - N√∫mero + TIPO (uppercase)
       - Unidade respons√°vel
       - Descri√ß√£o completa
    6. Assinatura:
       - Linha para assinatura
       - "[NOME DO CORREGEDOR NACIONAL]"
       - "Corregedor Nacional do Minist√©rio P√∫blico"
- **Regras de Neg√≥cio:**
  - RN-EXP-21: Of√≠cio usa Times New Roman (padr√£o institucional brasileiro)
  - RN-EXP-22: Prazo no of√≠cio vem do campo prazoComprovacao do formul√°rio
  - RN-EXP-23: Se prazo n√£o definido, exibe "[A DEFINIR]"
  - RN-EXP-24: Alerta se nenhuma proposi√ß√£o selecionada (op√ß√µes 2 e 3)
- **Crit√©rios de Aceite:**
  - ‚úì Exportar pendentes: alerta se nenhuma pendente
  - ‚úì Exportar selecionadas: alerta se nenhuma selecionada
  - ‚úì JSON pendentes cont√©m todas com status='pendente'
  - ‚úì JSON selecionadas cont√©m apenas marcadas
  - ‚úì Of√≠cio formatado conforme padr√£o legal brasileiro
  - ‚úì Of√≠cio lista todas as proposi√ß√µes selecionadas
  - ‚úì Prazo exibido corretamente no of√≠cio

---

#### RF-EXP-009: Valida√ß√µes e Mensagens de Erro

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve validar condi√ß√µes antes de exportar e exibir mensagens claras.
- **Entrada:** Tentativa de exporta√ß√£o em condi√ß√£o inv√°lida
- **Processamento:**
  1. **Valida√ß√£o 1:** Dados dispon√≠veis
     - Se array vazio ‚Üí Alert: "Nenhum dado dispon√≠vel para exporta√ß√£o."
  2. **Valida√ß√£o 2:** Correi√ß√£o selecionada (Proposi√ß√µes/Publica√ß√£o)
     - Se n√£o selecionada ‚Üí Alert: "Selecione uma correi√ß√£o antes de exportar."
  3. **Valida√ß√£o 3:** Proposi√ß√µes selecionadas (Publica√ß√£o - Selecionadas/Of√≠cio)
     - Se nenhuma marcada ‚Üí Alert: "Selecione ao menos uma proposi√ß√£o para exportar."
  4. **Valida√ß√£o 4:** Proposi√ß√£o atual (Modal Detalhes)
     - Se `currentDetailProposicaoId` null ‚Üí Cancelar silenciosamente
  5. Se todas valida√ß√µes passarem ‚Üí Prosseguir com exporta√ß√£o
- **Sa√≠da:** Mensagens de alerta ou exporta√ß√£o bem-sucedida
- **Regras de Neg√≥cio:**
  - RN-EXP-25: Valida√ß√µes antes de processar exporta√ß√£o
  - RN-EXP-26: Mensagens de erro claras e acion√°veis
- **Crit√©rios de Aceite:**
  - ‚úì Alert ao tentar exportar sem dados
  - ‚úì Alert ao exportar proposi√ß√µes sem correi√ß√£o
  - ‚úì Alert ao exportar selecionadas sem marcar checkboxes
  - ‚úì Mensagens em portugu√™s claro
  - ‚úì N√£o gera arquivo se valida√ß√£o falhar

---

#### RF-EXP-010: Limpeza de Mem√≥ria e Performance

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Sistema deve gerenciar mem√≥ria adequadamente durante exporta√ß√µes.
- **Entrada:** Conclus√£o de exporta√ß√£o JSON
- **Processamento:**
  1. Ap√≥s `link.click()` ‚Üí Remover elemento link do DOM
  2. Chamar `URL.revokeObjectURL(url)` ‚Üí Liberar mem√≥ria do Blob
  3. Fechar menu dropdown de exporta√ß√£o
  4. Registrar exporta√ß√£o (analytics - futuro)
- **Sa√≠da:** Mem√≥ria liberada, UI limpa
- **Regras de Neg√≥cio:**
  - RN-EXP-27: Cleanup obrigat√≥rio ap√≥s cada download
  - RN-EXP-28: Menu dropdown fechado ap√≥s exporta√ß√£o
  - RN-EXP-29: Link tempor√°rio removido do DOM
- **Crit√©rios de Aceite:**
  - ‚úì `URL.revokeObjectURL()` chamado ap√≥s download
  - ‚úì Elemento `<a>` tempor√°rio removido
  - ‚úì Menu dropdown fechado automaticamente
  - ‚úì Sem memory leaks em exporta√ß√µes consecutivas
  - ‚úì Performance consistente em datasets grandes

---

### 2.10 RF-HIST: Hist√≥rico e Auditoria

Este m√≥dulo define funcionalidades de registro hist√≥rico e trilha de auditoria, essenciais para rastreabilidade e compliance.

---

#### RF-HIST-001: Estrutura do Array Historico

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Toda proposi√ß√£o deve manter array historico com estrutura padronizada.
- **Entrada:** Cria√ß√£o de proposi√ß√£o
- **Processamento:**
  1. Inicializar `proposicao.historico = []` (array vazio)
  2. Cada entrada no array deve conter:
     ```json
     {
       "tipo": "publicacao" | "comprovacao" | "avaliacao",
       "data": "ISO timestamp",
       "usuario": "string (ramoMP ou 'Corregedoria Nacional')",
       "descricao": "string",
       "observacoes": "string | null",
       "arquivos": ["filename1", "filename2"] | null,  // comprovacao only
       "prazoComprovacao": "YYYY-MM-DD" | null,        // publicacao only
       "statusAnterior": ["processual", "valoracao"],  // publicacao/avaliacao
       "statusNovo": ["processual", "valoracao"]       // publicacao/avaliacao
     }
     ```
  3. Manter ordem cronol√≥gica (append-only)
- **Sa√≠da:** Estrutura de dados consistente
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-01: Hist√≥rico √© append-only (nunca deletar/editar)
  - [MD] RN-HIST-02: Ordem cronol√≥gica obrigat√≥ria
  - [MD] RN-HIST-03: Campos condicionais conforme tipo
- **Crit√©rios de Aceite:**
  - ‚úì Proposi√ß√£o nova tem historico = []
  - ‚úì Cada entrada tem tipo + data + usuario + descricao
  - ‚úì Campos espec√≠ficos presentes conforme tipo
  - ‚úì Timestamps em formato ISO 8601
  - ‚úì Array nunca null (vazio se sem hist√≥rico)

---

#### RF-HIST-002: Registro de Publica√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve registrar publica√ß√£o de proposi√ß√£o no hist√≥rico.
- **Entrada:** Publica√ß√£o de proposi√ß√£o(√µes) via publicacao.html
- **Processamento:**
  1. Para cada proposi√ß√£o publicada, criar entrada:
     ```json
     {
       "tipo": "publicacao",
       "data": "2025-12-10T14:30:00.000Z",
       "usuario": "Corregedoria Nacional",
       "descricao": "Proposi√ß√£o publicada para MPBA - Minist√©rio P√∫blico do Estado da Bahia",
       "observacoes": "Texto do campo observa√ß√µes ou null",
       "prazoComprovacao": "2025-12-31",
       "statusAnterior": ["pendente", "nova"],
       "statusNovo": ["aguardando_comprovacao", "nova"]
     }
     ```
  2. Adicionar ao final de `proposicao.historico[]`
  3. Preservar todas publica√ß√µes anteriores (republica√ß√µes geram novas entradas)
- **Sa√≠da:** Entrada de publica√ß√£o no hist√≥rico
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-03: Tipo 'publicacao' com prazoComprovacao obrigat√≥rio
  - RN-HIST-04: Descri√ß√£o menciona √≥rg√£o destinat√°rio (ramoMP + ramoMPNome)
  - RN-HIST-05: Republica√ß√µes geram novas entradas (n√£o substituem anteriores)
  - RN-HIST-06: StatusAnterior sempre ['pendente', valoracao]
  - RN-HIST-07: StatusNovo sempre ['aguardando_comprovacao', valoracao]
- **Crit√©rios de Aceite:**
  - ‚úì Entrada criada ao publicar proposi√ß√£o
  - ‚úì prazoComprovacao preenchido com data do formul√°rio
  - ‚úì descricao menciona correi√ß√£o e √≥rg√£o
  - ‚úì Observa√ß√µes preservadas (ou null se vazio)
  - ‚úì Transi√ß√£o de status registrada
  - ‚úì Republica√ß√£o cria NOVA entrada (n√£o edita antiga)

---

#### RF-HIST-003: Registro de Comprova√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve registrar envio de comprova√ß√£o no hist√≥rico.
- **Entrada:** Envio de comprova√ß√£o via comprovacao.html
- **Processamento:**
  1. Ao submeter comprova√ß√£o, criar entrada:
     ```json
     {
       "tipo": "comprovacao",
       "data": "2025-12-15T10:45:00.000Z",
       "usuario": "MPBA - Minist√©rio P√∫blico do Estado da Bahia",
       "descricao": "Texto do campo 'Descri√ß√£o do Adimplemento' (at√© 7.500 chars)",
       "observacoes": "Texto do campo 'Observa√ß√µes Adicionais' ou null",
       "arquivos": ["relatorio_anual_2024.pdf", "planilha_dados.xlsx"]
     }
     ```
  2. Adicionar ao final de `proposicao.historico[]`
  3. Limpar rascunho ap√≥s submiss√£o (`proposicao.rascunhos = []`)
- **Sa√≠da:** Entrada de comprova√ß√£o no hist√≥rico
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-04: Tipo 'comprovacao' com arquivos[] obrigat√≥rio
  - RN-HIST-08: Usuario = ramoMP do correicionado
  - RN-HIST-09: Descri√ß√£o vem do campo principal (at√© 7.500 chars)
  - RN-HIST-10: Arquivos[] cont√©m nomes dos arquivos anexados
  - RN-HIST-11: Rascunho exclu√≠do ap√≥s submiss√£o
- **Crit√©rios de Aceite:**
  - ‚úì Entrada criada ao enviar comprova√ß√£o
  - ‚úì descricao cont√©m texto do adimplemento
  - ‚úì observacoes preservadas (ou null)
  - ‚úì arquivos[] lista todos os anexos
  - ‚úì usuario identifica o MP correicionado
  - ‚úì Rascunho removido ap√≥s submiss√£o

---

#### RF-HIST-004: Registro de Avalia√ß√£o

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve registrar avalia√ß√£o de comprova√ß√£o no hist√≥rico.
- **Entrada:** Submiss√£o de avalia√ß√£o via avaliacao.html
- **Processamento:**
  1. Ao submeter avalia√ß√£o, criar entrada:
     ```json
     {
       "tipo": "avaliacao",
       "data": "2025-12-20T16:00:00.000Z",
       "usuario": "Corregedoria Nacional",
       "descricao": "Texto do parecer (at√© 7.500 chars)",
       "observacoes": null,
       "statusAnterior": ["em_analise", "nova"],
       "statusNovo": ["encerrada", "finalizada"]  // ou ['pendente', 'parcial'], etc.
     }
     ```
  2. Adicionar ao final de `proposicao.historico[]`
  3. StatusNovo reflete decis√£o do avaliador
  4. Preservar decis√£o real mesmo se status da proposi√ß√£o for alterado (ex: parcial/em_andamento ‚Üí pendente)
- **Sa√≠da:** Entrada de avalia√ß√£o no hist√≥rico
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-05: Tipo 'avaliacao' com transi√ß√µes de status obrigat√≥rias
  - RN-HIST-12: Usuario sempre 'Corregedoria Nacional'
  - RN-HIST-13: descricao cont√©m parecer completo do avaliador
  - RN-HIST-14: statusNovo preserva decis√£o real (finalizada/parcial/em_andamento/prejudicada)
  - RN-HIST-15: Mesmo se status da proposi√ß√£o mudar para 'pendente', hist√≥rico preserva 'parcial' ou 'em_andamento'
- **Crit√©rios de Aceite:**
  - ‚úì Entrada criada ao submeter avalia√ß√£o
  - ‚úì descricao cont√©m parecer do avaliador
  - ‚úì statusAnterior = ['em_analise', valoracao anterior]
  - ‚úì statusNovo reflete decis√£o (finalizada/parcial/em_andamento/prejudicada)
  - ‚úì Hist√≥rico preserva decis√£o mesmo se status processual voltar para 'pendente'

---

#### RF-HIST-005: Imutabilidade do Hist√≥rico

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve garantir que hist√≥rico seja append-only (nunca editar/deletar).
- **Entrada:** Qualquer opera√ß√£o que tente modificar hist√≥rico
- **Processamento:**
  1. **Opera√ß√£o permitida:** `.push()` para adicionar nova entrada
  2. **Opera√ß√µes proibidas:**
     - Editar entrada existente
     - Deletar entrada
     - Reordenar entradas
     - Substituir array inteiro
  3. Valida√ß√£o durante persist√™ncia (localStorage)
  4. Valida√ß√£o durante exibi√ß√£o (renderiza√ß√£o)
- **Sa√≠da:** Integridade do hist√≥rico garantida
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-01: Hist√≥rico √© append-only (auditoria)
  - RN-HIST-16: Nunca editar entradas j√° criadas
  - RN-HIST-17: Nunca deletar entradas (mesmo em republica√ß√£o)
  - RN-HIST-18: Ordem cronol√≥gica mantida (n√£o reordenar)
- **Crit√©rios de Aceite:**
  - ‚úì Apenas `.push()` usado para adicionar entradas
  - ‚úì Entradas antigas preservadas intactas
  - ‚úì Republica√ß√£o N√ÉO substitui publica√ß√£o anterior
  - ‚úì Re-avalia√ß√£o N√ÉO edita avalia√ß√£o anterior
  - ‚úì Timeline mostra TODAS as intera√ß√µes

---

#### RF-HIST-006: Renderiza√ß√£o de Timeline Visual

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve renderizar timeline visual color-coded do hist√≥rico.
- **Entrada:** Array `proposicao.historico[]`
- **Processamento:**
  1. Ordenar por data (cronologicamente: oldest ‚Üí newest)
  2. Para cada entrada, renderizar item de timeline:
     - **Publicacao (tipo='publicacao'):**
       - √çcone: üì§
       - Cor: Laranja (#ff8c00)
       - Exibir: data, usuario, descricao, prazoComprovacao, statusAnterior ‚Üí statusNovo
       - Observa√ß√µes (se presente)
     - **Comprovacao (tipo='comprovacao'):**
       - √çcone: üìé
       - Cor: Azul (#0066cc)
       - Exibir: data, usuario, descricao, observacoes
       - Lista de arquivos anexados
     - **Avaliacao (tipo='avaliacao'):**
       - √çcone: ‚öñÔ∏è
       - Cor: Verde (#28a745)
       - Exibir: data, usuario, descricao (parecer), statusAnterior ‚Üí statusNovo
  3. Aplicar CSS: `.timeline-item`, `.timeline-publicacao`, `.timeline-comprovacao`, `.timeline-avaliacao`
  4. Exibir em modal de detalhes (index.html, proposicoes.html)
  5. Incluir em exports PDF (relat√≥rios completos)
- **Sa√≠da:** Timeline visual formatada
- **Regras de Neg√≥cio:**
  - RN-HIST-19: Ordena√ß√£o cronol√≥gica obrigat√≥ria
  - RN-HIST-20: Cores consistentes (laranja/azul/verde)
  - RN-HIST-21: √çcones visuais para identifica√ß√£o r√°pida
  - RN-HIST-22: Exibir TODOS os campos relevantes
- **Crit√©rios de Aceite:**
  - ‚úì Timeline ordenada cronologicamente (oldest first)
  - ‚úì Publica√ß√£o: fundo laranja, mostra prazo e transi√ß√£o
  - ‚úì Comprova√ß√£o: fundo azul, mostra arquivos
  - ‚úì Avalia√ß√£o: fundo verde, mostra parecer e transi√ß√£o
  - ‚úì √çcones visuais presentes (üì§üìé‚öñÔ∏è)
  - ‚úì Timeline leg√≠vel em modal e PDF

---

#### RF-HIST-007: Rastreabilidade de Transi√ß√µes de Status

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve manter rastreabilidade completa de todas as transi√ß√µes de status.
- **Entrada:** Qualquer mudan√ßa de status (publica√ß√£o/avalia√ß√£o)
- **Processamento:**
  1. **Em publica√ß√£o:**
     - statusAnterior: Status atual antes da publica√ß√£o
     - statusNovo: ['aguardando_comprovacao', valoracao]
  2. **Em avalia√ß√£o:**
     - statusAnterior: ['em_analise', valoracao anterior]
     - statusNovo: Depende da decis√£o:
       - Finalizada: ['encerrada', 'finalizada']
       - Prejudicada: ['encerrada', 'prejudicada']
       - Parcial: ['pendente', 'parcial']
       - Em Andamento: ['pendente', 'em_andamento']
  3. Armazenar ambos os status no hist√≥rico
  4. Exibir transi√ß√£o visual: "pendente ‚Üí aguardando_comprovacao"
- **Sa√≠da:** Hist√≥rico com transi√ß√µes documentadas
- **Regras de Neg√≥cio:**
  - [MD] RN-HIST-05: Transi√ß√µes de status registradas em publicacao e avaliacao
  - RN-HIST-23: statusAnterior = estado antes da opera√ß√£o
  - RN-HIST-24: statusNovo = estado ap√≥s a opera√ß√£o
  - RN-HIST-25: Preservar valoracao real mesmo se status processual mudar
- **Crit√©rios de Aceite:**
  - ‚úì Publica√ß√£o registra: ['pendente', X] ‚Üí ['aguardando_comprovacao', X]
  - ‚úì Avalia√ß√£o Finalizada: ['em_analise', Y] ‚Üí ['encerrada', 'finalizada']
  - ‚úì Avalia√ß√£o Parcial: ['em_analise', Y] ‚Üí ['pendente', 'parcial']
  - ‚úì Timeline exibe transi√ß√µes visualmente (badges coloridos)
  - ‚úì Transi√ß√µes preservadas mesmo ap√≥s republica√ß√£o

---

#### RF-HIST-008: Auditoria de Usu√°rios

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Sistema deve registrar quem realizou cada opera√ß√£o no hist√≥rico.
- **Entrada:** Qualquer adi√ß√£o ao hist√≥rico
- **Processamento:**
  1. **Para publica√ß√£o:** usuario = "Corregedoria Nacional"
  2. **Para comprova√ß√£o:** usuario = "[ramoMP] - [ramoMPNome]" (ex: "MPBA - Minist√©rio P√∫blico do Estado da Bahia")
  3. **Para avalia√ß√£o:** usuario = "Corregedoria Nacional"
  4. Armazenar string identificadora (n√£o apenas ID)
  5. Exibir em timeline e exports
- **Sa√≠da:** Identifica√ß√£o clara do respons√°vel
- **Regras de Neg√≥cio:**
  - RN-HIST-26: Campo usuario sempre preenchido (nunca null)
  - RN-HIST-27: Usuario identific√°vel por humanos (nome completo)
  - RN-HIST-28: Corregedoria Nacional = sempre Admin
  - RN-HIST-29: MPs identificados por sigla + nome completo
- **Crit√©rios de Aceite:**
  - ‚úì Publica√ß√£o: usuario = "Corregedoria Nacional"
  - ‚úì Comprova√ß√£o: usuario = "[ramoMP] - [ramoMPNome]"
  - ‚úì Avalia√ß√£o: usuario = "Corregedoria Nacional"
  - ‚úì String leg√≠vel em timeline e exports
  - ‚úì Nunca exibir apenas IDs num√©ricos

---

#### RF-HIST-009: Preserva√ß√£o de Republica√ß√µes

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve preservar hist√≥rico completo de republica√ß√µes (m√∫ltiplas publica√ß√µes da mesma proposi√ß√£o).
- **Entrada:** Republica√ß√£o de proposi√ß√£o j√° publicada anteriormente
- **Processamento:**
  1. **N√ÉO substituir** entrada de publica√ß√£o anterior
  2. **Adicionar nova entrada** ao final do array historico
  3. Nova entrada cont√©m:
     - Novo prazoComprovacao
     - Novas observa√ß√µes (se houver)
     - statusAnterior = ['pendente', valoracao atual]
     - statusNovo = ['aguardando_comprovacao', valoracao atual]
  4. Timeline mostra ambas as publica√ß√µes (e todas intermedi√°rias)
- **Sa√≠da:** Hist√≥rico completo de todas as publica√ß√µes
- **Regras de Neg√≥cio:**
  - RN-HIST-05: Republica√ß√£o gera nova entrada (n√£o edita anterior)
  - RN-HIST-30: Cada publica√ß√£o tem seu pr√≥prio prazoComprovacao
  - RN-HIST-31: Timeline mostra evolu√ß√£o completa: pub1 ‚Üí comp1 ‚Üí aval1 ‚Üí pub2 ‚Üí comp2 ‚Üí aval2
- **Crit√©rios de Aceite:**
  - ‚úì Republica√ß√£o cria nova entrada (n√£o edita)
  - ‚úì Publica√ß√µes anteriores preservadas intactas
  - ‚úì Timeline mostra TODAS as publica√ß√µes
  - ‚úì Cada publica√ß√£o com seu prazo espec√≠fico
  - ‚úì Auditoria completa de todo o ciclo iterativo

---

#### RF-HIST-010: Contador de Intera√ß√µes

- **Prioridade:** [D] Desej√°vel
- **Descri√ß√£o:** Sistema deve exibir contadores de intera√ß√µes por tipo no hist√≥rico.
- **Entrada:** Array `proposicao.historico[]`
- **Processamento:**
  1. Contar entradas por tipo:
     - Total publica√ß√µes: `historico.filter(h => h.tipo === 'publicacao').length`
     - Total comprova√ß√µes: `historico.filter(h => h.tipo === 'comprovacao').length`
     - Total avalia√ß√µes: `historico.filter(h => h.tipo === 'avaliacao').length`
  2. Exibir resumo antes da timeline:
     - "üì§ Publica√ß√µes: X | üìé Comprova√ß√µes: Y | ‚öñÔ∏è Avalia√ß√µes: Z"
  3. Atualizar contadores ao adicionar nova entrada
- **Sa√≠da:** Resumo visual de intera√ß√µes
- **Regras de Neg√≥cio:**
  - RN-HIST-32: Contadores calculados dinamicamente
  - RN-HIST-33: Exibi√ß√£o antes da timeline (contexto)
- **Crit√©rios de Aceite:**
  - ‚úì Resumo exibido acima da timeline
  - ‚úì Contadores corretos por tipo
  - ‚úì √çcones visuais (üì§üìé‚öñÔ∏è)
  - ‚úì Atualiza ao adicionar nova intera√ß√£o
  - ‚úì Formato: "Tipo: N | Tipo: N | Tipo: N"

---

### 2.11 RF-NOTIF: Notifica√ß√µes

Este m√≥dulo define funcionalidades de notifica√ß√£o e alertas visuais para usu√°rios do sistema.

---

#### RF-NOTIF-001: Mensagens de Sucesso

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve exibir mensagens de confirma√ß√£o ap√≥s opera√ß√µes bem-sucedidas.
- **Entrada:** Conclus√£o de opera√ß√£o (cadastro, edi√ß√£o, publica√ß√£o, envio, avalia√ß√£o)
- **Processamento:**
  1. Exibir alert() nativo do navegador com mensagem clara
  2. Mensagens espec√≠ficas por contexto:
     - Cadastro correi√ß√£o: "Correi√ß√£o cadastrada com sucesso!"
     - Cadastro proposi√ß√£o: "Proposi√ß√£o cadastrada com sucesso!"
     - Publica√ß√£o: "X proposi√ß√£o(√µes) publicada(s) com sucesso! Notifica√ß√µes enviadas por e-mail."
     - Comprova√ß√£o: "Comprova√ß√£o enviada com sucesso!"
     - Avalia√ß√£o: "Avalia√ß√£o registrada com sucesso!"
     - Edi√ß√£o: "Dados atualizados com sucesso!"
  3. Aguardar confirma√ß√£o do usu√°rio (OK)
  4. Prosseguir com fluxo (redirect, atualiza√ß√£o UI, etc.)
- **Sa√≠da:** Alert visual confirmando sucesso
- **Regras de Neg√≥cio:**
  - RN-NOTIF-01: Mensagem sempre exibida ap√≥s sucesso
  - RN-NOTIF-02: Mensagem em portugu√™s claro e objetivo
  - RN-NOTIF-03: Mencionar a√ß√£o espec√≠fica realizada
- **Crit√©rios de Aceite:**
  - ‚úì Alert exibido ap√≥s cada opera√ß√£o bem-sucedida
  - ‚úì Mensagem espec√≠fica ao contexto
  - ‚úì Texto claro e afirmativo
  - ‚úì Usu√°rio confirma com "OK" antes de prosseguir

---

#### RF-NOTIF-002: Mensagens de Erro

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve exibir mensagens de erro claras quando opera√ß√µes falharem.
- **Entrada:** Falha em opera√ß√£o (valida√ß√£o, busca, processamento)
- **Processamento:**
  1. Exibir alert() nativo com mensagem espec√≠fica de erro
  2. Mensagens espec√≠ficas por tipo de erro:
     - Valida√ß√£o: "Preencha todos os campos obrigat√≥rios."
     - N√£o encontrado: "Correi√ß√£o n√£o encontrada."
     - Permiss√£o: "Voc√™ n√£o tem permiss√£o para acessar esta funcionalidade."
     - Exporta√ß√£o: "Nenhum dado dispon√≠vel para exporta√ß√£o."
     - Sele√ß√£o: "Selecione ao menos uma proposi√ß√£o."
  3. Manter usu√°rio na mesma p√°gina (n√£o redirecionar)
  4. Focar no campo problem√°tico (se aplic√°vel)
- **Sa√≠da:** Alert visual indicando erro
- **Regras de Neg√≥cio:**
  - RN-NOTIF-04: Mensagem clara sobre o que deu errado
  - RN-NOTIF-05: Sugerir a√ß√£o corretiva quando poss√≠vel
  - RN-NOTIF-06: N√£o redirecionar em caso de erro (manter contexto)
- **Crit√©rios de Aceite:**
  - ‚úì Alert exibido quando opera√ß√£o falhar
  - ‚úì Mensagem espec√≠fica ao erro
  - ‚úì Texto orienta o que fazer
  - ‚úì Usu√°rio permanece na p√°gina atual

---

#### RF-NOTIF-003: Alertas de Prazo

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Sistema deve exibir alerta visual quando prazo de comprova√ß√£o est√° pr√≥ximo ou vencido.
- **Entrada:** Visualiza√ß√£o de proposi√ß√£o com prazoComprovacao definido
- **Processamento:**
  1. Calcular diferen√ßa entre hoje e prazoComprovacao
  2. **Se prazo vencido (data passada):**
     - Exibir alerta vermelho: "‚ö†Ô∏è PRAZO VENCIDO"
     - Mostrar dias de atraso: "Vencido h√° X dia(s)"
     - CSS: background vermelho (#dc3545), texto branco
  3. **Se prazo pr√≥ximo (‚â§ 7 dias):**
     - Exibir alerta amarelo: "‚è∞ PRAZO PR√ìXIMO"
     - Mostrar dias restantes: "Faltam X dia(s)"
     - CSS: background amarelo (#ffc107), texto preto
  4. **Se prazo normal (> 7 dias):**
     - Exibir info azul: "Prazo: DD/MM/YYYY"
     - Mostrar dias restantes: "Faltam X dia(s)"
     - CSS: background azul (#0066cc), texto branco
  5. Exibir na p√°gina de comprova√ß√£o (comprovacao.html)
- **Sa√≠da:** Alerta visual color-coded
- **Regras de Neg√≥cio:**
  - RN-NOTIF-07: Alerta vermelho se vencido (prioridade m√°xima)
  - RN-NOTIF-08: Alerta amarelo se ‚â§ 7 dias (urgente)
  - RN-NOTIF-09: Info azul se > 7 dias (normal)
  - RN-NOTIF-10: C√°lculo di√°rio (considera data atual)
- **Crit√©rios de Aceite:**
  - ‚úì Alerta vermelho para prazo vencido
  - ‚úì Alerta amarelo para prazo ‚â§ 7 dias
  - ‚úì Info azul para prazo > 7 dias
  - ‚úì Contador de dias din√¢mico
  - ‚úì Visual destacado na p√°gina de comprova√ß√£o

---

#### RF-NOTIF-004: Contador de Proposi√ß√µes Vencidas (Dashboard)

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Dashboard deve exibir card destacado com total de proposi√ß√µes com prazo vencido.
- **Entrada:** Carga do dashboard
- **Processamento:**
  1. Filtrar proposi√ß√µes onde:
     - Status = 'aguardando_comprovacao' (ainda n√£o recebeu comprova√ß√£o)
     - `prazoComprovacao < hoje`
  2. Contar total de proposi√ß√µes vencidas
  3. Exibir card "‚ö†Ô∏è Prazo Vencido" com contador
  4. CSS: Fundo vermelho claro, √≠cone de alerta
  5. Click no card ‚Üí filtrar dashboard para mostrar apenas vencidas
- **Sa√≠da:** Card visual no dashboard
- **Regras de Neg√≥cio:**
  - RN-NOTIF-11: Apenas proposi√ß√µes aguardando_comprovacao contam
  - RN-NOTIF-12: Proposi√ß√µes em_analise N√ÉO contam como vencidas
  - RN-NOTIF-13: Recalcular a cada login/refresh
- **Crit√©rios de Aceite:**
  - ‚úì Card "Prazo Vencido" vis√≠vel no dashboard
  - ‚úì Contador din√¢mico e correto
  - ‚úì Visual destacado (vermelho/amarelo)
  - ‚úì √çcone de alerta (‚ö†Ô∏è)
  - ‚úì Click filtra apenas vencidas (futuro)

---

#### RF-NOTIF-005: Destaque Visual em Tabelas

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Tabelas devem destacar visualmente proposi√ß√µes com prazo vencido.
- **Entrada:** Renderiza√ß√£o de tabela de proposi√ß√µes
- **Processamento:**
  1. Para cada proposi√ß√£o na tabela:
     - Se `status[0] === 'aguardando_comprovacao'` E `prazoComprovacao < hoje`:
       - Aplicar CSS: background vermelho claro (#ffe5e5)
       - Adicionar √≠cone: ‚ö†Ô∏è na coluna status/prazo
       - Tooltip: "Prazo vencido h√° X dia(s)"
  2. Aplicar em:
     - Tabela "Enviar Comprova√ß√£o" (index.html)
     - Tabela de Proposi√ß√µes (proposicoes.html)
     - Tabela de Publica√ß√£o (publicacao.html - se republica√ß√£o)
- **Sa√≠da:** Linha destacada visualmente
- **Regras de Neg√≥cio:**
  - RN-NOTIF-14: Destaque apenas para aguardando_comprovacao vencidas
  - RN-NOTIF-15: Background claro (n√£o interferir na legibilidade)
  - RN-NOTIF-16: Tooltip informativo ao hover
- **Crit√©rios de Aceite:**
  - ‚úì Linha com background vermelho claro se vencida
  - ‚úì √çcone ‚ö†Ô∏è vis√≠vel
  - ‚úì Tooltip mostra dias de atraso
  - ‚úì N√£o afeta proposi√ß√µes em outros status
  - ‚úì Legibilidade mantida

---

#### RF-NOTIF-006: Notifica√ß√µes por E-mail (Simuladas)

- **Prioridade:** [D] Desej√°vel
- **Descri√ß√£o:** Sistema deve simular envio de notifica√ß√µes por e-mail em eventos-chave.
- **Entrada:** Publica√ß√£o de proposi√ß√µes, envio de comprova√ß√£o
- **Processamento:**
  1. **Evento: Publica√ß√£o**
     - Destinat√°rio: ramoMP correicionado
     - Assunto: "[CNMP] Proposi√ß√£o Publicada - [numero]"
     - Corpo: Detalhes da proposi√ß√£o + prazo de comprova√ß√£o + link de acesso
     - **Simula√ß√£o:** Exibir mensagem de sucesso mencionando e-mail
  2. **Evento: Comprova√ß√£o Enviada**
     - Destinat√°rio: Corregedoria Nacional
     - Assunto: "[CNMP] Nova Comprova√ß√£o Recebida - [numero]"
     - Corpo: Detalhes da comprova√ß√£o + link para avalia√ß√£o
     - **Simula√ß√£o:** Exibir mensagem de sucesso mencionando e-mail
  3. **Evento: Avalia√ß√£o Registrada**
     - Destinat√°rio: ramoMP correicionado
     - Assunto: "[CNMP] Avalia√ß√£o Conclu√≠da - [numero]"
     - Corpo: Decis√£o (finalizada/parcial/em_andamento/prejudicada) + parecer + pr√≥ximos passos
     - **Simula√ß√£o:** Exibir mensagem de sucesso mencionando e-mail
- **Sa√≠da:** Mensagem simulada (prot√≥tipo - integra√ß√£o futura)
- **Regras de Neg√≥cio:**
  - RN-NOTIF-17: Prot√≥tipo apenas simula (n√£o envia e-mail real)
  - RN-NOTIF-18: Mensagem de sucesso menciona "notifica√ß√£o enviada por e-mail"
  - RN-NOTIF-19: Implementa√ß√£o real requer integra√ß√£o SMTP (fase futura)
- **Crit√©rios de Aceite:**
  - ‚úì Publica√ß√£o: mensagem menciona "Notifica√ß√µes enviadas por e-mail"
  - ‚úì Comprova√ß√£o: mensagem menciona notifica√ß√£o √† Corregedoria
  - ‚úì Avalia√ß√£o: mensagem menciona notifica√ß√£o ao correicionado
  - ‚úì N√£o dispara e-mail real (prot√≥tipo)
  - ‚úì Template de e-mail documentado para fase futura

---

#### RF-NOTIF-007: Confirma√ß√£o de A√ß√µes Destrutivas

- **Prioridade:** [E] Essencial
- **Descri√ß√£o:** Sistema deve solicitar confirma√ß√£o antes de a√ß√µes irrevers√≠veis ou importantes.
- **Entrada:** Tentativa de a√ß√£o cr√≠tica (publica√ß√£o, cancelamento, exclus√£o)
- **Processamento:**
  1. Detectar a√ß√£o cr√≠tica:
     - Publica√ß√£o em lote
     - Cancelamento com perda de dados (formul√°rio alterado)
     - Exclus√£o de registro (futuro)
  2. Exibir confirm() nativo com mensagem clara:
     - Publica√ß√£o: "Deseja publicar X proposi√ß√£o(√µes) com prazo at√© DD/MM/YYYY? Esta a√ß√£o n√£o pode ser desfeita."
     - Cancelamento: "Deseja sair sem salvar? Os dados preenchidos ser√£o perdidos."
     - Exclus√£o: "Deseja realmente excluir [item]? Esta a√ß√£o n√£o pode ser desfeita."
  3. **Se usu√°rio confirmar (OK):** Prosseguir com a√ß√£o
  4. **Se usu√°rio cancelar:** Abortar e manter na p√°gina
- **Sa√≠da:** Confirma√ß√£o via confirm()
- **Regras de Neg√≥cio:**
  - RN-NOTIF-20: Confirma√ß√£o obrigat√≥ria para a√ß√µes irrevers√≠veis
  - RN-NOTIF-21: Mensagem clara sobre consequ√™ncias
  - RN-NOTIF-22: Cancelar mant√©m usu√°rio no contexto atual
- **Crit√©rios de Aceite:**
  - ‚úì Confirm exibido antes de publicar proposi√ß√µes
  - ‚úì Confirm exibido ao cancelar formul√°rio alterado
  - ‚úì Mensagem clara sobre a√ß√£o e consequ√™ncias
  - ‚úì "OK" executa a√ß√£o, "Cancelar" aborta
  - ‚úì Usu√°rio informado sobre irreversibilidade

---

#### RF-NOTIF-008: Indicador de Formul√°rio N√£o Salvo

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Sistema deve detectar formul√°rios alterados e alertar antes de sair.
- **Entrada:** Usu√°rio tenta sair de p√°gina com formul√°rio modificado
- **Processamento:**
  1. Rastrear estado "dirty" do formul√°rio:
     - Ao carregar: marcar como "clean"
     - Ao alterar qualquer campo: marcar como "dirty"
     - Ao salvar com sucesso: marcar como "clean"
  2. Ao tentar sair (breadcrumb, bot√£o Cancelar):
     - **Se dirty:** Exibir confirma√ß√£o (ver RF-NOTIF-007)
     - **Se clean:** Sair diretamente
  3. Aplicar em:
     - P√°gina de Comprova√ß√£o (comprovacao.html)
     - P√°gina de Avalia√ß√£o (avaliacao.html)
     - P√°gina de Publica√ß√£o (publicacao.html)
     - Modais de edi√ß√£o
- **Sa√≠da:** Prote√ß√£o contra perda de dados n√£o salvos
- **Regras de Neg√≥cio:**
  - RN-NOTIF-23: Detectar mudan√ßas em campos de texto, checkboxes, selects
  - RN-NOTIF-24: Salvar com sucesso limpa estado "dirty"
  - RN-NOTIF-25: Confirma√ß√£o apenas se houver mudan√ßas
- **Crit√©rios de Aceite:**
  - ‚úì Formul√°rio novo (vazio): sai sem confirma√ß√£o
  - ‚úì Formul√°rio alterado: exibe confirma√ß√£o ao sair
  - ‚úì Salvar com sucesso: permite sair sem confirma√ß√£o
  - ‚úì Confirma√ß√£o menciona perda de dados
  - ‚úì Cancelar mant√©m usu√°rio na p√°gina

---

#### RF-NOTIF-009: Feedback Visual em Contadores de Caracteres

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Contadores de caracteres devem mudar de cor conforme limite se aproxima.
- **Entrada:** Digita√ß√£o em campo com contador (descri√ß√£o, observa√ß√µes, parecer)
- **Processamento:**
  1. Contar caracteres em tempo real
  2. Calcular porcentagem usado:
     - Verde: 0-70% do limite
     - Amarelo: 70-90% do limite
     - Vermelho: 90-100% do limite
  3. Atualizar cor do contador:
     - Verde (#28a745): uso normal
     - Amarelo (#ffc107): alerta de limite pr√≥ximo
     - Vermelho (#dc3545): limite cr√≠tico/excedido
  4. Formato: "X / Y caracteres"
  5. Aplicar em:
     - Descri√ß√£o de proposi√ß√£o (5.000 chars)
     - Descri√ß√£o de comprova√ß√£o (7.500 chars)
     - Observa√ß√µes de comprova√ß√£o (1.000 chars)
     - Observa√ß√µes de publica√ß√£o (1.000 chars)
     - Parecer de avalia√ß√£o (7.500 chars)
- **Sa√≠da:** Contador visual color-coded
- **Regras de Neg√≥cio:**
  - RN-NOTIF-26: Atualiza√ß√£o em tempo real (< 300ms)
  - RN-NOTIF-27: Verde = seguro, Amarelo = aten√ß√£o, Vermelho = limite
  - RN-NOTIF-28: Impedir submiss√£o se exceder limite
- **Crit√©rios de Aceite:**
  - ‚úì Contador verde quando uso < 70%
  - ‚úì Contador amarelo quando 70% ‚â§ uso < 90%
  - ‚úì Contador vermelho quando uso ‚â• 90%
  - ‚úì Atualiza a cada tecla digitada
  - ‚úì Formato claro "X / Y caracteres"
  - ‚úì Impede submiss√£o se exceder 100%

---

#### RF-NOTIF-010: Notifica√ß√£o de A√ß√µes em Lote

- **Prioridade:** [I] Importante
- **Descri√ß√£o:** Sistema deve fornecer feedback claro ap√≥s a√ß√µes em lote (batch operations).
- **Entrada:** Conclus√£o de publica√ß√£o em lote
- **Processamento:**
  1. Ao concluir publica√ß√£o de m√∫ltiplas proposi√ß√µes:
     - Contar total publicado
     - Exibir mensagem: "X proposi√ß√£o(√µes) publicada(s) com sucesso!"
     - Mencionar notifica√ß√µes: "Notifica√ß√µes enviadas por e-mail aos √≥rg√£os correicionados."
  2. Incluir detalhes se √∫til:
     - "Prazo de comprova√ß√£o: DD/MM/YYYY"
     - "Correi√ß√£o: [numero] - [tematica]"
  3. Aguardar confirma√ß√£o (OK)
  4. Limpar sele√ß√£o e atualizar UI
- **Sa√≠da:** Alert detalhado de sucesso
- **Regras de Neg√≥cio:**
  - RN-NOTIF-29: Mencionar quantidade de itens processados
  - RN-NOTIF-30: Confirmar envio de notifica√ß√µes
  - RN-NOTIF-31: Exibir informa√ß√µes-chave (prazo, correi√ß√£o)
- **Crit√©rios de Aceite:**
  - ‚úì Mensagem menciona quantidade publicada (singular/plural correto)
  - ‚úì Menciona envio de notifica√ß√µes por e-mail
  - ‚úì Exibe prazo de comprova√ß√£o aplicado
  - ‚úì Mensagem clara e informativa
  - ‚úì Usu√°rio confirma com "OK" antes de prosseguir

---

## 3. Casos de Uso Detalhados

Esta se√ß√£o apresenta os casos de uso do sistema em formato narrativo, descrevendo os principais fluxos de intera√ß√£o entre usu√°rios e sistema.

### 3.1 Conven√ß√µes

Cada caso de uso segue a estrutura:

- **UC-ID:** Identificador √∫nico do caso de uso
- **Nome:** Nome descritivo do caso de uso
- **Ator(es):** Usu√°rio(s) que executam o caso de uso
- **Pr√©-condi√ß√µes:** Condi√ß√µes que devem ser verdadeiras antes da execu√ß√£o
- **Fluxo Principal:** Sequ√™ncia de passos do cen√°rio de sucesso
- **Fluxos Alternativos:** Varia√ß√µes do fluxo principal
- **Fluxos de Exce√ß√£o:** Cen√°rios de erro ou valida√ß√£o
- **P√≥s-condi√ß√µes:** Estado do sistema ap√≥s execu√ß√£o bem-sucedida
- **Requisitos Relacionados:** Refer√™ncias aos requisitos funcionais

---

### UC-001: Realizar Login no Sistema

**Ator(es):** Admin (Corregedoria Nacional), User (MP Correicionado)

**Pr√©-condi√ß√µes:**
- Sistema dispon√≠vel e acess√≠vel via navegador web
- Usu√°rio possui credenciais v√°lidas

**Fluxo Principal:**
1. Usu√°rio acessa a URL do sistema
2. Sistema exibe p√°gina de login com campos "Ramo do MP" e "Senha"
3. Usu√°rio seleciona seu ramoMP no dropdown (27 op√ß√µes dispon√≠veis)
4. Usu√°rio digita senha no campo correspondente
5. Usu√°rio clica no bot√£o "Entrar"
6. Sistema valida credenciais (prot√≥tipo: aceita qualquer senha)
7. Sistema identifica tipo de usu√°rio:
   - Se ramoMP = "Corregedoria Nacional" ‚Üí tipo = "admin"
   - Caso contr√°rio ‚Üí tipo = "user"
8. Sistema armazena sess√£o no sessionStorage
9. Sistema oculta elementos de menu conforme permiss√µes:
   - User: oculta "Avaliar Comprova√ß√µes", "Nova Correi√ß√£o", "Nova Proposi√ß√£o", "Publicar Proposi√ß√µes"
   - Admin: exibe todos os menus
10. Sistema redireciona para Dashboard
11. Sistema exibe menu do usu√°rio no canto superior direito: "[ramoMP] ‚ñº"

**Fluxos Alternativos:**

**FA-01: Login como Admin**
- 3a. Usu√°rio seleciona "Corregedoria Nacional"
- 7a. Sistema define tipo = "admin" e concede acesso total
- Continua no passo 8

**FA-02: Login como User**
- 3a. Usu√°rio seleciona qualquer MP que n√£o seja "Corregedoria Nacional"
- 7a. Sistema define tipo = "user" e restringe menus
- Continua no passo 8

**Fluxos de Exce√ß√£o:**

**FE-01: Campos vazios**
- 5a. Usu√°rio clica "Entrar" sem preencher campos
- Sistema exibe valida√ß√£o HTML5: "Preencha este campo"
- Retorna ao passo 3

**P√≥s-condi√ß√µes:**
- Usu√°rio autenticado no sistema
- Sess√£o ativa armazenada no sessionStorage
- Dashboard exibido com dados filtrados conforme permiss√µes
- Menu adaptado ao tipo de usu√°rio

**Requisitos Relacionados:** RF-AUTH-001, RF-AUTH-002, RF-AUTH-003, RF-AUTH-006

---

### UC-002: Visualizar Dashboard Executivo

**Ator(es):** Admin, User

**Pr√©-condi√ß√µes:**
- Usu√°rio autenticado no sistema

**Fluxo Principal:**
1. Sistema carrega Dashboard automaticamente ap√≥s login (ou usu√°rio clica "üè† Dashboard")
2. Sistema popula dropdown "Filtrar por Correi√ß√£o":
   - Admin: v√™ todas as correi√ß√µes
   - User: v√™ apenas correi√ß√µes de seu ramoMP
   - Op√ß√£o padr√£o: "Todas as Correi√ß√µes"
3. Sistema calcula e exibe 5 cards de estat√≠sticas:
   - **Correi√ß√µes Realizadas:** Total cadastradas
   - **Correi√ß√µes Ativas:** Com proposi√ß√µes n√£o finalizadas
   - **Total de Proposi√ß√µes:** Todas registradas
   - **Proposi√ß√µes Ativas:** N√£o encerradas
   - **Prazo Vencido:** Aguardando comprova√ß√£o com prazo expirado
4. Sistema renderiza dois gr√°ficos lado a lado:
   - **Gr√°fico 1 - Fluxo de Trabalho:** 4 barras (Pendente, Aguardando, Em An√°lise, Encerrada)
   - **Gr√°fico 2 - Valora√ß√£o:** 5 barras (Nova, Finalizada, Parcial, Em Andamento, Prejudicada)
5. Cada barra colorida conforme status, com altura proporcional ao valor
6. Sistema exibe bot√£o "üì• Exportar" no header com menu dropdown
7. Dashboard responsivo: mobile mostra gr√°ficos empilhados verticalmente

**Fluxos Alternativos:**

**FA-01: Filtrar Dashboard por Correi√ß√£o**
- 2a. Usu√°rio seleciona correi√ß√£o espec√≠fica no dropdown
- Sistema recalcula todas as estat√≠sticas apenas para correi√ß√£o selecionada
- Sistema redesenha ambos os gr√°ficos com novos valores
- Continua exibindo dashboard filtrado

**FA-02: Exportar Dashboard**
- 6a. Usu√°rio clica "üì• Exportar"
- Sistema exibe menu com 2 op√ß√µes: "üìÑ Exportar PDF" e "üíæ Exportar JSON"
- Ver UC-012 para fluxo de exporta√ß√£o

**FA-03: Navegar para Outra P√°gina**
- 7a. Usu√°rio clica em item do menu lateral
- Sistema navega para p√°gina correspondente
- Dashboard permanece dispon√≠vel no menu para retorno

**Fluxos de Exce√ß√£o:**

**FE-01: Nenhum Dado Dispon√≠vel**
- 3a. Sistema n√£o encontra dados (correicoes e proposicoes vazios)
- Cards exibem valores "0" em todos os contadores
- Gr√°ficos exibem barras vazias ou mensagem "Sem dados"

**P√≥s-condi√ß√µes:**
- Dashboard exibido com estat√≠sticas atualizadas
- Filtro aplicado (se selecionado) mantido na sess√£o
- Gr√°ficos renderizados e responsivos

**Requisitos Relacionados:** RF-DASH-001 a RF-DASH-007, RF-BUSCA-007

---

### UC-003: Cadastrar Nova Correi√ß√£o (Admin)

**Ator(es):** Admin

**Pr√©-condi√ß√µes:**
- Usu√°rio autenticado como Admin
- Menu "üìã Nova Correi√ß√£o" vis√≠vel e acess√≠vel

**Fluxo Principal:**
1. Admin clica em "üìã Nova Correi√ß√£o" no menu lateral
2. Sistema exibe p√°gina com formul√°rio de cadastro
3. Admin preenche campos obrigat√≥rios:
   - **N√∫mero:** Identificador √∫nico (ex: "COR-2025-01")
   - **Ramo do MP:** Dropdown com 27 MPs
   - **Data de In√≠cio:** Date picker
   - **Data de Fim:** Date picker
4. Admin preenche campos opcionais:
   - **Tem√°tica:** Descri√ß√£o textual do tema (at√© 500 caracteres)
   - **N√∫mero ELO:** Identificador no formato NNNNNNN-DD.AAAA.J.TT.OOOO
   - **Tipo:** Dropdown (Ordin√°ria, Extraordin√°ria, OCD, Inspe√ß√£o)
   - **MP:** Radio button (MPE ou MPU)
   - **UF:** Select (comportamento muda conforme MP selecionado)
   - **Observa√ß√µes:** Textarea (at√© 1.000 caracteres)
5. Sistema ajusta campo UF dinamicamente:
   - Se MP = "MPE": permite selecionar apenas 1 UF
   - Se MP = "MPU": permite selecionar m√∫ltiplas UFs (Ctrl+Click)
6. Admin clica no bot√£o "Cadastrar Correi√ß√£o"
7. Sistema valida campos obrigat√≥rios (n√∫mero, ramoMP, dataInicio, dataFim)
8. Sistema gera ID √∫nico sequencial
9. Sistema define status inicial como "ativo" (sem proposi√ß√µes ainda)
10. Sistema adiciona correi√ß√£o ao array `correicoes[]`
11. Sistema salva no localStorage
12. Sistema exibe alert: "Correi√ß√£o cadastrada com sucesso!"
13. Sistema limpa formul√°rio
14. Sistema atualiza:
    - Dashboard (incrementa "Correi√ß√µes Realizadas")
    - Tabela de Correi√ß√µes
    - Dropdowns de filtro em outras p√°ginas

**Fluxos Alternativos:**

**FA-01: Correi√ß√£o MPE com UF √önica**
- 5a. Admin seleciona MP = "MPE"
- Sistema configura select UF: size=1, sem atributo multiple
- Admin seleciona uma √∫nica UF (ex: BA)
- Continua no passo 6

**FA-02: Correi√ß√£o MPU com M√∫ltiplas UFs**
- 5a. Admin seleciona MP = "MPU"
- Sistema configura select UF: size=5, com atributo multiple
- Admin seleciona m√∫ltiplas UFs com Ctrl+Click (ex: DF, SP, RJ)
- Continua no passo 6

**FA-03: Preenchimento Parcial de Campos Opcionais**
- 4a. Admin preenche apenas alguns campos opcionais
- Sistema aceita cadastro com campos opcionais vazios (null)
- Continua no passo 6

**Fluxos de Exce√ß√£o:**

**FE-01: Campos Obrigat√≥rios Vazios**
- 7a. Sistema detecta campos obrigat√≥rios n√£o preenchidos
- Sistema exibe valida√ß√£o HTML5 no primeiro campo vazio
- Foca no campo com erro
- Admin corrige e retorna ao passo 6

**FE-02: Data de Fim Anterior √† Data de In√≠cio**
- 7a. Sistema detecta dataFim < dataInicio
- Sistema exibe alert: "Data de fim deve ser posterior √† data de in√≠cio."
- Admin corrige datas
- Retorna ao passo 6

**FE-03: N√∫mero Duplicado**
- 7a. Sistema detecta correi√ß√£o com mesmo n√∫mero j√° cadastrada
- Sistema exibe alert: "J√° existe uma correi√ß√£o com este n√∫mero."
- Admin altera n√∫mero para valor √∫nico
- Retorna ao passo 6

**P√≥s-condi√ß√µes:**
- Nova correi√ß√£o criada no sistema
- Correi√ß√£o dispon√≠vel em todos os dropdowns de sele√ß√£o
- Dashboard atualizado com novo total
- Status da correi√ß√£o = "ativo" (sem proposi√ß√µes)
- Formul√°rio limpo e pronto para novo cadastro

**Requisitos Relacionados:** RF-COR-001, RF-COR-006, RF-COR-007, RF-NOTIF-001

---

### UC-004: Cadastrar Nova Proposi√ß√£o (Admin)

**Ator(es):** Admin

**Pr√©-condi√ß√µes:**
- Usu√°rio autenticado como Admin
- Ao menos uma correi√ß√£o cadastrada no sistema
- Menu "üìù Nova Proposi√ß√£o" vis√≠vel e acess√≠vel

**Fluxo Principal:**
1. Admin clica em "üìù Nova Proposi√ß√£o" no menu lateral
2. Sistema exibe p√°gina com formul√°rio de cadastro
3. Admin preenche campos obrigat√≥rios:
   - **N√∫mero:** Identificador √∫nico (ex: "PROP-2025-0001")
   - **Correi√ß√£o:** Dropdown com correi√ß√µes dispon√≠veis (numero + ramoMP)
   - **Tipo:** Radio button (Determina√ß√£o ou Recomenda√ß√£o)
   - **Unidade:** Texto livre (ex: "Promotoria de Justi√ßa de Cachoeira")
   - **Membro:** Texto livre (ex: "Dr. Jo√£o Silva Santos")
   - **Descri√ß√£o:** Textarea (at√© 5.000 caracteres)
4. Sistema exibe contador de caracteres em tempo real:
   - Verde (0-70%), Amarelo (70-90%), Vermelho (90-100%)
5. Admin preenche campos opcionais:
   - **Prioridade:** Dropdown (urgente, alta, normal) - default: "normal"
   - **Tags:** Checkboxes com 11 categorias (m√∫ltipla sele√ß√£o)
6. Admin clica no bot√£o "Cadastrar Proposi√ß√£o"
7. Sistema valida todos os campos obrigat√≥rios
8. Sistema valida descri√ß√£o (m√°ximo 5.000 caracteres)
9. Sistema gera ID √∫nico sequencial
10. Sistema define status inicial: `['pendente', 'nova']`
11. Sistema inicializa arrays vazios: `historico = []`, `rascunhos = []`, `tags = [ids selecionados]`
12. Sistema adiciona proposi√ß√£o ao array `proposicoes[]`
13. Sistema recalcula status da correi√ß√£o vinculada (permanece "ativo")
14. Sistema salva no localStorage
15. Sistema exibe alert: "Proposi√ß√£o cadastrada com sucesso!"
16. Sistema limpa formul√°rio
17. Sistema atualiza:
    - Dashboard (incrementa "Total de Proposi√ß√µes" e "Proposi√ß√µes Ativas")
    - Tabela de Proposi√ß√µes
    - P√°gina de Publica√ß√£o (nova proposi√ß√£o pendente aparece)

**Fluxos Alternativos:**

**FA-01: Proposi√ß√£o Tipo Determina√ß√£o**
- 3a. Admin seleciona tipo = "Determina√ß√£o"
- Sistema marca como proposi√ß√£o mandat√≥ria
- Continua no passo 4

**FA-02: Proposi√ß√£o Tipo Recomenda√ß√£o**
- 3a. Admin seleciona tipo = "Recomenda√ß√£o"
- Sistema marca como proposi√ß√£o consultiva
- Continua no passo 4

**FA-03: Sele√ß√£o de M√∫ltiplas Tags**
- 5a. Admin marca m√∫ltiplas checkboxes de tags
- Sistema armazena array de IDs (ex: ["tecnologia", "compliance", "administrativo"])
- Continua no passo 6

**FA-04: Proposi√ß√£o sem Tags**
- 5a. Admin n√£o marca nenhuma tag
- Sistema define `tags = []` (array vazio)
- Continua no passo 6

**FA-05: Prioridade Urgente**
- 5a. Admin seleciona prioridade = "urgente"
- Sistema marca proposi√ß√£o para aten√ß√£o priorit√°ria
- Exibi√ß√£o futura destacar√° em vermelho
- Continua no passo 6

**Fluxos de Exce√ß√£o:**

**FE-01: Campos Obrigat√≥rios Vazios**
- 7a. Sistema detecta campos obrigat√≥rios n√£o preenchidos
- Sistema exibe valida√ß√£o HTML5: "Preencha este campo"
- Foca no primeiro campo com erro
- Admin corrige e retorna ao passo 6

**FE-02: Descri√ß√£o Excede Limite**
- 8a. Sistema detecta descri√ß√£o > 5.000 caracteres
- Contador exibe valor em vermelho
- Sistema impede submiss√£o (bot√£o desabilitado ou valida√ß√£o)
- Sistema exibe alert: "Descri√ß√£o excede o limite de 5.000 caracteres."
- Admin reduz texto
- Retorna ao passo 6

**FE-03: N√∫mero Duplicado**
- 9a. Sistema detecta proposi√ß√£o com mesmo n√∫mero j√° cadastrada
- Sistema exibe alert: "J√° existe uma proposi√ß√£o com este n√∫mero."
- Admin altera n√∫mero para valor √∫nico
- Retorna ao passo 6

**FE-04: Correi√ß√£o N√£o Selecionada**
- 7a. Sistema detecta campo Correi√ß√£o vazio
- Sistema exibe alert: "Selecione uma correi√ß√£o."
- Admin seleciona correi√ß√£o
- Retorna ao passo 6

**P√≥s-condi√ß√µes:**
- Nova proposi√ß√£o criada no sistema
- Proposi√ß√£o vinculada √† correi√ß√£o selecionada via `correicaoId`
- Status inicial: `['pendente', 'nova']`
- Historico vazio (aguarda primeira publica√ß√£o)
- Proposi√ß√£o dispon√≠vel na p√°gina de Publica√ß√£o
- Dashboard e tabelas atualizados
- Status da correi√ß√£o recalculado (permanece "ativo")

**Requisitos Relacionados:** RF-PROP-001, RF-PROP-008, RF-PROP-009, RF-NOTIF-001, RF-NOTIF-009

---

### UC-005: Publicar Proposi√ß√µes em Lote (Admin)

**Ator(es):** Admin

**Pr√©-condi√ß√µes:**
- Usu√°rio autenticado como Admin
- Ao menos uma proposi√ß√£o com status `['pendente', *]` cadastrada
- Menu "üì§ Publicar Proposi√ß√µes" vis√≠vel e acess√≠vel

**Fluxo Principal:**
1. Admin clica em "üì§ Publicar Proposi√ß√µes" no menu lateral
2. Sistema redireciona para `publicacao.html`
3. Sistema valida acesso admin (redireciona se user)
4. Sistema exibe placeholder: "Selecione uma Correi√ß√£o para visualizar as proposi√ß√µes pendentes"
5. Admin seleciona correi√ß√£o no dropdown
6. Sistema exibe:
   - Painel com info da correi√ß√£o (tem√°tica, √≥rg√£o correicionado, total de pendentes)
   - Se√ß√£o de filtros (busca, tipo, tags, prioridade)
   - Bot√£o "üîÑ Limpar Filtros"
7. Sistema renderiza tabela com 8 colunas:
   - ‚òë Checkbox | N√∫mero | Tipo | Unidade | Descri√ß√£o | Tags | Prioridade | A√ß√µes
8. Sistema lista APENAS proposi√ß√µes com status[0] = 'pendente' da correi√ß√£o selecionada
9. Admin aplica filtros opcionais (ex: tipo="Determina√ß√£o", prioridade="urgente")
10. Sistema atualiza tabela e contador: "X proposi√ß√£o(√µes) pendente(s)"
11. Admin seleciona proposi√ß√µes para publicar:
    - Marca checkboxes individuais OU
    - Clica "‚òëÔ∏è Selecionar Todas" OU
    - Marca master checkbox no header da tabela
12. Sistema destaca linhas selecionadas (background azul claro + borda esquerda)
13. Sistema atualiza contador: "X selecionada(s)"
14. Sistema exibe formul√°rio de publica√ß√£o (auto-scroll):
    - Campo "Prazo de Comprova√ß√£o" (date picker, obrigat√≥rio)
    - Campo "Observa√ß√µes" (textarea, at√© 1.000 chars, opcional)
    - Bot√£o "Publicar X Proposi√ß√£o(√µes)"
    - Bot√£o "Cancelar"
15. Admin define prazo de comprova√ß√£o (ex: 30 dias a partir de hoje)
16. Admin adiciona observa√ß√µes (opcional)
17. Admin clica "Publicar X Proposi√ß√£o(√µes)"
18. Sistema exibe confirm: "Deseja publicar X proposi√ß√£o(√µes) com prazo at√© DD/MM/YYYY? Esta a√ß√£o n√£o pode ser desfeita."
19. Admin confirma (OK)
20. Sistema processa CADA proposi√ß√£o selecionada:
    - Atualiza status: ['aguardando_comprovacao', valoracao_atual]
    - Define `prazoComprovacao` = data do formul√°rio
    - Define `dataPublicacao` = hoje (ISO)
    - Adiciona entrada ao historico[]:
      ```json
      {
        tipo: 'publicacao',
        data: hoje (ISO),
        usuario: 'Corregedoria Nacional',
        descricao: 'Proposi√ß√£o publicada para [ramoMP] - [ramoMPNome]',
        observacoes: texto_do_campo | null,
        prazoComprovacao: prazo_selecionado,
        statusAnterior: ['pendente', valoracao],
        statusNovo: ['aguardando_comprovacao', valoracao]
      }
      ```
21. Sistema salva todas as altera√ß√µes no localStorage
22. Sistema exibe alert: "X proposi√ß√£o(√µes) publicada(s) com sucesso! Notifica√ß√µes enviadas por e-mail."
23. Sistema limpa sele√ß√£o (checkboxes desmarcados)
24. Sistema oculta formul√°rio de publica√ß√£o
25. Sistema atualiza tabela (proposi√ß√µes publicadas removidas da lista de pendentes)
26. Sistema atualiza contador: "Y proposi√ß√£o(√µes) pendente(s)" (Y = total - X)

**Fluxos Alternativos:**

**FA-01: Sele√ß√£o Individual**
- 11a. Admin marca checkboxes uma a uma
- Sistema destaca cada linha selecionada
- Sistema incrementa contador a cada sele√ß√£o
- Continua no passo 14

**FA-02: Selecionar Todas (Bot√£o)**
- 11a. Admin clica "‚òëÔ∏è Selecionar Todas"
- Sistema marca todas as proposi√ß√µes FILTRADAS
- Sistema destaca todas as linhas
- Sistema atualiza contador com total
- Continua no passo 14

**FA-03: Master Checkbox**
- 11a. Admin clica checkbox no header da tabela
- Sistema marca/desmarca todas as proposi√ß√µes vis√≠veis
- Sistema destaca/remove destaque de todas as linhas
- Sistema atualiza contador
- Continua no passo 14

**FA-04: Desmarcar Todas**
- 12a. Admin clica "‚òê Desmarcar Todas"
- Sistema desmarca todos os checkboxes
- Sistema remove destaque de todas as linhas
- Sistema atualiza contador: "0 selecionada(s)"
- Sistema oculta formul√°rio de publica√ß√£o
- Retorna ao passo 11

**FA-05: Cancelar Publica√ß√£o**
- 17a. Admin clica "Cancelar"
- Sistema exibe confirm: "Deseja cancelar? A sele√ß√£o ser√° perdida."
- 17b. Admin confirma
- Sistema desmarca todos os checkboxes
- Sistema oculta formul√°rio
- Retorna ao passo 11

**FA-06: Publica√ß√£o sem Observa√ß√µes**
- 16a. Admin deixa campo Observa√ß√µes vazio
- Sistema define observacoes = null no hist√≥rico
- Continua no passo 17

**FA-07: Aplicar Filtros Antes de Selecionar**
- 9a. Admin filtra por "prioridade=urgente"
- Sistema exibe apenas proposi√ß√µes urgentes
- Admin seleciona todas (aplica apenas √†s filtradas)
- Continua no passo 14

**FA-08: Limpar Filtros**
- 9a. Admin clica "üîÑ Limpar Filtros"
- Sistema reseta busca e todos os dropdowns
- Sistema mant√©m correi√ß√£o selecionada
- Sistema re-renderiza tabela com todas as pendentes
- Retorna ao passo 9

**FA-09: Exportar Pendentes**
- 10a. Admin clica "üì• Exportar" ‚Üí "üíæ Exportar Pendentes (JSON)"
- Ver UC-012 para fluxo de exporta√ß√£o
- Retorna ao passo 10

**FA-10: Gerar Of√≠cio de Publica√ß√£o**
- 17a. Admin clica "üì• Exportar" ‚Üí "üìú Gerar Of√≠cio de Publica√ß√£o (PDF)"
- Sistema valida: ao menos uma proposi√ß√£o selecionada
- Sistema gera documento legal formal em Times New Roman
- Ver UC-012 para detalhes do of√≠cio
- Retorna ao passo 17

**Fluxos de Exce√ß√£o:**

**FE-01: Nenhuma Correi√ß√£o Selecionada**
- 6a. Sistema detecta correi√ß√£o n√£o selecionada
- Sistema mant√©m placeholder e oculta tabela/filtros
- Admin n√£o consegue prosseguir
- Retorna ao passo 5

**FE-02: Nenhuma Proposi√ß√£o Pendente**
- 8a. Sistema n√£o encontra proposi√ß√µes com status='pendente' para correi√ß√£o selecionada
- Sistema exibe mensagem: "Nenhuma proposi√ß√£o pendente para esta correi√ß√£o."
- Tabela vazia
- Admin seleciona outra correi√ß√£o ou sai da p√°gina
- Retorna ao passo 5

**FE-03: Tentar Publicar sem Selecionar Proposi√ß√µes**
- 17a. Admin tenta clicar "Publicar" sem marcar checkboxes (formul√°rio n√£o aparece)
- Sistema n√£o exibe formul√°rio
- Retorna ao passo 11

**FE-04: Prazo de Comprova√ß√£o N√£o Preenchido**
- 17a. Admin clica "Publicar" sem definir prazo
- Sistema exibe valida√ß√£o HTML5: "Preencha este campo"
- Admin define prazo
- Retorna ao passo 17

**FE-05: Observa√ß√µes Excedem Limite**
- 16a. Admin digita > 1.000 caracteres em observa√ß√µes
- Sistema exibe contador vermelho
- Sistema impede submiss√£o
- Admin reduz texto
- Retorna ao passo 16

**FE-06: Confirmar Publica√ß√£o - Cancelar**
- 19a. Admin cancela o confirm
- Sistema aborta publica√ß√£o
- Mant√©m sele√ß√£o e formul√°rio preenchido
- Retorna ao passo 17

**P√≥s-condi√ß√µes:**
- Proposi√ß√µes selecionadas publicadas com sucesso
- Status alterado para `['aguardando_comprovacao', valoracao]`
- Hist√≥rico de cada proposi√ß√£o cont√©m entrada de publica√ß√£o
- prazoComprovacao e dataPublicacao definidos
- Proposi√ß√µes dispon√≠veis para comprova√ß√£o pelo correicionado
- Tabela de pendentes atualizada (publicadas removidas)
- Sele√ß√£o e formul√°rio limpos
- Notifica√ß√£o por e-mail simulada (mensagem de sucesso)
- Dashboard atualizado (incrementa "Aguardando Comprova√ß√£o")

**Requisitos Relacionados:** RF-PUB-001 a RF-PUB-010, RF-HIST-002, RF-NOTIF-001, RF-NOTIF-006, RF-NOTIF-007, RF-NOTIF-010

---

### UC-006: Enviar Comprova√ß√£o de Cumprimento (User)

**Ator(es):** User (MP Correicionado)

**Pr√©-condi√ß√µes:**
- Usu√°rio autenticado como User
- Ao menos uma proposi√ß√£o com status `['aguardando_comprovacao', *]` publicada para seu ramoMP
- Menu "üìé Enviar Comprova√ß√£o" vis√≠vel e acess√≠vel

**Fluxo Principal:**
1. User clica em "üìé Enviar Comprova√ß√£o" no menu lateral
2. Sistema exibe p√°gina com tabela de proposi√ß√µes aguardando comprova√ß√£o
3. Sistema filtra e exibe APENAS proposi√ß√µes onde:
   - correicaoId vinculada ao ramoMP do user
   - status[0] = 'aguardando_comprovacao'
4. Tabela mostra: N√∫mero | Tipo | Descri√ß√£o | Prazo | Status | A√ß√µes
5. Sistema destaca visualmente proposi√ß√µes com prazo vencido (background vermelho claro + ‚ö†Ô∏è)
6. User identifica proposi√ß√£o a comprovar
7. User clica bot√£o "Adicionar" na linha da proposi√ß√£o
8. Sistema redireciona para `comprovacao.html?id={proposicaoId}`
9. Sistema carrega dados da proposi√ß√£o
10. Sistema verifica rascunho existente:
    - Se `proposicao.rascunhos.length > 0` ‚Üí auto-carrega rascunho (ver FA-01)
    - Caso contr√°rio ‚Üí formul√°rio vazio
11. Sistema exibe 3 se√ß√µes:
    - **Se√ß√£o 1:** Info da proposi√ß√£o (n√∫mero, tipo, unidade, descri√ß√£o)
    - **Se√ß√£o 2:** Alerta de prazo (color-coded: vermelho/amarelo/azul)
    - **Se√ß√£o 3:** Formul√°rio de comprova√ß√£o
12. Sistema exibe alerta de prazo:
    - Vencido: "‚ö†Ô∏è PRAZO VENCIDO - Vencido h√° X dia(s)" (vermelho)
    - Pr√≥ximo (‚â§7 dias): "‚è∞ PRAZO PR√ìXIMO - Faltam X dia(s)" (amarelo)
    - Normal (>7 dias): "Prazo: DD/MM/YYYY - Faltam X dia(s)" (azul)
13. User preenche formul√°rio:
    - **Descri√ß√£o do Adimplemento** (textarea, at√© 7.500 chars, obrigat√≥rio)
    - **Observa√ß√µes Adicionais** (textarea, at√© 1.000 chars, opcional)
    - **Arquivos** (drag-and-drop ou clique, m√∫ltiplos, at√© 10MB cada)
14. Sistema exibe contadores de caracteres em tempo real (verde/amarelo/vermelho)
15. User anexa arquivos (PDF, DOCX, XLSX, PNG, JPG):
    - Arrasta arquivos para √°rea de drop OU
    - Clica "Selecionar arquivos" e escolhe via file picker
16. Sistema valida cada arquivo:
    - Tamanho ‚â§ 10MB
    - Tipos permitidos
17. Sistema exibe lista de arquivos anexados com:
    - Nome do arquivo
    - Tamanho formatado (KB/MB)
    - Bot√£o "‚ùå Remover"
18. User decide entre duas a√ß√µes:
    - Op√ß√£o A: "üíæ Salvar como Rascunho" (ver FA-02)
    - Op√ß√£o B: "üì§ Enviar Comprova√ß√£o" (continua fluxo principal)
19. User clica "üì§ Enviar Comprova√ß√£o"
20. Sistema valida:
    - Descri√ß√£o preenchida (‚â• 50 caracteres)
    - Ao menos 1 arquivo anexado
21. Sistema cria entrada no historico[]:
    ```json
    {
      tipo: 'comprovacao',
      data: hoje (ISO),
      usuario: '[ramoMP] - [ramoMPNome]',
      descricao: texto_da_descricao,
      observacoes: texto_observacoes | null,
      arquivos: ['arquivo1.pdf', 'arquivo2.xlsx', ...]
    }
    ```
22. Sistema atualiza proposi√ß√£o:
    - status: ['em_analise', valoracao_atual]
    - Adiciona entrada ao historico[]
    - Limpa rascunhos: `rascunhos = []`
23. Sistema salva no localStorage
24. Sistema exibe alert: "Comprova√ß√£o enviada com sucesso!"
25. Sistema redireciona para `index.html#enviar`
26. Tabela "Enviar Comprova√ß√£o" atualizada (proposi√ß√£o removida)
27. Proposi√ß√£o aparece na fila de avalia√ß√£o do Admin

**Fluxos Alternativos:**

**FA-01: Auto-carregar Rascunho Existente**
- 10a. Sistema detecta rascunho em `proposicao.rascunhos[0]`
- Sistema exibe banner: "üìù Rascunho existente detectado. Carregando dados..."
- Sistema preenche formul√°rio com dados do rascunho:
  - Descri√ß√£o
  - Observa√ß√µes
  - Lista de arquivos (nomes apenas - arquivos reais n√£o persistem)
- User pode editar ou continuar do ponto salvo
- Continua no passo 13

**FA-02: Salvar como Rascunho**
- 18a. User clica "üíæ Salvar como Rascunho"
- Sistema valida campos m√≠nimos (descri√ß√£o com ao menos 10 caracteres)
- Sistema cria/atualiza rascunho em `proposicao.rascunhos[]`:
  ```json
  {
    descricao: texto_atual,
    observacoes: texto_observacoes | null,
    arquivos: ['arquivo1.pdf', ...],
    dataSalvamento: hoje (ISO)
  }
  ```
- Sistema mant√©m status atual: ['aguardando_comprovacao', valoracao]
- Sistema salva no localStorage
- Sistema exibe alert: "Rascunho salvo com sucesso!"
- Sistema redireciona para `index.html#enviar`
- Proposi√ß√£o permanece na tabela com indicador "üìù Rascunho"
- Bot√£o "Adicionar" muda para "Editar"

**FA-03: Editar Rascunho Existente**
- 7a. User clica bot√£o "Editar" (em vez de "Adicionar")
- Sistema redireciona para `comprovacao.html?id={proposicaoId}`
- Sistema auto-carrega rascunho (ver FA-01)
- User edita e salva novamente (substitui rascunho anterior) ou envia definitivamente
- Continua no passo 13

**FA-04: Remover Arquivo Anexado**
- 17a. User clica "‚ùå Remover" em um arquivo
- Sistema remove arquivo da lista
- Contador de arquivos atualiza
- User pode adicionar novos arquivos
- Continua no passo 18

**FA-05: Cancelar Comprova√ß√£o**
- 19a. User clica breadcrumb "‚Üê Voltar" ou fecha p√°gina
- Sistema detecta formul√°rio alterado (dirty state)
- Sistema exibe confirm: "Deseja sair sem salvar? Os dados preenchidos ser√£o perdidos."
- 19b. User confirma sa√≠da
- Sistema redireciona para `index.html#enviar` sem salvar
- Rascunho preservado (se existia antes)

**FA-06: Comprova√ß√£o sem Observa√ß√µes**
- 13a. User deixa campo "Observa√ß√µes Adicionais" vazio
- Sistema define observacoes = null no hist√≥rico
- Continua no passo 18

**Fluxos de Exce√ß√£o:**

**FE-01: Nenhuma Proposi√ß√£o Aguardando Comprova√ß√£o**
- 3a. Sistema n√£o encontra proposi√ß√µes para o ramoMP do user
- Sistema exibe mensagem: "Nenhuma proposi√ß√£o aguardando comprova√ß√£o no momento."
- Tabela vazia
- User n√£o pode prosseguir

**FE-02: Descri√ß√£o Vazia ou Muito Curta**
- 20a. Sistema detecta descri√ß√£o vazia ou < 50 caracteres
- Sistema exibe alert: "Descri√ß√£o deve ter no m√≠nimo 50 caracteres."
- Foca no campo descri√ß√£o
- User completa texto
- Retorna ao passo 19

**FE-03: Nenhum Arquivo Anexado**
- 20a. Sistema detecta lista de arquivos vazia
- Sistema exibe alert: "Anexe ao menos um arquivo como comprovante."
- User adiciona arquivos
- Retorna ao passo 15

**FE-04: Arquivo Excede Tamanho**
- 16a. Sistema detecta arquivo > 10MB
- Sistema exibe alert: "Arquivo '[nome]' excede o limite de 10MB."
- Sistema n√£o adiciona arquivo √† lista
- User seleciona arquivo menor
- Retorna ao passo 15

**FE-05: Tipo de Arquivo N√£o Permitido**
- 16a. Sistema detecta extens√£o n√£o permitida (ex: .exe)
- Sistema exibe alert: "Tipo de arquivo '[extens√£o]' n√£o permitido."
- Sistema n√£o adiciona arquivo √† lista
- User seleciona arquivo v√°lido
- Retorna ao passo 15

**FE-06: Descri√ß√£o Excede Limite**
- 20a. Sistema detecta descri√ß√£o > 7.500 caracteres
- Contador vermelho + valida√ß√£o
- Sistema exibe alert: "Descri√ß√£o excede o limite de 7.500 caracteres."
- User reduz texto
- Retorna ao passo 19

**FE-07: Observa√ß√µes Excedem Limite**
- 20a. Sistema detecta observa√ß√µes > 1.000 caracteres
- Contador vermelho + valida√ß√£o
- Sistema exibe alert: "Observa√ß√µes excedem o limite de 1.000 caracteres."
- User reduz texto
- Retorna ao passo 19

**P√≥s-condi√ß√µes:**
- Comprova√ß√£o enviada e registrada no hist√≥rico
- Status da proposi√ß√£o: ['em_analise', valoracao]
- Rascunho exclu√≠do (se existia)
- Proposi√ß√£o dispon√≠vel na fila de avalia√ß√£o do Admin
- User removido da lista "Enviar Comprova√ß√£o"
- Dashboard atualizado (decrementa "Aguardando Comprova√ß√£o", incrementa "Em An√°lise")
- Notifica√ß√£o por e-mail simulada ao Admin

**Requisitos Relacionados:** RF-COMP-001 a RF-COMP-010, RF-HIST-003, RF-NOTIF-001, RF-NOTIF-003, RF-NOTIF-006, RF-NOTIF-008, RF-NOTIF-009

---

### UC-007: Avaliar Comprova√ß√£o (Admin)

**Ator(es):** Admin

**Pr√©-condi√ß√µes:**
- Usu√°rio autenticado como Admin
- Ao menos uma proposi√ß√£o com status `['em_analise', *]` no sistema
- Menu "‚öñÔ∏è Avaliar Comprova√ß√µes" vis√≠vel e acess√≠vel

**Fluxo Principal:**
1. Admin clica em "‚öñÔ∏è Avaliar Comprova√ß√µes" no menu lateral
2. Sistema exibe p√°gina com tabela de proposi√ß√µes em an√°lise
3. Sistema lista TODAS as proposi√ß√µes com status[0] = 'em_analise'
4. Tabela mostra: N√∫mero | Tipo | √ìrg√£o | Data Envio | Prazo | A√ß√µes
5. Admin identifica proposi√ß√£o a avaliar
6. Admin clica bot√£o "Avaliar" na linha da proposi√ß√£o
7. Sistema redireciona para `avaliacao.html?id={proposicaoId}`
8. Sistema carrega dados da proposi√ß√£o completa
9. Sistema exibe 3 se√ß√µes:
   - **Se√ß√£o 1:** Info da proposi√ß√£o (metadados completos)
   - **Se√ß√£o 2:** Hist√≥rico completo (timeline com todas as intera√ß√µes)
   - **Se√ß√£o 3:** Comprova√ß√£o atual (√∫ltima comprova√ß√£o submetida)
10. Se√ß√£o "Comprova√ß√£o Atual" exibe:
    - Data de envio
    - √ìrg√£o correicionado
    - Descri√ß√£o do adimplemento (texto completo)
    - Observa√ß√µes (se houver)
    - **Lista de arquivos anexados** (com √≠cones e nomes)
11. Sistema exibe formul√°rio de avalia√ß√£o:
    - **Decis√£o:** 4 cards visuais clic√°veis (radio buttons estilizados)
      - ‚úÖ Finalizada (verde)
      - ‚ö†Ô∏è Parcial (amarelo)
      - ‚ùå Em Andamento (vermelho)
      - üö´ Prejudicada (cinza)
    - **Parecer:** Textarea (at√© 7.500 caracteres, obrigat√≥rio)
12. Sistema exibe contador de caracteres em tempo real (verde/amarelo/vermelho)
13. Admin analisa comprova√ß√£o:
    - L√™ descri√ß√£o do adimplemento
    - Verifica arquivos anexados (prot√≥tipo: apenas nomes)
    - Revisa hist√≥rico completo
14. Admin seleciona decis√£o clicando em um dos 4 cards
15. Sistema destaca card selecionado visualmente (borda grossa + background)
16. Admin redige parecer fundamentado (m√≠nimo 50 caracteres)
17. Admin clica "Enviar Avalia√ß√£o"
18. Sistema valida:
    - Decis√£o selecionada
    - Parecer preenchido (‚â• 50 caracteres, ‚â§ 7.500)
19. Sistema determina novo status baseado na decis√£o:
    - **Finalizada:** ['encerrada', 'finalizada'] ‚Üí Ciclo finalizado ‚úì
    - **Prejudicada:** ['encerrada', 'prejudicada'] ‚Üí Ciclo finalizado ‚úì
    - **Parcial:** ['pendente', 'parcial'] ‚Üí Aguarda republica√ß√£o
    - **Em Andamento:** ['pendente', 'em_andamento'] ‚Üí Aguarda republica√ß√£o
20. Sistema cria entrada no historico[]:
    ```json
    {
      tipo: 'avaliacao',
      data: hoje (ISO),
      usuario: 'Corregedoria Nacional',
      descricao: texto_do_parecer,
      observacoes: null,
      statusAnterior: ['em_analise', valoracao_anterior],
      statusNovo: [processual_novo, valoracao_decisao]
    }
    ```
21. Sistema atualiza proposi√ß√£o:
    - status: novo status conforme decis√£o
    - Adiciona entrada ao historico[]
22. Sistema recalcula status da correi√ß√£o vinculada:
    - Se todas proposi√ß√µes finalizadas/prejudicadas ‚Üí correi√ß√£o 'inativo'
    - Caso contr√°rio ‚Üí correi√ß√£o 'ativo'
23. Sistema salva no localStorage
24. Sistema exibe alert: "Avalia√ß√£o registrada com sucesso!"
25. Sistema redireciona para `index.html`
26. Tabela "Avaliar Comprova√ß√µes" atualizada:
    - Se Finalizada/Prejudicada ‚Üí proposi√ß√£o removida (encerrada)
    - Se Parcial/Em Andamento ‚Üí proposi√ß√£o removida (volta para pendente)
27. Dashboard atualizado conforme nova situa√ß√£o

**Fluxos Alternativos:**

**FA-01: Decis√£o Finalizada**
- 14a. Admin seleciona "‚úÖ Finalizada"
- Sistema define novo status: ['encerrada', 'finalizada']
- Parecer confirma cumprimento total
- Proposi√ß√£o finalizada (n√£o reabre)
- Continua no passo 16

**FA-02: Decis√£o Prejudicada**
- 14a. Admin seleciona "üö´ Prejudicada"
- Sistema define novo status: ['encerrada', 'prejudicada']
- Parecer explica motivo (superada, n√£o aplic√°vel, etc.)
- Proposi√ß√£o finalizada (n√£o reabre)
- Continua no passo 16

**FA-03: Decis√£o Parcial**
- 14a. Admin seleciona "‚ö†Ô∏è Parcial"
- Sistema define novo status: ['pendente', 'parcial']
- Parecer indica cumprimento parcial
- Proposi√ß√£o retorna para status 'pendente'
- Admin dever√° republicar com novo prazo
- Continua no passo 16

**FA-04: Decis√£o Em Andamento**
- 14a. Admin seleciona "‚ùå Em Andamento"
- Sistema define novo status: ['pendente', 'em_andamento']
- Parecer indica n√£o cumprimento
- Proposi√ß√£o retorna para status 'pendente'
- Admin dever√° republicar com novo prazo
- Continua no passo 16

**FA-05: Cancelar Avalia√ß√£o**
- 17a. Admin clica breadcrumb "‚Üê Voltar"
- Sistema detecta formul√°rio alterado
- Sistema exibe confirm: "Deseja sair sem salvar? A avalia√ß√£o ser√° perdida."
- 17b. Admin confirma
- Sistema redireciona para `index.html` sem salvar
- Proposi√ß√£o permanece com status 'em_analise'

**FA-06: Correi√ß√£o Torna-se Inativa**
- 22a. Sistema calcula que todas as proposi√ß√µes da correi√ß√£o est√£o finalizadas
- Sistema atualiza `correicao.status = 'inativo'`
- Dashboard reflete mudan√ßa (decrementa "Correi√ß√µes Ativas")
- Continua no passo 23

**Fluxos de Exce√ß√£o:**

**FE-01: Nenhuma Proposi√ß√£o em An√°lise**
- 3a. Sistema n√£o encontra proposi√ß√µes com status='em_analise'
- Sistema exibe mensagem: "Nenhuma comprova√ß√£o aguardando avalia√ß√£o."
- Tabela vazia
- Admin n√£o pode prosseguir

**FE-02: Decis√£o N√£o Selecionada**
- 18a. Sistema detecta nenhum card de decis√£o selecionado
- Sistema exibe alert: "Selecione uma decis√£o."
- Foca na se√ß√£o de decis√µes
- Admin seleciona decis√£o
- Retorna ao passo 17

**FE-03: Parecer Vazio ou Muito Curto**
- 18a. Sistema detecta parecer vazio ou < 50 caracteres
- Sistema exibe alert: "Parecer deve ter no m√≠nimo 50 caracteres."
- Foca no campo parecer
- Admin completa texto
- Retorna ao passo 17

**FE-04: Parecer Excede Limite**
- 18a. Sistema detecta parecer > 7.500 caracteres
- Contador vermelho + valida√ß√£o
- Sistema exibe alert: "Parecer excede o limite de 7.500 caracteres."
- Admin reduz texto
- Retorna ao passo 17

**FE-05: Proposi√ß√£o N√£o Encontrada**
- 8a. Sistema n√£o encontra proposi√ß√£o com ID fornecido
- Sistema exibe alert: "Proposi√ß√£o n√£o encontrada."
- Sistema redireciona para `index.html`
- Admin deve verificar dados

**P√≥s-condi√ß√µes:**
- Avalia√ß√£o registrada no hist√≥rico da proposi√ß√£o
- Status atualizado conforme decis√£o:
  - Finalizada/Prejudicada: proposi√ß√£o encerrada permanentemente
  - Parcial/Em Andamento: proposi√ß√£o volta para 'pendente' (aguarda republica√ß√£o)
- Correi√ß√£o atualizada (status recalculado)
- Proposi√ß√£o removida da fila de avalia√ß√£o
- Dashboard atualizado com novos contadores
- Notifica√ß√£o por e-mail simulada ao correicionado
- Se Parcial/Em Andamento: proposi√ß√£o reaparece na p√°gina de Publica√ß√£o

**Requisitos Relacionados:** RF-AVAL-001 a RF-AVAL-010, RF-HIST-004, RF-NOTIF-001, RF-NOTIF-006, RF-NOTIF-007, RF-NOTIF-009

---

### UC-008: Visualizar e Gerenciar Proposi√ß√µes

**Ator(es):** Admin, User

**Pr√©-condi√ß√µes:**
- Usu√°rio autenticado no sistema
- Ao menos uma correi√ß√£o com proposi√ß√µes cadastradas
- Menu "üìã Proposi√ß√µes" vis√≠vel e acess√≠vel

**Fluxo Principal:**
1. Usu√°rio clica em "üìã Proposi√ß√µes" no menu lateral
2. Sistema redireciona para `proposicoes.html`
3. Sistema exibe placeholder: "Selecione uma Correi√ß√£o para visualizar as proposi√ß√µes"
4. Usu√°rio seleciona correi√ß√£o no dropdown:
   - Admin: v√™ todas as correi√ß√µes
   - User: v√™ apenas correi√ß√µes de seu ramoMP
5. Sistema exibe:
   - Painel com info da correi√ß√£o (tem√°tica, per√≠odo, total de proposi√ß√µes)
   - Se√ß√£o de filtros avan√ßados
   - Bot√£o "üîÑ Limpar Filtros"
   - Contador de resultados
6. Sistema renderiza tabela com 7 colunas:
   - N√∫mero | Tipo | Unidade | Descri√ß√£o | Tags | Status | A√ß√µes
7. Sistema lista TODAS as proposi√ß√µes da correi√ß√£o selecionada
8. Tabela exibe:
   - Status bidimensional (processual + valora√ß√£o) em badges verticais
   - Tags coloridas (se houver)
   - 3 bot√µes de a√ß√£o por linha: üëÅÔ∏è Visualizar | ‚öñÔ∏è Avaliar | ‚úèÔ∏è Editar
9. Sistema exibe contador: "Mostrando X de Y proposi√ß√£o(√µes)"
10. Usu√°rio aplica filtros opcionais (ver FA-01)
11. Usu√°rio identifica proposi√ß√£o de interesse
12. Usu√°rio escolhe uma das 3 a√ß√µes (ver FA-02, FA-03, FA-04)

**Fluxos Alternativos:**

**FA-01: Aplicar Filtros Avan√ßados**
- 10a. Usu√°rio aplica um ou mais filtros:
  - **Busca:** Digite em search box (n√∫mero, unidade, membro, descri√ß√£o)
  - **Tipo:** Determina√ß√£o ou Recomenda√ß√£o
  - **Status Processual:** Pendente, Aguardando, Em An√°lise, Encerrada
  - **Valora√ß√£o:** Nova, Finalizada, Parcial, Em Andamento, Prejudicada
  - **Tag:** Uma das 11 categorias
  - **Prioridade:** Urgente, Alta, Normal
- Sistema aplica todos os filtros simultaneamente (l√≥gica AND)
- Sistema atualiza tabela em tempo real
- Sistema atualiza contador: "Mostrando X de Y proposi√ß√£o(√µes)"
- Continua no passo 11

**FA-02: Visualizar Detalhes da Proposi√ß√£o**
- 12a. Usu√°rio clica "üëÅÔ∏è Visualizar"
- Sistema abre modal de detalhes sobreposto
- Sistema exibe:
  - Todos os metadados da proposi√ß√£o (grid de 2 colunas)
  - Info da correi√ß√£o vinculada
  - Tags coloridas
  - Status bidimensional
  - **Timeline hist√≥rica completa:**
    - Ordenada cronologicamente (oldest ‚Üí newest)
    - Color-coded: üì§ Publica√ß√£o (laranja), üìé Comprova√ß√£o (azul), ‚öñÔ∏è Avalia√ß√£o (verde)
    - Cada entrada mostra: data, usu√°rio, descri√ß√£o, observa√ß√µes
    - Publica√ß√£o: exibe prazoComprovacao
    - Comprova√ß√£o: lista arquivos anexados
    - Avalia√ß√£o: mostra transi√ß√µes de status com badges
  - Contador de intera√ß√µes: "üì§ Publica√ß√µes: X | üìé Comprova√ß√µes: Y | ‚öñÔ∏è Avalia√ß√µes: Z"
- Modal tem bot√£o "üì• Exportar" (ver UC-012)
- Usu√°rio clica "‚ùå Fechar" para retornar √† tabela

**FA-03: Avaliar Proposi√ß√£o (Atalho)**
- 12a. Usu√°rio clica "‚öñÔ∏è Avaliar"
- Sistema redireciona para `avaliacao.html?id={proposicaoId}`
- Ver UC-007 para fluxo de avalia√ß√£o completo
- Ap√≥s avalia√ß√£o, retorna para proposicoes.html

**FA-04: Editar Proposi√ß√£o**
- 12a. Usu√°rio clica "‚úèÔ∏è Editar"
- Sistema abre modal de edi√ß√£o inline
- Sistema preenche formul√°rio com dados atuais:
  - **N√∫mero:** Campo readonly (n√£o edit√°vel)
  - **Tipo:** Radio button (Determina√ß√£o/Recomenda√ß√£o)
  - **Prioridade:** Dropdown (urgente/alta/normal)
  - **Unidade:** Input text
  - **Membro:** Input text
  - **Descri√ß√£o:** Textarea (at√© 5.000 chars)
  - **Tags:** Checkboxes m√∫ltiplas (11 categorias)
- Sistema exibe contador de caracteres para descri√ß√£o
- Usu√°rio altera campos desejados
- Usu√°rio clica "üíæ Salvar"
- Sistema valida campos obrigat√≥rios
- Sistema atualiza proposi√ß√£o no array
- Sistema salva no localStorage
- Sistema exibe alert: "Dados atualizados com sucesso!"
- Sistema fecha modal
- Sistema atualiza linha na tabela (reflete mudan√ßas)

**FA-05: Cancelar Edi√ß√£o**
- 12a.4a. Usu√°rio clica "Cancelar" no modal de edi√ß√£o
- Sistema fecha modal sem salvar
- Dados permanecem inalterados
- Retorna ao passo 11

**FA-06: Limpar Filtros**
- 10a. Usu√°rio clica "üîÑ Limpar Filtros"
- Sistema reseta:
  - Campo de busca (vazio)
  - Todos os dropdowns (op√ß√£o vazia)
- Sistema mant√©m correi√ß√£o selecionada (obrigat√≥ria)
- Sistema re-renderiza tabela com todas as proposi√ß√µes da correi√ß√£o
- Contador atualiza para total
- Retorna ao passo 9

**FA-07: Exportar Proposi√ß√µes**
- 10a. Usu√°rio clica "üì• Exportar"
- Sistema exibe menu dropdown com 3 op√ß√µes
- Ver UC-012 para fluxo de exporta√ß√£o detalhado
- Retorna ao passo 10

**FA-08: Trocar Correi√ß√£o**
- 11a. Usu√°rio seleciona outra correi√ß√£o no dropdown
- Sistema limpa tabela atual
- Sistema carrega proposi√ß√µes da nova correi√ß√£o
- Filtros s√£o preservados (aplicam √† nova correi√ß√£o)
- Contador atualiza
- Retorna ao passo 7

**Fluxos de Exce√ß√£o:**

**FE-01: Nenhuma Correi√ß√£o Dispon√≠vel**
- 4a. Sistema n√£o encontra correi√ß√µes para o usu√°rio
- Dropdown vazio ou com mensagem "Nenhuma correi√ß√£o dispon√≠vel"
- Usu√°rio n√£o pode prosseguir
- Admin deve cadastrar correi√ß√µes primeiro

**FE-02: Correi√ß√£o sem Proposi√ß√µes**
- 7a. Sistema n√£o encontra proposi√ß√µes para correi√ß√£o selecionada
- Sistema exibe mensagem: "Nenhuma proposi√ß√£o cadastrada para esta correi√ß√£o."
- Tabela vazia, contador mostra "0"
- Admin pode cadastrar proposi√ß√µes ou user aguarda publica√ß√£o

**FE-03: Filtros N√£o Retornam Resultados**
- 10a. Sistema aplica filtros e array filtrado fica vazio
- Sistema exibe mensagem: "Nenhuma proposi√ß√£o encontrada com os filtros aplicados."
- Tabela vazia, contador mostra "Mostrando 0 de Y proposi√ß√£o(√µes)"
- Usu√°rio ajusta filtros ou clica "Limpar Filtros"

**FE-04: Valida√ß√£o de Edi√ß√£o - Campos Vazios**
- FA-04.6a. Sistema detecta campos obrigat√≥rios vazios (unidade, membro, descri√ß√£o)
- Sistema exibe alert: "Preencha todos os campos obrigat√≥rios."
- Foca no primeiro campo com erro
- Usu√°rio corrige
- Retorna √† edi√ß√£o

**FE-05: Valida√ß√£o de Edi√ß√£o - Descri√ß√£o Excede Limite**
- FA-04.6a. Sistema detecta descri√ß√£o > 5.000 caracteres
- Contador vermelho
- Sistema exibe alert: "Descri√ß√£o excede o limite de 5.000 caracteres."
- Usu√°rio reduz texto
- Retorna √† edi√ß√£o

**P√≥s-condi√ß√µes:**
- Proposi√ß√µes visualizadas conforme correi√ß√£o selecionada
- Filtros aplicados (se houver)
- Edi√ß√µes salvas no localStorage
- Tabela atualizada com dados corretos
- Hist√≥rico completo preservado e exib√≠vel
- Usu√°rio pode navegar para outras p√°ginas ou continuar explorando

**Requisitos Relacionados:** RF-PROP-002 a RF-PROP-007, RF-BUSCA-001 a RF-BUSCA-010, RF-HIST-006, RF-NOTIF-001

---

### UC-009: Gerenciar Correi√ß√µes (Admin)

**Ator(es):** Admin

**Pr√©-condi√ß√µes:**
- Usu√°rio autenticado como Admin
- Ao menos uma correi√ß√£o cadastrada (para visualiza√ß√£o)
- Menu "üìä Correi√ß√µes" vis√≠vel e acess√≠vel

**Fluxo Principal:**
1. Admin clica em "üìä Correi√ß√µes" no menu lateral
2. Sistema exibe p√°gina com tabela de correi√ß√µes
3. Sistema lista TODAS as correi√ß√µes cadastradas
4. Tabela mostra 13 colunas:
   - N√∫mero | Tem√°tica | N√∫mero ELO | Tipo | MP | UF | Ramo do MP | Total Proposi√ß√µes | **Pendente** | **Em An√°lise** | **Prazo Vencido** | Status | A√ß√µes
5. Colunas especiais destacadas visualmente:
   - **Pendente:** Amarelo bold se > 0
   - **Em An√°lise:** Azul bold se > 0
   - **Prazo Vencido:** Vermelho bold se > 0
6. Sistema exibe controles de interface:
   - **Campo de busca:** Busca em m√∫ltiplos campos
   - **Filtro de Status:** Dropdown (Todas / Apenas Ativas / Apenas Inativas)
   - **Colunas sort√°veis:** N√∫mero, Total Proposi√ß√µes, Pendente, Em An√°lise, Prazo Vencido (indicador ‚áÖ)
   - **Bot√£o "üì• Exportar":** Menu dropdown com 3 op√ß√µes
7. Sistema exibe contador: "X correi√ß√£o(√µes) encontrada(s)"
8. Admin aplica busca ou filtros (ver FA-01)
9. Admin ordena por coluna (ver FA-02)
10. Admin identifica correi√ß√£o de interesse
11. Admin clica bot√£o "Ver" na linha
12. Sistema abre modal de detalhes (ver FA-03)

**Fluxos Alternativos:**

**FA-01: Aplicar Busca e Filtros**
- 8a. Admin digita no campo de busca (ex: "MPBA")
- Sistema busca em: numero, ramoMP, ramoMPNome, tematica, numeroElo, tipo
- Sistema aplica busca case-insensitive e substring
- Sistema atualiza tabela em tempo real
- 8b. Admin seleciona filtro de status:
  - "Apenas Ativas": mostra correi√ß√µes com proposi√ß√µes pendentes
  - "Apenas Inativas": mostra correi√ß√µes com todas proposi√ß√µes finalizadas
- Sistema aplica filtro + busca simultaneamente (AND)
- Sistema atualiza contador
- Continua no passo 10

**FA-02: Ordenar por Coluna**
- 9a. Admin clica no header de coluna sort√°vel (ex: "Prazo Vencido")
- Sistema ordena ascendentemente (‚ñ≤) na primeira vez
- Indicador muda de ‚áÖ para ‚ñ≤
- Admin clica novamente
- Sistema ordena descendentemente (‚ñº)
- Indicador muda para ‚ñº
- Admin clica novamente
- Sistema remove ordena√ß√£o (volta ao padr√£o)
- Indicador volta para ‚áÖ

**FA-03: Visualizar Detalhes da Correi√ß√£o**
- 11a. Admin clica "Ver"
- Sistema abre modal de detalhes sobreposto
- Sistema exibe 3 se√ß√µes organizadas:

  **Se√ß√£o 1: Informa√ß√µes da Correi√ß√£o**
  - N√∫mero, Tem√°tica, N√∫mero ELO, Tipo
  - MP, UF(s), Ramo do MP, Ramo do MP Nome
  - Data de In√≠cio, Data de Fim, Status
  - Observa√ß√µes (se houver)

  **Se√ß√£o 2: Status Processual (4 contadores coloridos)**
  - Pendente (amarelo)
  - Aguardando Comprova√ß√£o (laranja)
  - Em An√°lise (azul)
  - Encerrada (azul escuro)

  **Se√ß√£o 3: Valora√ß√£o (5 contadores coloridos)**
  - Nova (cinza)
  - Finalizada (verde)
  - Parcial (laranja)
  - Em Andamento (vermelho)
  - Prejudicada (cinza escuro)

- Admin clica "‚ùå Fechar" para retornar √† tabela

**FA-04: Exportar Correi√ß√µes**
- 12a. Admin clica "üì• Exportar"
- Sistema exibe menu dropdown com 3 op√ß√µes:
  1. üìÑ Exportar PDF (Tabela)
  2. üíæ Exportar JSON
  3. üìã Relat√≥rio Detalhado (PDF)
- Ver UC-012 para fluxo de exporta√ß√£o detalhado
- Retorna ao passo 10

**FA-05: Limpar Busca**
- 8a. Admin apaga texto do campo de busca
- Sistema remove filtro de busca
- Tabela exibe todas as correi√ß√µes (respeitando filtro de status, se ativo)
- Contador atualiza
- Retorna ao passo 10

**FA-06: Resetar Filtro de Status**
- 8b. Admin seleciona "Todas (ativas e inativas)"
- Sistema remove filtro de status
- Tabela exibe todas as correi√ß√µes (respeitando busca, se ativa)
- Contador atualiza
- Retorna ao passo 10

**Fluxos de Exce√ß√£o:**

**FE-01: Nenhuma Correi√ß√£o Cadastrada**
- 3a. Sistema n√£o encontra correi√ß√µes no array
- Sistema exibe mensagem: "Nenhuma correi√ß√£o cadastrada no sistema."
- Tabela vazia, contador mostra "0 correi√ß√£o(√µes)"
- Admin deve cadastrar correi√ß√µes via UC-003

**FE-02: Busca/Filtro N√£o Retorna Resultados**
- 8a. Sistema aplica busca/filtro e array filtrado fica vazio
- Sistema exibe mensagem: "Nenhuma correi√ß√£o encontrada."
- Tabela vazia, contador mostra "0 correi√ß√£o(√µes) encontrada(s)"
- Admin ajusta busca/filtro ou limpa

**P√≥s-condi√ß√µes:**
- Correi√ß√µes visualizadas conforme filtros aplicados
- Ordena√ß√£o preservada durante sess√£o
- Modal de detalhes exibe breakdown completo de proposi√ß√µes
- Admin tem vis√£o completa do status de cada correi√ß√£o
- Dados prontos para exporta√ß√£o se necess√°rio

**Requisitos Relacionados:** RF-COR-002 a RF-COR-005, RF-COR-008, RF-BUSCA-001, RF-BUSCA-008

---

### UC-010: Ciclo Completo de Proposi√ß√£o (Iterativo)

**Ator(es):** Admin, User

**Pr√©-condi√ß√µes:**
- Sistema operacional com correi√ß√£o e proposi√ß√£o cadastradas
- Proposi√ß√£o com status inicial `['pendente', 'nova']`

**Fluxo Principal: Ciclo Bem-Sucedido (Finalizada na Primeira Tentativa)**

1. **Fase 1: Publica√ß√£o (Admin)**
   - Admin acessa "Publicar Proposi√ß√µes"
   - Seleciona correi√ß√£o
   - Marca proposi√ß√£o(√µes) pendente(s)
   - Define prazoComprovacao (ex: 30 dias)
   - Adiciona observa√ß√µes (opcional)
   - Confirma publica√ß√£o
   - Sistema atualiza status: ['aguardando_comprovacao', 'nova']
   - Sistema registra entrada de 'publicacao' no historico
   - Sistema define prazoComprovacao e dataPublicacao

2. **Fase 2: Comprova√ß√£o (User)**
   - User acessa "Enviar Comprova√ß√£o"
   - Identifica proposi√ß√£o publicada (com prazo definido)
   - Clica "Adicionar"
   - Preenche descri√ß√£o do adimplemento (at√© 7.500 chars)
   - Adiciona observa√ß√µes (opcional)
   - Anexa arquivos comprobat√≥rios (PDFs, imagens, planilhas)
   - Envia comprova√ß√£o
   - Sistema atualiza status: ['em_analise', 'nova']
   - Sistema registra entrada de 'comprovacao' no historico

3. **Fase 3: Avalia√ß√£o (Admin)**
   - Admin acessa "Avaliar Comprova√ß√µes"
   - Identifica proposi√ß√£o em an√°lise
   - Clica "Avaliar"
   - Analisa descri√ß√£o, arquivos anexados e hist√≥rico
   - Seleciona decis√£o: ‚úÖ Finalizada
   - Redige parecer positivo
   - Submete avalia√ß√£o
   - Sistema atualiza status: ['encerrada', 'finalizada']
   - Sistema registra entrada de 'avaliacao' no historico
   - **Ciclo finalizado com sucesso ‚úì**

4. **P√≥s-Ciclo:**
   - Proposi√ß√£o removida de todas as filas de trabalho
   - Correi√ß√£o recalcula status (pode tornar-se 'inativo' se todas conclu√≠das)
   - Dashboard atualizado
   - Hist√≥rico completo preservado: pub1 ‚Üí comp1 ‚Üí aval1

**Fluxos Alternativos:**

**FA-01: Ciclo com Avalia√ß√£o Parcial (Republica√ß√£o)**

1. **Fases 1-2:** Id√™nticas ao fluxo principal
2. **Fase 3: Avalia√ß√£o Parcial (Admin)**
   - Admin seleciona decis√£o: ‚ö†Ô∏è Parcial
   - Parecer indica cumprimento parcial e explica pend√™ncias
   - Sistema atualiza status: ['pendente', 'parcial']
   - **IMPORTANTE:** Status processual volta para 'pendente' (n√£o 'parcial')
   - Hist√≥rico preserva valora√ß√£o 'parcial' na entrada de avaliacao
   - Proposi√ß√£o reaparece em "Publicar Proposi√ß√µes"

3. **Fase 4: Republica√ß√£o (Admin)**
   - Admin acessa "Publicar Proposi√ß√µes"
   - Identifica proposi√ß√£o com valora√ß√£o 'parcial'
   - Marca proposi√ß√£o
   - Define NOVO prazoComprovacao (pode ser diferente do anterior)
   - Adiciona novas observa√ß√µes (opcional)
   - Confirma republica√ß√£o
   - Sistema atualiza status: ['aguardando_comprovacao', 'parcial']
   - Sistema registra NOVA entrada de 'publicacao' no historico (n√£o substitui anterior)
   - **Hist√≥rico agora:** pub1 ‚Üí comp1 ‚Üí aval1(parcial) ‚Üí pub2

4. **Fase 5: Nova Comprova√ß√£o (User)**
   - User acessa "Enviar Comprova√ß√£o"
   - V√™ proposi√ß√£o republicada
   - Preenche descri√ß√£o complementar (focando nas pend√™ncias apontadas)
   - Anexa novos arquivos
   - Envia nova comprova√ß√£o
   - Sistema atualiza status: ['em_analise', 'parcial']
   - Sistema registra NOVA entrada de 'comprovacao' no historico
   - **Hist√≥rico agora:** pub1 ‚Üí comp1 ‚Üí aval1(parcial) ‚Üí pub2 ‚Üí comp2

5. **Fase 6: Reavalia√ß√£o (Admin)**
   - Admin avalia nova comprova√ß√£o
   - Seleciona decis√£o: ‚úÖ Finalizada (desta vez completo)
   - Sistema atualiza status: ['encerrada', 'finalizada']
   - Sistema registra NOVA entrada de 'avaliacao' no historico
   - **Ciclo finalizado ap√≥s 2 itera√ß√µes ‚úì**
   - **Hist√≥rico completo:** pub1 ‚Üí comp1 ‚Üí aval1(parcial) ‚Üí pub2 ‚Üí comp2 ‚Üí aval2(finalizada)

**FA-02: Ciclo com Avalia√ß√£o Em Andamento (Republica√ß√£o)**

Fluxo id√™ntico ao FA-01, mas:
- Fase 3: Admin seleciona ‚ùå Em Andamento
- Status: ['pendente', 'em_andamento']
- Parecer explica n√£o cumprimento
- Republica√ß√£o obrigat√≥ria com novo prazo
- Itera√ß√µes continuam at√© adimpl√™ncia ou at√© Admin decidir prejudicada

**FA-03: Ciclo Encerrado como Prejudicada**

1. **Fases 1-2:** Id√™nticas ao fluxo principal
2. **Fase 3: Avalia√ß√£o Prejudicada (Admin)**
   - Admin seleciona decis√£o: üö´ Prejudicada
   - Parecer explica motivo:
     - Proposi√ß√£o superada por mudan√ßa legal
     - N√£o mais aplic√°vel ao contexto
     - Correi√ß√£o encerrada prematuramente
     - Outro motivo fundamentado
   - Sistema atualiza status: ['encerrada', 'prejudicada']
   - **Ciclo finalizado sem comprova√ß√£o de cumprimento ‚úì**

**FA-04: Comprova√ß√£o com Rascunho Intermedi√°rio**

1. **Fase 2a: Salvar Rascunho (User)**
   - User acessa "Enviar Comprova√ß√£o"
   - Come√ßa a preencher formul√°rio
   - Percebe que precisa buscar mais documentos
   - Clica "üíæ Salvar como Rascunho"
   - Sistema salva em `proposicao.rascunhos[]`
   - Status permanece: ['aguardando_comprovacao', valoracao]
   - Proposi√ß√£o continua na lista com indicador "üìù Rascunho"

2. **Fase 2b: Retomar e Enviar (User - posterior)**
   - User retorna √† "Enviar Comprova√ß√£o"
   - Clica "Editar" (em vez de "Adicionar")
   - Sistema auto-carrega rascunho
   - User completa com informa√ß√µes faltantes
   - Clica "üì§ Enviar Comprova√ß√£o"
   - Sistema limpa rascunho
   - Status muda para: ['em_analise', valoracao]
   - Continua com Fase 3 (Avalia√ß√£o)

**FA-05: Prazo Vencido (User Envia Atrasado)**

1. **Fase 1:** Publica√ß√£o com prazo definido
2. **Intervalo:** User N√ÉO envia comprova√ß√£o dentro do prazo
3. **Sistema:** Detecta `prazoComprovacao < hoje`
   - Dashboard incrementa card "Prazo Vencido"
   - Tabelas destacam linha com background vermelho + ‚ö†Ô∏è
   - Alerta na p√°gina de comprova√ß√£o: "‚ö†Ô∏è PRAZO VENCIDO - Vencido h√° X dia(s)"
4. **Fase 2 (Atrasada):** User envia comprova√ß√£o mesmo com prazo vencido
   - Sistema ACEITA comprova√ß√£o (n√£o bloqueia)
   - Status muda para: ['em_analise', valoracao]
   - Hist√≥rico registra data real de envio (ap√≥s prazo)
5. **Fase 3:** Admin avalia considerando atraso
   - Parecer pode mencionar descumprimento de prazo
   - Decis√£o pode ser influenciada pelo atraso

**Fluxos de Exce√ß√£o:**

**FE-01: User N√£o Envia Comprova√ß√£o (Indefinidamente)**
- Ap√≥s Fase 1 (publica√ß√£o), user nunca envia comprova√ß√£o
- Status permanece: ['aguardando_comprovacao', valoracao]
- Proposi√ß√£o acumula atraso (prazo vencido)
- Dashboard e tabelas sinalizam problema
- Admin pode:
  - Republicar com novo prazo (tentar novamente)
  - Avaliar como em_andamento sem aguardar comprova√ß√£o (futuro)
  - Marcar como prejudicada se deixar de ser aplic√°vel

**FE-02: Admin N√£o Avalia Comprova√ß√£o (Indefinidamente)**
- Ap√≥s Fase 2 (comprova√ß√£o enviada), admin n√£o avalia
- Status permanece: ['em_analise', valoracao]
- Proposi√ß√£o fica "presa" na fila de avalia√ß√£o
- User n√£o pode submeter nova comprova√ß√£o
- Correi√ß√£o permanece 'ativa'
- Solu√ß√£o: Admin deve processar fila de avalia√ß√µes

**FE-03: M√∫ltiplas Itera√ß√µes (Em Andamento Repetido)**
- User envia comprova√ß√£o inadequada m√∫ltiplas vezes
- Admin avalia como em_andamento repetidamente
- Ciclo: pub1 ‚Üí comp1 ‚Üí aval1(inad) ‚Üí pub2 ‚Üí comp2 ‚Üí aval2(inad) ‚Üí pub3 ‚Üí ...
- Hist√≥rico cresce com m√∫ltiplas entradas
- Admin pode eventualmente marcar como prejudicada para encerrar

**P√≥s-condi√ß√µes:**
- **Ciclo Finalizada:** Proposi√ß√£o encerrada com sucesso, correi√ß√£o pode tornar-se inativa
- **Ciclo Parcial/Em Andamento:** Proposi√ß√£o volta para pendente, aguarda republica√ß√£o
- **Ciclo Prejudicada:** Proposi√ß√£o encerrada sem cumprimento
- **Hist√≥rico:** Completo e audit√°vel, preservando TODAS as intera√ß√µes
- **Timeline:** Visual mostra evolu√ß√£o completa com cores e √≠cones
- **Dashboard:** Sempre atualizado refletindo estado real
- **Rastreabilidade:** 100% das transi√ß√µes documentadas

**Requisitos Relacionados:** RF-PUB-*, RF-COMP-*, RF-AVAL-*, RF-HIST-*, RF-NOTIF-*

---

---

**Fim da Parte 2.5**

Os 10 casos de uso documentados cobrem TODOS os fluxos principais do sistema:
- **UC-001 a UC-004:** Gest√£o b√°sica (login, dashboard, cadastros)
- **UC-005 a UC-007:** Workflows cr√≠ticos (publica√ß√£o, comprova√ß√£o, avalia√ß√£o)
- **UC-008 a UC-009:** Gest√£o avan√ßada (proposi√ß√µes, correi√ß√µes)
- **UC-010:** Ciclo completo iterativo (workflow end-to-end)

Casos de uso secund√°rios (exporta√ß√£o, logout, filtros) est√£o integrados aos fluxos principais e n√£o requerem documenta√ß√£o separada.

---

## 4. Regras de Neg√≥cio Consolidadas

Esta se√ß√£o consolida TODAS as regras de neg√≥cio (RN-*) referenciadas nos 105 requisitos funcionais documentados nas se√ß√µes anteriores. As regras est√£o organizadas por m√≥dulo funcional para facilitar refer√™ncia e manuten√ß√£o.

### 4.1. M√≥dulo de Autentica√ß√£o (RN-AUTH)

**RN-AUTH-01: Perfis de Usu√°rio**
- **Descri√ß√£o:** O sistema possui exatamente 2 perfis: Admin (Corregedoria Nacional) e User (√ìrg√£o Correicionado)
- **Justificativa:** Separa√ß√£o clara de responsabilidades entre √≥rg√£o fiscalizador e fiscalizado
- **Impacto:** Controla visibilidade de menus, p√°ginas e funcionalidades

**RN-AUTH-02: Autentica√ß√£o Simplificada (Prot√≥tipo)**
- **Descri√ß√£o:** Sistema aceita qualquer credencial v√°lida sem valida√ß√£o real de senha
- **Justificativa:** Prot√≥tipo funcional sem backend - foco em workflow e UI
- **Impacto:** N√ÉO deve ser usado em produ√ß√£o - requer integra√ß√£o com sistema de autentica√ß√£o corporativo

**RN-AUTH-03: Persist√™ncia de Sess√£o**
- **Descri√ß√£o:** Sess√£o do usu√°rio √© mantida em localStorage para persist√™ncia entre navega√ß√µes
- **Justificativa:** Evita re-login ao navegar entre p√°ginas standalone (index.html, proposicoes.html, etc.)
- **Impacto:** Auto-login funciona em todas as p√°ginas do sistema

**RN-AUTH-04: Controle de Acesso por Perfil**
- **Descri√ß√£o:** Admin v√™ TODAS as funcionalidades; User v√™ apenas funcionalidades n√£o-administrativas
- **Justificativa:** Segrega√ß√£o de fun√ß√µes conforme hierarquia institucional
- **Impacto:** P√°ginas administrativas redirecionam usu√°rios n√£o-autorizados para index.html

### 4.2. M√≥dulo de Dashboard (RN-DASH)

**RN-DASH-01: Filtragem de Dados por Correi√ß√£o**
- **Descri√ß√£o:** Dashboard pode exibir estat√≠sticas de todas as correi√ß√µes (padr√£o) ou de uma correi√ß√£o espec√≠fica
- **Justificativa:** Permite foco em revis√£o espec√≠fica durante opera√ß√£o ativa
- **Impacto:** Todos os cards e gr√°ficos recalculam dinamicamente ao alterar filtro

**RN-DASH-02: Visibilidade Baseada em Permiss√£o**
- **Descri√ß√£o:** Admin v√™ todas as correi√ß√µes; User v√™ apenas correi√ß√µes do seu ramoMP
- **Justificativa:** Correicionado n√£o deve visualizar dados de outros MPs
- **Impacto:** Filtro de correi√ß√£o √© pr√©-filtrado conforme perfil do usu√°rio

**RN-DASH-03: Contadores em Tempo Real**
- **Descri√ß√£o:** Todos os 5 cards (Correi√ß√µes Realizadas, Ativas, Total Proposi√ß√µes, Ativas, Prazo Vencido) atualizam ap√≥s qualquer opera√ß√£o
- **Justificativa:** Dashboard deve refletir estado atual do sistema
- **Impacto:** Fun√ß√µes de publica√ß√£o, comprova√ß√£o e avalia√ß√£o DEVEM chamar updateDashboard()

**RN-DASH-04: Gr√°ficos Bidimensionais**
- **Descri√ß√£o:** Sistema exibe 2 gr√°ficos separados: Fluxo de Trabalho (4 status processuais) e Valora√ß√£o (5 status de avalia√ß√£o)
- **Justificativa:** Status bidimensional [processual, valoracao] requer visualiza√ß√£o separada
- **Impacto:** Altera√ß√µes de status devem atualizar ambos os gr√°ficos

**RN-DASH-05: Escalabilidade Visual dos Gr√°ficos**
- **Descri√ß√£o:** Barras dos gr√°ficos auto-escalam altura com base no maior valor, largura distribui igualmente entre categorias
- **Justificativa:** Gr√°ficos permanecem leg√≠veis independente da distribui√ß√£o de dados
- **Impacto:** Algoritmo de renderiza√ß√£o deve recalcular propor√ß√µes dinamicamente

### 4.3. M√≥dulo de Correi√ß√µes (RN-COR)

**RN-COR-01: Status Calculado Automaticamente**
- **Descri√ß√£o:** Status de correi√ß√£o ('ativo' ou 'inativo') √© calculado com base nas proposi√ß√µes vinculadas
- **Justificativa:** Evita inconsist√™ncia - status manual poderia divergir da realidade
- **Impacto:** Status N√ÉO √© campo edit√°vel; recalculado por calcularStatusCorreicao()

**RN-COR-02: Crit√©rio de Correi√ß√£o Ativa**
- **Descri√ß√£o:** Correi√ß√£o √© 'ativa' se possui ao menos uma proposi√ß√£o com valora√ß√£o diferente de 'finalizada' ou 'prejudicada'
- **Justificativa:** Correi√ß√£o s√≥ est√° completa quando todas as proposi√ß√µes est√£o resolvidas
- **Impacto:** Encerramento de proposi√ß√µes como finalizada/prejudicada pode tornar correi√ß√£o inativa

**RN-COR-03: Sele√ß√£o de UF por Tipo de MP**
- **Descri√ß√£o:** MPE permite uma √∫nica UF; MPU permite m√∫ltiplas UFs
- **Justificativa:** MPE √© estadual (uma jurisdi√ß√£o); MPU √© federal (m√∫ltiplas jurisdi√ß√µes)
- **Impacto:** Formul√°rio ajusta dinamicamente (toggleUFMultiple) ao alterar campo MP

**RN-COR-04: Formato de N√∫mero ELO**
- **Descri√ß√£o:** N√∫mero ELO deve seguir formato NNNNNNN-DD.AAAA.J.TT.OOOO
- **Justificativa:** Padroniza√ß√£o de identifica√ß√£o no sistema ELO nacional
- **Impacto:** Valida√ß√£o pode ser implementada no frontend ou backend

**RN-COR-05: Tipos de Correi√ß√£o Padronizados**
- **Descri√ß√£o:** 4 tipos v√°lidos: 'Ordin√°ria', 'Extraordin√°ria', 'OCD', 'Inspe√ß√£o'
- **Justificativa:** Tipologia oficial do CNMP
- **Impacto:** Dropdown deve conter exatamente essas 4 op√ß√µes

**RN-COR-06: Ordena√ß√£o da Tabela**
- **Descri√ß√£o:** Tabela de correi√ß√µes suporta ordena√ß√£o por 5 colunas: N√∫mero, Total Proposi√ß√µes, Pendente, Em An√°lise, Prazo Vencido
- **Justificativa:** Facilita prioriza√ß√£o de trabalho (ex: ordenar por Prazo Vencido DESC)
- **Impacto:** Clique no header alterna ASC/DESC com indicador visual

**RN-COR-07: Filtro de Status**
- **Descri√ß√£o:** Usu√°rio pode filtrar tabela para ver: Todas, Apenas Ativas, ou Apenas Inativas
- **Justificativa:** Opera√ß√£o di√°ria foca em ativas; consulta hist√≥rica foca em inativas
- **Impacto:** Filtro trabalha em conjunto com busca textual (l√≥gica AND)

### 4.4. M√≥dulo de Proposi√ß√µes (RN-PROP)

**RN-PROP-01: V√≠nculo Obrigat√≥rio com Correi√ß√£o**
- **Descri√ß√£o:** Toda proposi√ß√£o DEVE ter correicaoId v√°lido
- **Justificativa:** Proposi√ß√µes n√£o existem isoladamente - derivam de correi√ß√µes
- **Impacto:** Formul√°rio de cadastro exige sele√ß√£o de correi√ß√£o; dele√ß√£o de correi√ß√£o deve considerar proposi√ß√µes vinculadas

**RN-PROP-02: Status Bidimensional**
- **Descri√ß√£o:** Status √© array [statusProcessual, valoracao] com 2 dimens√µes independentes
- **Justificativa:** Workflow (onde est√°) √© diferente de qualidade (como foi avaliado)
- **Impacto:** Todas as fun√ß√µes de consulta devem usar √≠ndices [0] e [1] corretamente

**RN-PROP-03: Tipos de Proposi√ß√£o**
- **Descri√ß√£o:** 2 tipos v√°lidos: 'Determina√ß√£o' (obrigat√≥ria) e 'Recomenda√ß√£o' (orientativa)
- **Justificativa:** Distin√ß√£o jur√≠dica entre ordem vinculante e orienta√ß√£o n√£o vinculante
- **Impacto:** Tipo influencia como correicionado trata a proposi√ß√£o

**RN-PROP-04: Prazo de Comprova√ß√£o**
- **Descri√ß√£o:** prazoComprovacao s√≥ √© definido quando proposi√ß√£o √© publicada (entra em aguardando_comprovacao)
- **Justificativa:** Prazo √© responsabilidade da Corregedoria Nacional ao publicar
- **Impacto:** Campo √© null at√© publica√ß√£o; proposi√ß√µes pendentes n√£o t√™m prazo

**RN-PROP-05: Hist√≥rico Append-Only**
- **Descri√ß√£o:** Array historico[] s√≥ recebe novos elementos (.push), nunca modifica elementos existentes
- **Justificativa:** Auditoria completa exige imutabilidade de registros hist√≥ricos
- **Impacto:** Fun√ß√µes de publica√ß√£o/comprova√ß√£o/avalia√ß√£o sempre adicionam, nunca editam

**RN-PROP-06: Tags Categorizadas**
- **Descri√ß√£o:** Proposi√ß√µes podem ter m√∫ltiplas tags de um conjunto pr√©-definido de 11 categorias
- **Justificativa:** Facilita busca e an√°lise tem√°tica de proposi√ß√µes
- **Impacto:** Tags s√£o array de IDs; renderiza√ß√£o traduz para labels e cores

**RN-PROP-07: Prioridade com Impacto Visual**
- **Descri√ß√£o:** 3 n√≠veis de prioridade: 'urgente' (vermelho), 'alta' (laranja), 'normal' (preto)
- **Justificativa:** Destaque visual acelera identifica√ß√£o de proposi√ß√µes cr√≠ticas
- **Impacto:** CSS aplica cores distintivas em badges e textos

**RN-PROP-08: Correi√ß√£o Obrigat√≥ria na Visualiza√ß√£o**
- **Descri√ß√£o:** Na p√°gina proposicoes.html, usu√°rio DEVE selecionar uma correi√ß√£o antes de ver tabela de proposi√ß√µes
- **Justificativa:** Evita sobrecarga de informa√ß√£o; foca trabalho em uma revis√£o por vez
- **Impacto:** Tabela e filtros ficam ocultos at√© sele√ß√£o de correi√ß√£o

**RN-PROP-09: Edi√ß√£o de Metadados (N√£o de Status)**
- **Descri√ß√£o:** Modal de edi√ß√£o permite alterar tipo, prioridade, unidade, membro, descri√ß√£o, tags - MAS N√ÉO status
- **Justificativa:** Status muda apenas via workflow (publica√ß√£o/comprova√ß√£o/avalia√ß√£o)
- **Impacto:** Campo status n√£o aparece no formul√°rio de edi√ß√£o

### 4.5. M√≥dulo de Publica√ß√£o (RN-PUB)

**RN-PUB-01: Apenas Proposi√ß√µes Pendentes**
- **Descri√ß√£o:** P√°gina de publica√ß√£o exibe SOMENTE proposi√ß√µes com status [' pendente', *]
- **Justificativa:** Publica√ß√£o √© o gateway para workflow - s√≥ aceita proposi√ß√µes em estado inicial
- **Impacto:** Filtro obrigat√≥rio na renderiza√ß√£o da tabela

**RN-PUB-02: Republica√ß√£o de Parcial/Em Andamento**
- **Descri√ß√£o:** Proposi√ß√µes avaliadas como parcial ou em_andamento voltam para status 'pendente' e podem ser republicadas
- **Justificativa:** Workflow iterativo - correicionado tem nova chance de cumprir
- **Impacto:** Hist√≥rico preserva avalia√ß√£o anterior; nova publica√ß√£o cria novo prazo

**RN-PUB-03: Prazo √önico para Lote**
- **Descri√ß√£o:** Ao publicar m√∫ltiplas proposi√ß√µes simultaneamente, um √∫nico prazoComprovacao se aplica a todas
- **Justificativa:** Simplifica opera√ß√£o em lote - √≥rg√£o correicionado responde tudo numa mesma data
- **Impacto:** Formul√°rio tem um campo de prazo, n√£o um por proposi√ß√£o

**RN-PUB-04: Sele√ß√£o Obrigat√≥ria**
- **Descri√ß√£o:** Publica√ß√£o exige ao menos uma proposi√ß√£o selecionada (checkbox marcado)
- **Justificativa:** Opera√ß√£o vazia n√£o tem sentido
- **Impacto:** Bot√£o "Publicar" deve estar desabilitado ou validar antes de processar

**RN-PUB-05: Confirma√ß√£o Antes de Publicar**
- **Descri√ß√£o:** Sistema exibe dialog de confirma√ß√£o mostrando quantidade de proposi√ß√µes e prazo antes de efetivar
- **Justificativa:** Evita publica√ß√µes acidentais - opera√ß√£o impacta √≥rg√£os externos
- **Impacto:** Usu√°rio pode cancelar antes de commit

**RN-PUB-06: Publica√ß√£o Cria Entrada em Hist√≥rico**
- **Descri√ß√£o:** Cada publica√ß√£o adiciona entrada tipo 'publicacao' no historico[] com statusAnterior, statusNovo, prazoComprovacao
- **Justificativa:** Auditoria completa - saber quando, quem e com qual prazo foi publicado
- **Impacto:** Timeline visual exibe todas as publica√ß√µes com √≠cone üì§ laranja

**RN-PUB-07: Status Muda para Aguardando Comprova√ß√£o**
- **Descri√ß√£o:** Ap√≥s publica√ß√£o, status processual muda de 'pendente' para 'aguardando_comprovacao'
- **Justificativa:** Proposi√ß√£o agora est√° com √≥rg√£o correicionado esperando resposta
- **Impacto:** Proposi√ß√£o deixa de aparecer na lista de publica√ß√£o e passa a aparecer na lista de comprova√ß√£o (user)

**RN-PUB-08: Acesso Administrativo Exclusivo**
- **Descri√ß√£o:** P√°gina publicacao.html valida perfil Admin; redireciona n√£o-admins para index.html
- **Justificativa:** Publica√ß√£o √© prerrogativa da Corregedoria Nacional
- **Impacto:** Usu√°rios correicionados nunca acessam esta funcionalidade

**RN-PUB-09: Sele√ß√£o de Correi√ß√£o Obrigat√≥ria**
- **Descri√ß√£o:** Admin DEVE selecionar uma correi√ß√£o para visualizar proposi√ß√µes pendentes daquela revis√£o
- **Justificativa:** Organiza trabalho por correi√ß√£o; evita misturar proposi√ß√µes de revis√µes diferentes
- **Impacto:** Placeholder exibido at√© sele√ß√£o; tabela s√≥ renderiza ap√≥s escolha

**RN-PUB-10: Valora√ß√£o Preservada na Republica√ß√£o**
- **Descri√ß√£o:** Ao republicar proposi√ß√£o com avalia√ß√£o parcial/em_andamento, status se torna ['aguardando_comprovacao', valoracao_anterior]
- **Justificativa:** Valora√ß√£o reflete qualidade da √∫ltima avalia√ß√£o - n√£o √© resetada
- **Impacto:** Hist√≥rico visual mostra que proposi√ß√£o j√° foi avaliada negativamente antes

### 4.6. M√≥dulo de Comprova√ß√£o (RN-COMP)

**RN-COMP-01: Apenas Aguardando Comprova√ß√£o**
- **Descri√ß√£o:** Usu√°rio pode submeter comprova√ß√£o SOMENTE para proposi√ß√µes com status ['aguardando_comprovacao', *]
- **Justificativa:** Workflow linear - comprova√ß√£o requer publica√ß√£o pr√©via
- **Impacto:** Dropdown de proposi√ß√µes filtra por este crit√©rio; proposi√ß√µes pendentes n√£o aparecem

**RN-COMP-02: Submiss√£o sem Publica√ß√£o √© Bloqueada**
- **Descri√ß√£o:** Sistema N√ÉO permite submeter comprova√ß√£o para proposi√ß√µes com status 'pendente'
- **Justificativa:** Princ√≠pio de Publication-Gated Workflow - toda comprova√ß√£o precisa de prazo definido
- **Impacto:** Correicionado n√£o consegue "adiantar" comprova√ß√£o antes de receber publica√ß√£o oficial

**RN-COMP-03: M√∫ltiplos Arquivos Anexados**
- **Descri√ß√£o:** Comprova√ß√£o pode incluir m√∫ltiplos arquivos como evid√™ncia (faturas, fotos, atas, etc.)
- **Justificativa:** Comprova√ß√£o robusta exige documenta√ß√£o variada
- **Impacto:** Interface de upload aceita drag-and-drop e sele√ß√£o m√∫ltipla

**RN-COMP-04: Rascunhos Intermedi√°rios**
- **Descri√ß√£o:** Usu√°rio pode salvar comprova√ß√£o incompleta como rascunho antes de envio definitivo
- **Justificativa:** Permite pausar trabalho e retomar depois sem perder progresso
- **Impacto:** Rascunho armazenado em proposicao.rascunhos[]; status N√ÉO muda

**RN-COMP-05: Um Rascunho por Proposi√ß√£o**
- **Descri√ß√£o:** Sistema mant√©m no m√°ximo 1 rascunho por proposi√ß√£o; salvar novo rascunho substitui anterior
- **Justificativa:** Simplifica l√≥gica - √∫ltimo rascunho sempre √© o v√°lido
- **Impacto:** Array rascunhos[] tem length 0 ou 1

**RN-COMP-06: Submiss√£o Limpa Rascunho**
- **Descri√ß√£o:** Ao enviar comprova√ß√£o definitiva, sistema apaga rascunho correspondente
- **Justificativa:** Rascunho perde sentido ap√≥s submiss√£o oficial
- **Impacto:** proposicao.rascunhos = []

**RN-COMP-07: Status Muda para Em An√°lise**
- **Descri√ß√£o:** Ap√≥s envio de comprova√ß√£o, status processual muda de 'aguardando_comprovacao' para 'em_analise'
- **Justificativa:** Bola agora est√° com Corregedoria para avalia√ß√£o
- **Impacto:** Proposi√ß√£o sai da lista de comprova√ß√£o (user) e entra na fila de avalia√ß√£o (admin)

**RN-COMP-08: Comprova√ß√£o Cria Entrada em Hist√≥rico**
- **Descri√ß√£o:** Submiss√£o adiciona entrada tipo 'comprovacao' no historico[] com descri√ß√£o, arquivos, data
- **Justificativa:** Auditoria - rastrear o que foi submetido e quando
- **Impacto:** Timeline visual exibe comprova√ß√£o com √≠cone üìé azul e lista de arquivos

**RN-COMP-09: Submiss√£o Ap√≥s Prazo √© Permitida**
- **Descri√ß√£o:** Sistema aceita comprova√ß√£o mesmo se prazoComprovacao < hoje
- **Justificativa:** Melhor receber atrasado do que nunca; admin pode considerar atraso na avalia√ß√£o
- **Impacto:** Alerta visual de prazo vencido, mas bot√£o de envio permanece habilitado

**RN-COMP-10: Limite de Caracteres**
- **Descri√ß√£o:** Descri√ß√£o de comprova√ß√£o tem limite de 7.500 caracteres; observa√ß√µes adicionais t√™m limite de 1.000
- **Justificativa:** Evita textos excessivamente longos; for√ßa objetividade
- **Impacto:** Textarea com contador em tempo real; valida√ß√£o no submit

### 4.7. M√≥dulo de Avalia√ß√£o (RN-AVAL)

**RN-AVAL-01: Apenas Em An√°lise**
- **Descri√ß√£o:** Fila de avalia√ß√£o exibe SOMENTE proposi√ß√µes com status ['em_analise', *]
- **Justificativa:** Admin avalia apenas comprova√ß√µes j√° submetidas
- **Impacto:** Tabela de avalia√ß√£o filtra por este crit√©rio

**RN-AVAL-02: Quatro Decis√µes Poss√≠veis**
- **Descri√ß√£o:** Admin pode avaliar como: Finalizada, Parcial, Em Andamento, ou Prejudicada
- **Justificativa:** Cobre todos os cen√°rios: sucesso total, sucesso parcial, falha, ou obsolesc√™ncia
- **Impacto:** Interface exibe 4 op√ß√µes visuais (cards de radio button)

**RN-AVAL-03: Parecer Obrigat√≥rio**
- **Descri√ß√£o:** Avalia√ß√£o exige parecer t√©cnico escrito (at√© 7.500 caracteres)
- **Justificativa:** Decis√£o deve ser fundamentada para defesa jur√≠dica
- **Impacto:** Campo textarea obrigat√≥rio com valida√ß√£o

**RN-AVAL-04: Finalizada Encerra Ciclo**
- **Descri√ß√£o:** Decis√£o 'finalizada' muda status para ['encerrada', 'finalizada']
- **Justificativa:** Proposi√ß√£o cumprida - ciclo completo
- **Impacto:** Proposi√ß√£o sai de todas as filas de trabalho; correi√ß√£o pode tornar-se inativa

**RN-AVAL-05: Prejudicada Encerra Ciclo**
- **Descri√ß√£o:** Decis√£o 'prejudicada' muda status para ['encerrada', 'prejudicada']
- **Justificativa:** Proposi√ß√£o obsoleta ou n√£o mais aplic√°vel - encerramento sem cumprimento
- **Impacto:** Similar a finalizada em termos de workflow, mas indica n√£o-cumprimento justificado

**RN-AVAL-06: Parcial Volta para Pendente**
- **Descri√ß√£o:** Decis√£o 'parcial' muda status para ['pendente', 'parcial']
- **Justificativa:** Cumprimento incompleto - requer nova publica√ß√£o com ajustes
- **Impacto:** Proposi√ß√£o volta para fila de publica√ß√£o; admin deve republicar

**RN-AVAL-07: Em Andamento Volta para Pendente**
- **Descri√ß√£o:** Decis√£o 'em_andamento' muda status para ['pendente', 'em_andamento']
- **Justificativa:** N√£o cumprimento - requer nova publica√ß√£o para dar nova chance
- **Impacto:** Proposi√ß√£o volta para fila de publica√ß√£o; admin deve republicar

**RN-AVAL-08: Status Processual vs Valora√ß√£o**
- **Descri√ß√£o:** Ao avaliar como parcial/em_andamento, status processual vira 'pendente' MAS valora√ß√£o preserva 'parcial'/'em_andamento'
- **Justificativa:** Status processual indica onde est√° no workflow; valora√ß√£o indica resultado da √∫ltima avalia√ß√£o
- **Impacto:** Hist√≥rico preserva valora√ß√£o real; badges exibem ambos

**RN-AVAL-09: Avalia√ß√£o Cria Entrada em Hist√≥rico**
- **Descri√ß√£o:** Avalia√ß√£o adiciona entrada tipo 'avaliacao' no historico[] com parecer, decis√£o, statusAnterior, statusNovo
- **Justificativa:** Auditoria - rastrear decis√µes e fundamenta√ß√µes
- **Impacto:** Timeline visual exibe avalia√ß√£o com √≠cone ‚öñÔ∏è verde

**RN-AVAL-10: Republica√ß√£o Preserva Hist√≥rico**
- **Descri√ß√£o:** Ao republicar proposi√ß√£o parcial/em_andamento, hist√≥rico mant√©m TODAS as entradas anteriores (pub1, comp1, aval1, pub2...)
- **Justificativa:** Transpar√™ncia total - mostrar quantas tentativas foram necess√°rias
- **Impacto:** Timeline pode ficar longa em casos de m√∫ltiplas itera√ß√µes

### 4.8. M√≥dulo de Busca (RN-BUSCA)

**RN-BUSCA-01: Busca Case-Insensitive**
- **Descri√ß√£o:** Sistema ignora mai√∫sculas/min√∫sculas ao buscar texto
- **Justificativa:** Facilita uso - usu√°rio n√£o precisa saber capitaliza√ß√£o exata
- **Impacto:** Implementa√ß√£o usa .toLowerCase() em compara√ß√µes

**RN-BUSCA-02: Busca por Substring**
- **Descri√ß√£o:** Sistema encontra correspond√™ncias parciais, n√£o apenas palavras completas
- **Justificativa:** Usu√°rio pode buscar "Proc" e encontrar "Procuradoria"
- **Impacto:** Usa .includes() em vez de ===

**RN-BUSCA-03: Busca em Tempo Real**
- **Descri√ß√£o:** Resultados atualizam enquanto usu√°rio digita (sem delay > 300ms)
- **Justificativa:** Feedback imediato melhora UX
- **Impacto:** Event listener no input com debounce opcional

**RN-BUSCA-04: Busca Combinada (AND Logic)**
- **Descri√ß√£o:** Busca textual trabalha em conjunto com outros filtros (status, tags, tipo, etc.) usando l√≥gica AND
- **Justificativa:** Refinamento progressivo - m√∫ltiplos filtros estreitam resultados
- **Impacto:** Renderiza√ß√£o aplica todos os filtros sequencialmente

**RN-BUSCA-05: Contador de Resultados**
- **Descri√ß√£o:** Sistema exibe quantidade de registros encontrados ap√≥s aplicar filtros
- **Justificativa:** Feedback claro sobre efetividade da busca
- **Impacto:** Mensagem "X resultado(s) encontrado(s)" abaixo da tabela

**RN-BUSCA-06: Filtro de Status Processual**
- **Descri√ß√£o:** Dropdown permite filtrar por status[0]: pendente, aguardando_comprovacao, em_analise, encerrada
- **Justificativa:** Foco em fase espec√≠fica do workflow
- **Impacto:** Filtragem usa √≠ndice [0] do array bidimensional

**RN-BUSCA-07: Filtro de Valora√ß√£o**
- **Descri√ß√£o:** Dropdown permite filtrar por status[1]: nova, finalizada, parcial, em_andamento, prejudicada
- **Justificativa:** Foco em qualidade de cumprimento
- **Impacto:** Filtragem usa √≠ndice [1] do array bidimensional

**RN-BUSCA-08: Filtro de Tags**
- **Descri√ß√£o:** Dropdown com 11 tags pr√©-definidas permite filtrar proposi√ß√µes por categoria tem√°tica
- **Justificativa:** An√°lise tem√°tica - ex: ver todas proposi√ß√µes de 'tecnologia'
- **Impacto:** Filtragem verifica se tag selecionada est√° em proposicao.tags[]

**RN-BUSCA-09: Limpar Filtros**
- **Descri√ß√£o:** Bot√£o "Limpar Filtros" reseta TODOS os filtros para estado padr√£o (vazio/todos)
- **Justificativa:** Atalho para voltar √† vis√£o completa sem limpar campo por campo
- **Impacto:** JavaScript reseta valores de dropdowns e input de busca

**RN-BUSCA-10: Campos Espec√≠ficos por Contexto**
- **Descri√ß√£o:** Busca textual varia conforme contexto: correi√ß√µes busca em numero/ramoMP/tematica/numeroElo/tipo; proposi√ß√µes busca em numero/tipo/unidade/membro/descricao
- **Justificativa:** Relev√¢ncia - buscar nos campos que o usu√°rio espera
- **Impacto:** Fun√ß√£o de busca implementada separadamente em cada p√°gina

### 4.9. M√≥dulo de Exporta√ß√£o (RN-EXP)

**RN-EXP-01: Dois Formatos de Exporta√ß√£o**
- **Descri√ß√£o:** Sistema oferece exporta√ß√£o em JSON (dados estruturados) e PDF (documentos leg√≠veis)
- **Justificativa:** JSON para integra√ß√£o/backup; PDF para impress√£o/compartilhamento
- **Impacto:** Menus dropdown com 2+ op√ß√µes

**RN-EXP-02: JSON com Pretty-Print**
- **Descri√ß√£o:** Arquivos JSON s√£o exportados com indenta√ß√£o de 2 espa√ßos (pretty-print)
- **Justificativa:** Legibilidade em editores de texto
- **Impacto:** JSON.stringify() com par√¢metro indent=2

**RN-EXP-03: Metadados em Exporta√ß√µes**
- **Descri√ß√£o:** Todos os exports incluem: titulo, dataExportacao, usuario, filtrosAplicados (quando relevante)
- **Justificativa:** Contexto - saber quando foi exportado, por quem, e com quais filtros
- **Impacto:** Objeto raiz do JSON sempre tem esses campos

**RN-EXP-04: Exporta√ß√£o Respeita Filtros**
- **Descri√ß√£o:** Exporta√ß√£o captura estado atual da tabela/dashboard (com filtros aplicados), n√£o todos os dados
- **Justificativa:** Usu√°rio exporta o que est√° vendo
- **Impacto:** Fun√ß√µes de export usam dados filtrados, n√£o arrays globais

**RN-EXP-05: Nomenclatura de Arquivos**
- **Descri√ß√£o:** Arquivos exportados seguem padr√£o: `{tipo}-{data-ISO}.{ext}` (ex: dashboard-2025-12-10.json)
- **Justificativa:** Organiza√ß√£o - evita sobrescrever exports antigos
- **Impacto:** Nome de arquivo gerado dinamicamente com new Date().toISOString()

**RN-EXP-06: PDF com Cabe√ßalho Institucional**
- **Descri√ß√£o:** PDFs incluem header com "CONSELHO NACIONAL DO MINIST√âRIO P√öBLICO" e logo (placeholder)
- **Justificativa:** Identidade visual - documentos oficiais
- **Impacto:** HTML template para PDF inclui div.header

**RN-EXP-07: PDF Print-Optimized**
- **Descri√ß√£o:** PDFs usam @media print CSS para otimizar layout na impress√£o
- **Justificativa:** Margens, fontes e espa√ßamentos adequados para papel
- **Impacto:** Styles inline no HTML do PDF

**RN-EXP-08: Of√≠cio Formal (Times New Roman)**
- **Descri√ß√£o:** Exporta√ß√£o de of√≠cio de publica√ß√£o usa Times New Roman 12pt com line-height 1.8
- **Justificativa:** Padr√£o formal de documentos jur√≠dicos brasileiros
- **Impacto:** CSS espec√≠fico para este tipo de PDF

**RN-EXP-09: Timeline Colorida em PDFs**
- **Descri√ß√£o:** PDFs de relat√≥rios completos incluem timeline com cores: laranja (publicacao), azul (comprovacao), verde (avaliacao)
- **Justificativa:** Distin√ß√£o visual facilita leitura de hist√≥rico
- **Impacto:** Estilos CSS inline replicam cores da interface web

**RN-EXP-10: Valida√ß√£o Antes de Exportar**
- **Descri√ß√£o:** Sistema valida se h√° dados dispon√≠veis antes de exportar; exibe alert se vazio
- **Justificativa:** Evita exports in√∫teis (arquivos vazios)
- **Impacto:** if (!data.length) { alert(...); return; }

### 4.10. M√≥dulo de Hist√≥rico (RN-HIST)

**RN-HIST-01: Estrutura de Array**
- **Descri√ß√£o:** Hist√≥rico √© array de objetos (historico[]) em cada proposi√ß√£o
- **Justificativa:** Ordem cronol√≥gica natural; facilita itera√ß√£o
- **Impacto:** Renderiza√ß√£o usa .map() ou forEach()

**RN-HIST-02: Append-Only Pattern**
- **Descri√ß√£o:** Hist√≥rico nunca modifica entradas existentes - apenas adiciona novas (.push)
- **Justificativa:** Imutabilidade garante auditoria confi√°vel
- **Impacto:** C√≥digo NUNCA deve fazer historico[i] = ..., apenas historico.push(...)

**RN-HIST-03: Tr√™s Tipos de Entrada**
- **Descri√ß√£o:** Cada entrada tem campo 'tipo': 'publicacao', 'comprovacao', ou 'avaliacao'
- **Justificativa:** Diferencia natureza da intera√ß√£o
- **Impacto:** Renderiza√ß√£o condicional baseada em tipo

**RN-HIST-04: Campos Condicionais**
- **Descri√ß√£o:** Campos espec√≠ficos por tipo: arquivos[] (comprovacao), prazoComprovacao (publicacao), parecer (avaliacao)
- **Justificativa:** Evita campos irrelevantes em certos tipos
- **Impacto:** Valida√ß√£o de schema deve checar presen√ßa condicional

**RN-HIST-05: Timestamps ISO**
- **Descri√ß√£o:** Campo 'data' usa formato ISO 8601 (YYYY-MM-DDTHH:mm:ss.sssZ)
- **Justificativa:** Padr√£o internacional; preserva timezone
- **Impacto:** new Date().toISOString() ao criar entrada

**RN-HIST-06: Transi√ß√µes de Status**
- **Descri√ß√£o:** Entradas de publicacao e avaliacao incluem statusAnterior e statusNovo (arrays bidimensionais)
- **Justificativa:** Rastrear mudan√ßas de estado
- **Impacto:** Hist√≥rico permite reconstruir evolu√ß√£o completa de status

**RN-HIST-07: Ordem Cronol√≥gica**
- **Descri√ß√£o:** Entradas s√£o exibidas em ordem cronol√≥gica (mais antiga primeiro ou mais recente primeiro, conforme UX)
- **Justificativa:** Narrativa temporal l√≥gica
- **Impacto:** Timeline renderiza array na ordem ou com .reverse()

**RN-HIST-08: Usu√°rio Identificado**
- **Descri√ß√£o:** Cada entrada registra quem fez a a√ß√£o (campo 'usuario')
- **Justificativa:** Accountability - saber quem publicou/comprovou/avaliou
- **Impacto:** Valor √© 'Corregedoria Nacional' (admin) ou ramoMP+ramoMPNome (user)

**RN-HIST-09: Descri√ß√£o Textual**
- **Descri√ß√£o:** Campo 'descricao' cont√©m texto explicativo da a√ß√£o
- **Justificativa:** Legibilidade humana - entender a√ß√£o sem interpretar c√≥digo
- **Impacto:** Templates de texto: "Proposi√ß√£o publicada para...", "Comprova√ß√£o enviada por...", "Avalia√ß√£o: Finalizada"

**RN-HIST-10: Observa√ß√µes Opcionais**
- **Descri√ß√£o:** Campo 'observacoes' permite texto adicional (ou null)
- **Justificativa:** Contexto extra quando necess√°rio
- **Impacto:** Formul√°rios incluem textarea opcional; hist√≥rico renderiza se presente

### 4.11. M√≥dulo de Notifica√ß√µes (RN-NOTIF)

**RN-NOTIF-01: C√°lculo de Prazo Din√¢mico**
- **Descri√ß√£o:** Sistema calcula diferen√ßa entre hoje e prazoComprovacao em tempo real
- **Justificativa:** Alertas refletem urg√™ncia atual
- **Impacto:** Fun√ß√£o executada a cada renderiza√ß√£o

**RN-NOTIF-02: Alerta de Prazo Vencido**
- **Descri√ß√£o:** Se prazoComprovacao < hoje, exibe alerta vermelho "‚ö†Ô∏è PRAZO VENCIDO - Vencido h√° X dia(s)"
- **Justificativa:** Urg√™ncia m√°xima - a√ß√£o imediata necess√°ria
- **Impacto:** CSS background #dc3545 (vermelho), texto branco, √≠cone ‚ö†Ô∏è

**RN-NOTIF-03: Alerta de Prazo Pr√≥ximo**
- **Descri√ß√£o:** Se prazoComprovacao ‚â§ hoje+7dias, exibe alerta amarelo "‚è∞ PRAZO PR√ìXIMO - Faltam X dia(s)"
- **Justificativa:** Aviso antecipado - tempo de agir ainda dispon√≠vel
- **Impacto:** CSS background #ffc107 (amarelo), texto preto, √≠cone ‚è∞

**RN-NOTIF-04: Informa√ß√£o de Prazo Normal**
- **Descri√ß√£o:** Se prazoComprovacao > hoje+7dias, exibe info azul "Prazo: DD/MM/YYYY - Faltam X dia(s)"
- **Justificativa:** Informa√ß√£o tranquila - sem urg√™ncia
- **Impacto:** CSS background #0066cc (azul), texto branco

**RN-NOTIF-05: Contador de Prazo Vencido no Dashboard**
- **Descri√ß√£o:** Card "Prazo Vencido" no dashboard conta proposi√ß√µes com prazoComprovacao < hoje E status aguardando_comprovacao
- **Justificativa:** Vis√£o gerencial de atrasos
- **Impacto:** Fun√ß√£o filtra proposi√ß√µes por ambos crit√©rios

**RN-NOTIF-06: Destaque Visual em Tabelas**
- **Descri√ß√£o:** Linhas de proposi√ß√µes com prazo vencido t√™m background vermelho claro ou borda vermelha
- **Justificativa:** Identifica√ß√£o visual r√°pida
- **Impacto:** CSS class .prazo-vencido aplicada condicionalmente

**RN-NOTIF-07: √çcone de Rascunho**
- **Descri√ß√£o:** Proposi√ß√µes com rascunho salvo exibem √≠cone "üìù Rascunho" na lista
- **Justificativa:** Indicador de trabalho em progresso
- **Impacto:** Renderiza√ß√£o verifica proposicao.rascunhos.length > 0

**RN-NOTIF-08: Mensagens de Sucesso**
- **Descri√ß√£o:** Opera√ß√µes cr√≠ticas (publica√ß√£o, comprova√ß√£o, avalia√ß√£o) exibem alert() de confirma√ß√£o
- **Justificativa:** Feedback imediato ao usu√°rio
- **Impacto:** alert("Proposi√ß√£o publicada com sucesso!") ap√≥s salvar

**RN-NOTIF-09: Men√ß√£o de Email (Futura Integra√ß√£o)**
- **Descri√ß√£o:** Mensagens de sucesso mencionam "Email de notifica√ß√£o enviado automaticamente" (placeholder)
- **Justificativa:** Prepara√ß√£o para integra√ß√£o futura com sistema de email
- **Impacto:** Texto est√°tico por enquanto; backend implementar√° envio real

**RN-NOTIF-10: Contadores em Tempo Real**
- **Descri√ß√£o:** Badges e contadores (ex: "3 selecionada(s)") atualizam dinamicamente conforme a√ß√µes do usu√°rio
- **Justificativa:** Feedback imediato de estado
- **Impacto:** Event listeners chamam fun√ß√£o updateCounter() a cada mudan√ßa

---

## 5. Matriz de Rastreabilidade

Esta matriz mapeia os relacionamentos entre Requisitos Funcionais (RF-*), Casos de Uso (UC-*), Regras de Neg√≥cio (RN-*) e Entidades do Modelo de Dados (MD).

### 5.1. Mapeamento Requisito ‚Üí Caso de Uso

| Requisito | Casos de Uso Relacionados | Observa√ß√£o |
|-----------|---------------------------|------------|
| **RF-AUTH-001 a RF-AUTH-006** | UC-001 | Login e controle de acesso |
| **RF-DASH-001 a RF-DASH-007** | UC-002 | Dashboard com filtros e gr√°ficos |
| **RF-COR-001 a RF-COR-010** | UC-003, UC-009 | Cadastro e gest√£o de correi√ß√µes |
| **RF-PROP-001 a RF-PROP-012** | UC-004, UC-008 | Cadastro e gest√£o de proposi√ß√µes |
| **RF-PUB-001 a RF-PUB-010** | UC-005, UC-010 | Publica√ß√£o em lote e workflow |
| **RF-COMP-001 a RF-COMP-010** | UC-006, UC-010 | Submiss√£o de comprova√ß√µes |
| **RF-AVAL-001 a RF-AVAL-010** | UC-007, UC-010 | Avalia√ß√£o de comprova√ß√µes |
| **RF-BUSCA-001 a RF-BUSCA-010** | UC-008, UC-009 | Busca e filtros em tabelas |
| **RF-EXP-001 a RF-EXP-010** | UC-002, UC-008, UC-009 | Exporta√ß√µes JSON e PDF |
| **RF-HIST-001 a RF-HIST-010** | UC-005, UC-006, UC-007, UC-010 | Hist√≥rico de intera√ß√µes |
| **RF-NOTIF-001 a RF-NOTIF-010** | UC-002, UC-006, UC-008 | Alertas e notifica√ß√µes |

### 5.2. Mapeamento Requisito ‚Üí Regra de Neg√≥cio

| Requisito | Regras de Neg√≥cio | Descri√ß√£o do Relacionamento |
|-----------|-------------------|------------------------------|
| **RF-AUTH-001** | RN-AUTH-01, RN-AUTH-02 | Define perfis e autentica√ß√£o simplificada |
| **RF-AUTH-002** | RN-AUTH-04 | Controle de acesso por perfil |
| **RF-AUTH-003** | RN-AUTH-03 | Persist√™ncia de sess√£o em localStorage |
| **RF-DASH-001** | RN-DASH-01, RN-DASH-02 | Filtragem por correi√ß√£o com permiss√µes |
| **RF-DASH-002** | RN-DASH-03 | Contadores em tempo real |
| **RF-DASH-003** | RN-DASH-04, RN-DASH-05 | Gr√°ficos bidimensionais com auto-scale |
| **RF-COR-001** | RN-COR-01, RN-COR-02 | Status calculado automaticamente |
| **RF-COR-002** | RN-COR-03 | Sele√ß√£o de UF por tipo de MP |
| **RF-COR-003** | RN-COR-04 | Formato de n√∫mero ELO |
| **RF-COR-004** | RN-COR-05 | Tipos de correi√ß√£o padronizados |
| **RF-COR-007** | RN-COR-06, RN-COR-07 | Ordena√ß√£o e filtro de status |
| **RF-PROP-001** | RN-PROP-01 | V√≠nculo obrigat√≥rio com correi√ß√£o |
| **RF-PROP-002** | RN-PROP-02 | Status bidimensional |
| **RF-PROP-003** | RN-PROP-03 | Tipos de proposi√ß√£o |
| **RF-PROP-004** | RN-PROP-04 | Prazo de comprova√ß√£o |
| **RF-PROP-005** | RN-PROP-05 | Hist√≥rico append-only |
| **RF-PROP-006** | RN-PROP-06 | Tags categorizadas |
| **RF-PROP-007** | RN-PROP-07 | Prioridade com impacto visual |
| **RF-PROP-008** | RN-PROP-08 | Correi√ß√£o obrigat√≥ria na visualiza√ß√£o |
| **RF-PROP-012** | RN-PROP-09 | Edi√ß√£o de metadados (n√£o status) |
| **RF-PUB-001** | RN-PUB-01 | Apenas proposi√ß√µes pendentes |
| **RF-PUB-002** | RN-PUB-02, RN-PUB-10 | Republica√ß√£o de parcial/em_andamento |
| **RF-PUB-003** | RN-PUB-03 | Prazo √∫nico para lote |
| **RF-PUB-004** | RN-PUB-04, RN-PUB-05 | Sele√ß√£o obrigat√≥ria com confirma√ß√£o |
| **RF-PUB-005** | RN-PUB-06, RN-PUB-07 | Publica√ß√£o cria hist√≥rico e muda status |
| **RF-PUB-008** | RN-PUB-08 | Acesso administrativo exclusivo |
| **RF-PUB-009** | RN-PUB-09 | Sele√ß√£o de correi√ß√£o obrigat√≥ria |
| **RF-COMP-001** | RN-COMP-01, RN-COMP-02 | Apenas aguardando comprova√ß√£o |
| **RF-COMP-002** | RN-COMP-03 | M√∫ltiplos arquivos anexados |
| **RF-COMP-003** | RN-COMP-04, RN-COMP-05, RN-COMP-06 | Sistema de rascunhos |
| **RF-COMP-004** | RN-COMP-07, RN-COMP-08 | Submiss√£o muda status e cria hist√≥rico |
| **RF-COMP-007** | RN-COMP-09 | Submiss√£o ap√≥s prazo permitida |
| **RF-COMP-010** | RN-COMP-10 | Limite de caracteres |
| **RF-AVAL-001** | RN-AVAL-01 | Apenas em an√°lise |
| **RF-AVAL-002** | RN-AVAL-02, RN-AVAL-03 | Quatro decis√µes com parecer obrigat√≥rio |
| **RF-AVAL-003** | RN-AVAL-04, RN-AVAL-05 | Finalizada e prejudicada encerram |
| **RF-AVAL-004** | RN-AVAL-06, RN-AVAL-07, RN-AVAL-08 | Parcial/em_andamento voltam para pendente |
| **RF-AVAL-005** | RN-AVAL-09, RN-AVAL-10 | Avalia√ß√£o cria hist√≥rico preservado |
| **RF-BUSCA-001** | RN-BUSCA-01, RN-BUSCA-02, RN-BUSCA-03 | Busca textual case-insensitive em tempo real |
| **RF-BUSCA-002 a RF-BUSCA-005** | RN-BUSCA-04, RN-BUSCA-05, RN-BUSCA-10 | Filtros combinados com contador |
| **RF-BUSCA-006** | RN-BUSCA-06 | Filtro de status processual |
| **RF-BUSCA-007** | RN-BUSCA-07 | Filtro de valora√ß√£o |
| **RF-BUSCA-008** | RN-BUSCA-08 | Filtro de tags |
| **RF-BUSCA-010** | RN-BUSCA-09 | Limpar filtros |
| **RF-EXP-001 a RF-EXP-010** | RN-EXP-01 a RN-EXP-10 | Sistema completo de exporta√ß√£o |
| **RF-HIST-001 a RF-HIST-010** | RN-HIST-01 a RN-HIST-10 | Sistema de hist√≥rico audit√°vel |
| **RF-NOTIF-001 a RF-NOTIF-010** | RN-NOTIF-01 a RN-NOTIF-10 | Alertas e notifica√ß√µes din√¢micas |

### 5.3. Mapeamento Requisito ‚Üí Entidade do Modelo de Dados

| Requisito | Entidades (MD) | Campos Espec√≠ficos |
|-----------|----------------|-------------------|
| **RF-AUTH-001 a RF-AUTH-006** | Usuario | id, ramoMP, ramoMPNome, type, senha |
| **RF-DASH-001 a RF-DASH-007** | Correicao, Proposicao | (todos) - agrega√ß√£o de dados |
| **RF-COR-001 a RF-COR-010** | Correicao | id, numero, tematica, numeroElo, tipo, mp, uf, ramoMP, ramoMPNome, dataInicio, dataFim, status, observacoes |
| **RF-PROP-001 a RF-PROP-012** | Proposicao | id, numero, correicaoId, tipo, unidade, membro, descricao, prioridade, prazoComprovacao, dataPublicacao, status, tags, rascunhos, historico |
| **RF-PUB-001 a RF-PUB-010** | Proposicao | status, prazoComprovacao, dataPublicacao, historico |
| **RF-COMP-001 a RF-COMP-010** | Proposicao | status, rascunhos, historico |
| **RF-AVAL-001 a RF-AVAL-010** | Proposicao | status, historico |
| **RF-BUSCA-001 a RF-BUSCA-010** | Correicao, Proposicao | (campos de busca: numero, descricao, status, tags, etc.) |
| **RF-EXP-001 a RF-EXP-010** | Correicao, Proposicao | (todos) - serializa√ß√£o para JSON/PDF |
| **RF-HIST-001 a RF-HIST-010** | Proposicao | historico[] (array de HistoricoEntry) |
| **RF-NOTIF-001 a RF-NOTIF-010** | Proposicao | prazoComprovacao, status, rascunhos |

### 5.4. Mapeamento Caso de Uso ‚Üí Entidades Principais

| Caso de Uso | Entidades Leitura | Entidades Escrita | Opera√ß√µes Principais |
|-------------|-------------------|-------------------|----------------------|
| **UC-001** | Usuario | Usuario (sess√£o) | Login, valida√ß√£o, persist√™ncia de sess√£o |
| **UC-002** | Correicao, Proposicao | - | Filtros, agrega√ß√µes, renderiza√ß√£o de gr√°ficos |
| **UC-003** | - | Correicao | INSERT, UPDATE (metadados), calcularStatus |
| **UC-004** | Correicao | Proposicao | INSERT, v√≠nculo correicaoId |
| **UC-005** | Correicao, Proposicao (pendentes) | Proposicao | UPDATE status, INSERT historico (publicacao) |
| **UC-006** | Proposicao (aguardando) | Proposicao | UPDATE status, INSERT historico (comprovacao), CLEAR rascunhos |
| **UC-007** | Proposicao (em_analise) | Proposicao | UPDATE status, INSERT historico (avaliacao) |
| **UC-008** | Correicao, Proposicao | Proposicao | UPDATE metadados, filtros, busca |
| **UC-009** | Correicao | Correicao | Ordena√ß√£o, filtros, visualiza√ß√£o detalhada |
| **UC-010** | Correicao, Proposicao | Proposicao | Workflow completo (pub‚Üícomp‚Üíaval), m√∫ltiplas itera√ß√µes |

### 5.5. Mapeamento Regra de Neg√≥cio ‚Üí Impacto no C√≥digo

| Categoria | Regras | Arquivos Afetados | Fun√ß√µes Cr√≠ticas |
|-----------|--------|-------------------|------------------|
| **Autentica√ß√£o** | RN-AUTH-01 a RN-AUTH-04 | index.html (app.js), todas as p√°ginas standalone | login(), loadUserSession(), valida√ß√£o de perfil |
| **Dashboard** | RN-DASH-01 a RN-DASH-05 | index.html (app.js) | updateDashboard(), drawChart(), drawValoracaoChart(), filtrarDashboardPorCorreicao() |
| **Correi√ß√µes** | RN-COR-01 a RN-COR-07 | index.html (app.js) | calcularStatusCorreicao(), atualizarStatusCorreicoes(), toggleUFMultiple(), renderCorreicoesTable(), sortCorreicoesBy() |
| **Proposi√ß√µes** | RN-PROP-01 a RN-PROP-09 | index.html (app.js), proposicoes.html | cadastro handlers, renderProposicoesTable(), salvarEdicao(), getStatusProcessual(), getValoracao() |
| **Publica√ß√£o** | RN-PUB-01 a RN-PUB-10 | publicacao.html | carregarProposicoesParaPublicar(), publicarProposicoesSelecionadas(), onCorreicaoChange() |
| **Comprova√ß√£o** | RN-COMP-01 a RN-COMP-10 | index.html (app.js), comprovacao.html | populateProposicaoSelect(), submitComprovacao(), salvarRascunho(), setupFileUpload() |
| **Avalia√ß√£o** | RN-AVAL-01 a RN-AVAL-10 | index.html (app.js), avaliacao.html | renderAvaliacaoTable(), submitAvaliacao(), l√≥gica de status transitions |
| **Busca** | RN-BUSCA-01 a RN-BUSCA-10 | index.html (app.js), proposicoes.html, publicacao.html | renderProposicoesTable(), limparFiltros(), event listeners de filtros |
| **Exporta√ß√£o** | RN-EXP-01 a RN-EXP-10 | index.html (app.js), proposicoes.html, publicacao.html | exportarDashboardJSON(), exportarDashboardPDF(), exportarCorreicoesJSON(), exportarOficioPublicacao(), etc. |
| **Hist√≥rico** | RN-HIST-01 a RN-HIST-10 | index.html (app.js), avaliacao.html, comprovacao.html | viewDetails(), renderHistorico(), submitComprovacao(), submitAvaliacao(), publicarProposicoesSelecionadas() |
| **Notifica√ß√µes** | RN-NOTIF-01 a RN-NOTIF-10 | index.html (app.js), comprovacao.html | renderPrazoAlert(), updateDashboard(), renderiza√ß√£o condicional de alertas |

### 5.6. Cobertura de Requisitos por Caso de Uso

| Caso de Uso | Requisitos Cobertos | Total | Percentual |
|-------------|---------------------|-------|------------|
| **UC-001: Login** | RF-AUTH-001 a RF-AUTH-006 | 6 | 5.7% |
| **UC-002: Dashboard** | RF-DASH-001 a RF-DASH-007, RF-EXP-001, RF-EXP-002, RF-NOTIF-005 | 10 | 9.5% |
| **UC-003: Cadastrar Correi√ß√£o** | RF-COR-001 a RF-COR-006 | 6 | 5.7% |
| **UC-004: Cadastrar Proposi√ß√£o** | RF-PROP-001 a RF-PROP-007 | 7 | 6.7% |
| **UC-005: Publicar Proposi√ß√µes** | RF-PUB-001 a RF-PUB-010, RF-HIST-001, RF-HIST-002, RF-HIST-006, RF-NOTIF-008 | 14 | 13.3% |
| **UC-006: Enviar Comprova√ß√£o** | RF-COMP-001 a RF-COMP-010, RF-HIST-001, RF-HIST-002, RF-HIST-008, RF-NOTIF-001 a RF-NOTIF-004, RF-NOTIF-007 | 19 | 18.1% |
| **UC-007: Avaliar Comprova√ß√£o** | RF-AVAL-001 a RF-AVAL-010, RF-HIST-001, RF-HIST-002, RF-HIST-009 | 13 | 12.4% |
| **UC-008: Gerenciar Proposi√ß√µes** | RF-PROP-008 a RF-PROP-012, RF-BUSCA-001 a RF-BUSCA-010, RF-EXP-005, RF-EXP-006, RF-HIST-001 | 17 | 16.2% |
| **UC-009: Gerenciar Correi√ß√µes** | RF-COR-007 a RF-COR-010, RF-BUSCA-001, RF-BUSCA-002, RF-EXP-003, RF-EXP-004 | 8 | 7.6% |
| **UC-010: Ciclo Completo** | RF-PUB-*, RF-COMP-*, RF-AVAL-*, RF-HIST-*, RF-NOTIF-* (integra√ß√£o) | 50+ | 47.6% |
| **TOTAL** | 105 requisitos | 105 | 100% |

**Observa√ß√£o:** UC-010 √© um caso de uso integrador que combina m√∫ltiplos workflows (UC-005, UC-006, UC-007) em um ciclo iterativo completo, portanto h√° sobreposi√ß√£o intencional na contagem.

### 5.7. Matriz de Depend√™ncias Entre Requisitos

| Requisito Base | Requisitos Dependentes | Tipo de Depend√™ncia |
|----------------|------------------------|---------------------|
| **RF-AUTH-001** | RF-DASH-001, RF-PUB-008, RF-AVAL-001 | Controle de acesso (pr√©-requisito) |
| **RF-COR-001** | RF-PROP-001 | V√≠nculo obrigat√≥rio correi√ß√£o‚Üíproposi√ß√£o |
| **RF-PROP-002** | RF-BUSCA-006, RF-BUSCA-007, RF-DASH-003 | Status bidimensional afeta filtros e gr√°ficos |
| **RF-PROP-005** | RF-HIST-001 a RF-HIST-010 | Hist√≥rico depende de array em proposi√ß√£o |
| **RF-PUB-001** | RF-COMP-001 | Publica√ß√£o √© gateway para comprova√ß√£o |
| **RF-PUB-005** | RF-COMP-004, RF-AVAL-001 | Publica√ß√£o muda status que afeta filas |
| **RF-COMP-004** | RF-AVAL-001 | Comprova√ß√£o muda status para fila de avalia√ß√£o |
| **RF-AVAL-004** | RF-PUB-002 | Avalia√ß√£o parcial/em_andamento retorna para publica√ß√£o |
| **RF-HIST-002** | RF-PUB-006, RF-COMP-008, RF-AVAL-009 | Append-only pattern usado em todas as intera√ß√µes |
| **RF-BUSCA-004** | RF-BUSCA-001 a RF-BUSCA-009 | Busca combinada depende de todos os filtros |

### 5.8. Rastreabilidade de Regras de Neg√≥cio Cr√≠ticas

| Regra Cr√≠tica | Requisitos | Casos de Uso | Entidades | Valida√ß√£o |
|---------------|------------|--------------|-----------|-----------|
| **RN-PUB-01** | RF-PUB-001 | UC-005, UC-010 | Proposicao.status | DEVE filtrar status=['pendente', *] |
| **RN-COMP-02** | RF-COMP-001 | UC-006, UC-010 | Proposicao.status | DEVE bloquear se status‚â†'aguardando_comprovacao' |
| **RN-HIST-02** | RF-HIST-002, RF-PUB-006, RF-COMP-008, RF-AVAL-009 | UC-005, UC-006, UC-007, UC-010 | Proposicao.historico | NUNCA editar elementos existentes |
| **RN-AVAL-06, RN-AVAL-07** | RF-AVAL-004 | UC-007, UC-010 | Proposicao.status | DEVE mudar status[0]='pendente' se valoracao=parcial/em_andamento |
| **RN-COR-01** | RF-COR-001, RF-COR-002 | UC-003, UC-009 | Correicao.status | DEVE recalcular ap√≥s mudan√ßas em proposi√ß√µes |
| **RN-PROP-01** | RF-PROP-001 | UC-004, UC-008 | Proposicao.correicaoId | DEVE validar FK antes de salvar |
| **RN-AUTH-04** | RF-AUTH-002, RF-PUB-008 | UC-001, UC-005 | Usuario.type | DEVE redirecionar n√£o-admins |
| **RN-DASH-02** | RF-DASH-001 | UC-002 | Correicao, Usuario | DEVE filtrar por ramoMP se user |
| **RN-PUB-10** | RF-PUB-002 | UC-005, UC-010 | Proposicao.status | DEVE preservar valora√ß√£o ao republicar |
| **RN-COMP-09** | RF-COMP-007 | UC-006 | Proposicao.prazoComprovacao | DEVE permitir submit mesmo se vencido |

### 5.9. √çndice de Requisitos N√£o Funcionais Impl√≠citos

Embora este documento trate de Requisitos Funcionais, algumas regras de neg√≥cio implicam em requisitos n√£o funcionais que devem ser considerados na implementa√ß√£o:

| RN | Requisito N√£o Funcional Impl√≠cito | Categoria |
|----|-----------------------------------|-----------|
| **RN-BUSCA-03** | Busca deve responder em < 300ms | Performance |
| **RN-DASH-03** | Atualiza√ß√£o de dashboard em < 1s | Performance |
| **RN-HIST-02** | Imutabilidade de hist√≥rico | Seguran√ßa/Auditoria |
| **RN-AUTH-02** | Sistema requer autentica√ß√£o corporativa em produ√ß√£o | Seguran√ßa |
| **RN-EXP-02** | Arquivos JSON leg√≠veis (pretty-print) | Usabilidade |
| **RN-EXP-07** | PDFs otimizados para impress√£o | Usabilidade |
| **RN-NOTIF-01** | C√°lculo de prazo em tempo real | Performance |
| **RN-COMP-10, RN-AVAL-03** | Limites de caracteres | Usabilidade/Performance |
| **RN-AUTH-03** | Persist√™ncia de sess√£o entre navega√ß√µes | Usabilidade |
| **RN-HIST-05** | Timestamps com timezone | Interoperabilidade |

---

**Fim da Parte 2.6**

Esta matriz de rastreabilidade garante:
- ‚úÖ **100% dos 105 requisitos** est√£o mapeados para casos de uso
- ‚úÖ **Todas as 110 regras de neg√≥cio** est√£o vinculadas a requisitos
- ‚úÖ **Todas as entidades do modelo de dados** est√£o cobertas
- ‚úÖ **Depend√™ncias cr√≠ticas** est√£o documentadas
- ‚úÖ **Valida√ß√µes obrigat√≥rias** est√£o identificadas

Esta documenta√ß√£o completa serve como base para:
1. **Desenvolvimento:** Implementa√ß√£o de novos requisitos
2. **Testes:** Cria√ß√£o de casos de teste baseados em requisitos
3. **Manuten√ß√£o:** An√°lise de impacto de mudan√ßas
4. **Auditoria:** Verifica√ß√£o de conformidade com requisitos

---

---

**Fim da Parte 2.3**

---

**Fim da Parte 2.4**

---

**Status da Documenta√ß√£o:**
- ‚úÖ **Parte 2.1 (COMPLETA):** Introdu√ß√£o, RF-AUTH (6 requisitos), RF-DASH (7 requisitos)
- ‚úÖ **Parte 2.2 (COMPLETA):** RF-COR (10 requisitos), RF-PROP (12 requisitos)
- ‚úÖ **Parte 2.3 (COMPLETA):** RF-PUB (10 requisitos), RF-COMP (10 requisitos), RF-AVAL (10 requisitos)
- ‚úÖ **Parte 2.4 (COMPLETA):** RF-BUSCA (10 requisitos), RF-EXP (10 requisitos), RF-HIST (10 requisitos), RF-NOTIF (10 requisitos)
- ‚úÖ **Parte 2.5 (COMPLETA):** Casos de Uso Detalhados (10 casos de uso principais)
- ‚úÖ **Parte 2.6 (COMPLETA):** Regras de Neg√≥cio Consolidadas (110 regras em 11 m√≥dulos) e Matriz de Rastreabilidade (9 tabelas de mapeamento)

**Total documentado:**
- **105 requisitos funcionais** (13 em 2.1 + 22 em 2.2 + 30 em 2.3 + 40 em 2.4)
- **10 casos de uso detalhados** (UC-001 a UC-010)
- **110 regras de neg√≥cio consolidadas** (RN-AUTH, RN-DASH, RN-COR, RN-PROP, RN-PUB, RN-COMP, RN-AVAL, RN-BUSCA, RN-EXP, RN-HIST, RN-NOTIF)
- **9 matrizes de rastreabilidade** (requisito‚Üícaso de uso, requisito‚Üíregra de neg√≥cio, requisito‚Üíentidade, caso de uso‚Üíentidade, regra‚Üíimpacto no c√≥digo, cobertura de requisitos, depend√™ncias entre requisitos, rastreabilidade de regras cr√≠ticas, requisitos n√£o funcionais impl√≠citos)

---

**üéâ DOCUMENTA√á√ÉO COMPLETA**

Este documento de Especifica√ß√£o de Requisitos Funcionais est√° **100% completo** e pronto para uso nas seguintes atividades:

1. **Desenvolvimento:** Implementa√ß√£o de todos os 105 requisitos com base em especifica√ß√µes detalhadas
2. **Testes:** Cria√ß√£o de casos de teste baseados em requisitos, casos de uso e regras de neg√≥cio
3. **Manuten√ß√£o:** An√°lise de impacto de mudan√ßas usando matriz de rastreabilidade
4. **Auditoria:** Verifica√ß√£o de conformidade com requisitos funcionais e regras de neg√≥cio
5. **Capacita√ß√£o:** Treinamento de novos membros da equipe usando casos de uso detalhados
6. **Gest√£o de Projeto:** Planejamento de sprints e aloca√ß√£o de recursos por m√≥dulo funcional

**Pr√≥ximos passos sugeridos:**
- Revisar e validar a documenta√ß√£o com stakeholders (Corregedoria Nacional e MPs correicionados)
- Priorizar requisitos para implementa√ß√£o em fases (MVP ‚Üí features avan√ßadas)
- Criar backlog de produto estruturado por m√≥dulos (RF-AUTH, RF-DASH, RF-COR, etc.)
- Desenvolver prot√≥tipo de alta fidelidade baseado nos casos de uso documentados
