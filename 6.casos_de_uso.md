# Casos de Uso e Histórias de Usuário
## Sistema de Acompanhamento de Proposições - CNMP

**Versão:** 1.0
**Data:** 11/12/2025
**Projeto:** Sistema NAD - Núcleo de Acompanhamento de Decisões
**Organização:** Conselho Nacional do Ministério Público (CNMP)

---

## Histórico de Revisões

| Versão | Data | Autor | Descrição |
|--------|------|-------|-----------|
| 1.0 | 11/12/2025 | Análise de Requisitos | Parte 6.1 - Introdução, Personas e Casos de Uso (UC-001 a UC-008) |

---

## Sumário

1. [Introdução](#1-introdução)
2. [Personas do Sistema](#2-personas-do-sistema)
3. [Casos de Uso - Autenticação e Navegação](#3-casos-de-uso---autenticação-e-navegação)
4. [Casos de Uso - Gestão de Correições](#4-casos-de-uso---gestão-de-correições)
5. [Casos de Uso - Gestão de Proposições](#5-casos-de-uso---gestão-de-proposições) *(A elaborar na Parte 6.2)*
6. [Casos de Uso - Publicação](#6-casos-de-uso---publicação) *(A elaborar na Parte 6.2)*
7. [Casos de Uso - Comprovação](#7-casos-de-uso---comprovação) *(A elaborar na Parte 6.2)*
8. [Casos de Uso - Avaliação](#8-casos-de-uso---avaliação) *(A elaborar na Parte 6.3)*
9. [Casos de Uso - Consultas e Relatórios](#9-casos-de-uso---consultas-e-relatórios) *(A elaborar na Parte 6.3)*
10. [Histórias de Usuário](#10-histórias-de-usuário) *(A elaborar na Parte 6.3)*
11. [Matriz de Rastreabilidade](#11-matriz-de-rastreabilidade) *(A elaborar na Parte 6.3)*

---

## 1. Introdução

### 1.1 Propósito do Documento

Este documento descreve os **casos de uso** e **histórias de usuário** do Sistema de Acompanhamento de Proposições do CNMP. O objetivo é documentar de forma clara e completa:

- **Cenários de utilização:** Como diferentes usuários interagem com o sistema
- **Fluxos de trabalho:** Sequências de ações para alcançar objetivos específicos
- **Critérios de aceite:** Condições que devem ser satisfeitas para considerar uma funcionalidade implementada
- **Regras de negócio:** Políticas e restrições que governam o comportamento do sistema

### 1.2 Metodologia

**Casos de Uso (Use Cases):**
- Formato estruturado com fluxos principal e alternativos
- Identificadores únicos (UC-XXX)
- Pré-condições, pós-condições e critérios de aceite
- Baseado em UML/RUP adaptado para documentação markdown

**Histórias de Usuário (User Stories):**
- Formato ágil: "Como [persona], eu quero [ação], para que [benefício]"
- Critérios de aceite no formato Given/When/Then
- Pontos de história (estimativa de complexidade)
- Prioridade MoSCoW (Must/Should/Could/Won't)

### 1.3 Público-Alvo

- **Analistas de Negócio:** Compreender requisitos funcionais
- **Desenvolvedores:** Implementar funcionalidades com clareza de requisitos
- **Testadores:** Criar casos de teste baseados em critérios de aceite
- **Product Owners:** Priorizar backlog e validar entregas
- **Stakeholders:** Entender escopo e capacidades do sistema

### 1.4 Escopo

Este documento cobre:
- ✅ **32 casos de uso detalhados** organizados por módulo funcional
- ✅ **4 personas principais** representando diferentes perfis de usuário
- ✅ **User stories** no formato ágil com estimativas
- ✅ **Critérios de aceite** claros e testáveis
- ✅ **Matriz de rastreabilidade** entre requisitos, casos de uso e funcionalidades

---

## 2. Personas do Sistema

### 2.1 Persona 1: Dr. Ricardo Almeida - Corregedor Nacional

**Perfil:**
- **Cargo:** Corregedor Nacional do Ministério Público
- **Idade:** 58 anos
- **Formação:** Doutor em Direito Público
- **Experiência:** 30 anos no Ministério Público
- **Tipo de usuário no sistema:** Admin

**Contexto:**
- Responsável por conduzir correições ordinárias e extraordinárias nos 27 MPs brasileiros
- Precisa acompanhar o cumprimento de determinações e recomendações emitidas
- Toma decisões finais sobre avaliação de comprovações
- Demanda visão consolidada de múltiplas correições simultaneamente

**Objetivos com o Sistema:**
- ✅ Cadastrar novas correições com facilidade
- ✅ Publicar determinações e recomendações em lote para os órgãos correicionados
- ✅ Acompanhar status de cumprimento em tempo real via dashboard
- ✅ Avaliar comprovações submetidas pelos MPs
- ✅ Gerar relatórios para tomada de decisão e prestação de contas
- ✅ Identificar rapidamente prazos vencidos e pendências críticas

**Frustrações:**
- ⚠️ Processos manuais com planilhas e e-mails difusos
- ⚠️ Falta de visibilidade consolidada do andamento das correições
- ⚠️ Dificuldade em rastrear histórico de interações com cada MP

**Citação:**
> "Preciso de um sistema que me permita acompanhar, de forma clara e centralizada, o cumprimento das determinações que emitimos nas correições. O controle atual é fragmentado e dificulta a tomada de decisões estratégicas."

---

### 2.2 Persona 2: Dra. Mariana Santos - Assessora da Corregedoria Nacional

**Perfil:**
- **Cargo:** Assessora Técnica da Corregedoria Nacional
- **Idade:** 35 anos
- **Formação:** Mestre em Direito Processual
- **Experiência:** 10 anos no CNMP
- **Tipo de usuário no sistema:** Admin

**Contexto:**
- Auxilia o Corregedor Nacional na gestão operacional das correições
- Responsável por cadastrar proposições, organizar documentação e preparar pareceres preliminares
- Interface direta com os órgãos correicionados
- Atua na triagem de comprovações antes da avaliação final do Corregedor

**Objetivos com o Sistema:**
- ✅ Cadastrar correições e proposições de forma ágil e estruturada
- ✅ Organizar e categorizar proposições por tags (tecnologia, administrativo, etc.)
- ✅ Preparar publicações em lote otimizando o trabalho repetitivo
- ✅ Revisar comprovações recebidas e preparar rascunhos de avaliação
- ✅ Manter histórico completo e organizado de todas as interações
- ✅ Exportar dados para relatórios e apresentações

**Frustrações:**
- ⚠️ Trabalho repetitivo de publicação individual de proposições
- ⚠️ Falta de padronização no recebimento de comprovações
- ⚠️ Dificuldade em rastrear proposições que já passaram por múltiplos ciclos de avaliação

**Citação:**
> "Gerencio dezenas de proposições simultaneamente. Preciso de um sistema que organize tudo de forma clara, permita trabalho em lote e mantenha um histórico completo de cada proposição."

---

### 2.3 Persona 3: Dr. Fernando Costa - Procurador-Geral de Justiça

**Perfil:**
- **Cargo:** Procurador-Geral de Justiça do MPBA
- **Idade:** 52 anos
- **Formação:** Doutor em Direito Constitucional
- **Experiência:** 25 anos no Ministério Público
- **Tipo de usuário no sistema:** User

**Contexto:**
- Lidera o Ministério Público Estadual da Bahia
- Responsável institucional pelo cumprimento de determinações da Corregedoria Nacional
- Coordena equipe para preparação de comprovações
- Precisa garantir conformidade e evitar responsabilização do órgão

**Objetivos com o Sistema:**
- ✅ Visualizar todas as proposições direcionadas ao MPBA
- ✅ Acompanhar prazos de comprovação e evitar vencimentos
- ✅ Delegar preparação de comprovações para promotores responsáveis
- ✅ Revisar e aprovar comprovações antes do envio final
- ✅ Ter visibilidade do histórico de avaliações recebidas
- ✅ Demonstrar transparência e comprometimento com a Corregedoria

**Frustrações:**
- ⚠️ Desconhecimento de prazos e proposições pendentes
- ⚠️ Falta de comunicação clara sobre o que foi solicitado
- ⚠️ Dificuldade em rastrear se comprovações foram aceitas ou rejeitadas

**Citação:**
> "Preciso ter controle total sobre as determinações que recebemos e garantir que nossa equipe cumpra tudo dentro do prazo. A transparência com a Corregedoria Nacional é fundamental."

---

### 2.4 Persona 4: Dr. João Silva - Promotor de Justiça

**Perfil:**
- **Cargo:** Promotor de Justiça em Cachoeira/BA
- **Idade:** 38 anos
- **Formação:** Especialista em Direito Ambiental
- **Experiência:** 12 anos como Promotor
- **Tipo de usuário no sistema:** User

**Contexto:**
- Atua em comarca do interior
- Designado para preparar comprovações de proposições específicas relacionadas à sua área
- Reporta ao Procurador-Geral de Justiça
- Precisa conciliar atividades de comprovação com atribuições processuais diárias

**Objetivos com o Sistema:**
- ✅ Ver claramente quais proposições estão sob sua responsabilidade
- ✅ Entender o que precisa ser comprovado (descrição, prazo, anexos necessários)
- ✅ Salvar rascunhos de comprovação enquanto reúne documentos
- ✅ Enviar comprovação com anexos de forma simples e direta
- ✅ Receber feedback sobre avaliação das comprovações submetidas
- ✅ Trabalhar de forma mobile-friendly (acesso de qualquer lugar)

**Frustrações:**
- ⚠️ Falta de clareza sobre o que é esperado na comprovação
- ⚠️ Interfaces complexas que demandam tempo para aprender
- ⚠️ Impossibilidade de salvar progresso e retomar depois

**Citação:**
> "Meu dia é corrido com audiências e prazos processuais. Quando preciso enviar uma comprovação, quero algo rápido e direto, sem complicações. Preciso salvar meu progresso e voltar depois."

---

## 3. Casos de Uso - Autenticação e Navegação

### UC-001: Realizar Login no Sistema

**Ator Principal:** Corregedor Nacional, Assessor, Procurador-Geral, Promotor

**Objetivo:** Autenticar-se no sistema e acessar funcionalidades de acordo com o perfil.

**Pré-condições:**
- Sistema disponível e acessível via navegador moderno
- Usuário possui credenciais válidas (username/senha)
- Usuário conhece seu perfil (Admin ou User) e ramo do MP (se User)

**Fluxo Principal:**

1. Usuário acessa a URL do sistema (index.html)
2. Sistema exibe tela de login com campos:
   - Username
   - Senha
   - Tipo de usuário (Admin ou User)
   - Ramo do MP (se User)
3. Usuário preenche username e senha
4. Usuário seleciona tipo de usuário:
   - Se "Admin" → sistema oculta campo "Ramo do MP"
   - Se "User" → sistema exibe dropdown "Ramo do MP"
5. Usuário seleciona ramo do MP (se User)
6. Usuário clica em "Entrar"
7. Sistema **aceita qualquer credencial** (protótipo sem autenticação real)
8. Sistema armazena sessão em `localStorage`:
   ```json
   {
     "username": "ricardo.almeida",
     "type": "admin",
     "ramoMP": null
   }
   ```
9. Sistema redireciona para Dashboard
10. Sistema exibe menu lateral com opções disponíveis para o perfil

**Fluxos Alternativos:**

**FA-1: Login como User**
- 4a. Usuário seleciona "User"
- 4b. Sistema habilita campo "Ramo do MP"
- 4c. Usuário seleciona MP (ex: "MPBA - Ministério Público do Estado da Bahia")
- 4d. Sistema armazena `ramoMP` na sessão
- 4e. Sistema filtra visualizações por ramo do MP

**FA-2: Sessão Existente**
- 1a. Usuário já tem sessão ativa em `localStorage`
- 1b. Sistema carrega sessão automaticamente
- 1c. Sistema redireciona direto para Dashboard
- 1d. Caso de uso termina

**Pós-condições:**
- ✅ Usuário autenticado no sistema
- ✅ Sessão armazenada em `localStorage`
- ✅ Menu lateral exibe opções corretas para o perfil
- ✅ Dashboard carregado e filtrado conforme permissões

**Critérios de Aceite:**

**CA-1: Seleção de perfil**
- [ ] Campo "Tipo de usuário" possui exatamente 2 opções: Admin e User
- [ ] Seleção de "Admin" oculta campo "Ramo do MP"
- [ ] Seleção de "User" exibe dropdown "Ramo do MP" com 27 MPs

**CA-2: Validação de campos obrigatórios**
- [ ] Username vazio → sistema impede login
- [ ] Senha vazia → sistema impede login
- [ ] Tipo de usuário não selecionado → sistema impede login
- [ ] User sem ramo do MP selecionado → sistema impede login

**CA-3: Persistência de sessão**
- [ ] Dados da sessão salvos em `localStorage` com chave `currentUser`
- [ ] Refresh da página (F5) mantém sessão ativa
- [ ] Fechar navegador e reabrir recupera sessão

**CA-4: Controle de acesso por perfil**
- [ ] Admin vê menu: Dashboard, Correições, Proposições, Publicar, Avaliar, Cadastros
- [ ] User vê menu: Dashboard, Correições, Proposições, Enviar Comprovação
- [ ] User NÃO vê: Publicar Proposições, Avaliar Comprovações, Cadastros

**Regras de Negócio:**

**RN-001:** No protótipo atual, **qualquer username/senha é aceito**. Em produção, validação deve ser implementada via backend com autenticação JWT.

**RN-002:** Usuários do tipo "User" **só visualizam dados do seu ramo do MP**. Filtros automáticos aplicados em todas as consultas.

**RN-003:** Usuários do tipo "Admin" **visualizam dados de todos os MPs** sem restrição.

**RN-004:** Sessão **não expira automaticamente** no protótipo. Em produção, implementar expiração de 8 horas.

---

### UC-002: Navegar pelo Sistema

**Ator Principal:** Todos os usuários autenticados

**Objetivo:** Acessar diferentes módulos e páginas do sistema através do menu lateral.

**Pré-condições:**
- Usuário autenticado no sistema (UC-001)
- Menu lateral visível na interface

**Fluxo Principal:**

1. Usuário visualiza menu lateral com opções disponíveis
2. Usuário clica em item do menu (ex: "Correições")
3. Sistema identifica tipo de navegação:
   - **Páginas internas (SPA):** Dashboard, Correições, Enviar, Avaliar, Cadastros
   - **Páginas standalone:** Proposições, Publicar Proposições, Avaliação, Comprovação
4. Se página interna:
   - 4a. Sistema executa `showPage(pageId)`
   - 4b. Sistema oculta todas as páginas (`.hidden`)
   - 4c. Sistema exibe apenas página selecionada
   - 4d. Hash da URL atualizada (#dashboard, #correicoes, etc.)
5. Se página standalone:
   - 5a. Sistema redireciona para HTML externo (`window.location.href`)
   - 5b. Nova página carrega dados de `localStorage`
   - 5c. Nova página executa auto-login com sessão salva
6. Sistema atualiza indicador visual do item ativo no menu

**Fluxos Alternativos:**

**FA-1: Navegação com breadcrumb**
- 1a. Usuário está em página standalone (ex: proposicoes.html)
- 1b. Usuário clica em breadcrumb "← Voltar ao Dashboard"
- 1c. Sistema redireciona para `index.html`
- 1d. Caso de uso termina

**FA-2: Navegação direta via URL**
- 1a. Usuário digita URL diretamente (ex: `index.html#correicoes`)
- 1b. Sistema detecta hash na URL
- 1c. Sistema executa `showPage('correicoes')` automaticamente
- 1d. Caso de uso termina

**FA-3: Acesso a funcionalidade restrita**
- 2a. User tenta acessar "Avaliar Comprovações" (somente admin)
- 2b. Sistema verifica `currentUser.type !== 'admin'`
- 2c. Sistema exibe alerta: "⚠️ Acesso negado. Funcionalidade exclusiva para administradores."
- 2d. Sistema mantém usuário na página atual
- 2e. Caso de uso termina

**Pós-condições:**
- ✅ Página solicitada exibida na tela
- ✅ Dados carregados corretamente
- ✅ Menu lateral atualizado com item ativo destacado
- ✅ URL reflete página atual (hash ou arquivo HTML)

**Critérios de Aceite:**

**CA-1: Menu lateral responsivo**
- [ ] Desktop (>768px): menu fixo à esquerda, sempre visível
- [ ] Mobile (≤768px): menu oculto, aparece ao clicar em ícone hamburger
- [ ] Item ativo destacado visualmente (cor diferente ou negrito)

**CA-2: Navegação SPA (index.html)**
- [ ] Transição entre páginas internas é instantânea (sem reload)
- [ ] URL hash atualizada corretamente (#dashboard, #correicoes, #enviar, #avaliar, #cadastroCorreicao, #cadastro)
- [ ] Botão "Voltar" do navegador funciona corretamente com histórico de hash

**CA-3: Navegação standalone**
- [ ] Redirecionamento para proposicoes.html funciona
- [ ] Redirecionamento para publicacao.html funciona (admin only)
- [ ] Redirecionamento para avaliacao.html funciona (admin only)
- [ ] Redirecionamento para comprovacao.html funciona
- [ ] Cada página standalone carrega sessão de `localStorage`

**CA-4: Controle de acesso**
- [ ] User não consegue acessar "Publicar Proposições"
- [ ] User não consegue acessar "Avaliar Comprovações"
- [ ] User não consegue acessar "Cadastrar Correição"
- [ ] User não consegue acessar "Cadastrar Proposição"
- [ ] Admin acessa todas as funcionalidades

**Regras de Negócio:**

**RN-005:** Navegação deve ser **consistente** entre SPA e páginas standalone. Usuário não deve perceber diferença na experiência.

**RN-006:** Breadcrumbs em páginas standalone devem **sempre apontar para index.html**, nunca para páginas intermediárias.

**RN-007:** Menu lateral deve **ocultar** itens restritos para Users, não apenas desabilitá-los (segurança por obscuridade).

---

### UC-003: Realizar Logout

**Ator Principal:** Todos os usuários autenticados

**Objetivo:** Encerrar sessão e limpar dados de autenticação.

**Pré-condições:**
- Usuário autenticado no sistema

**Fluxo Principal:**

1. Usuário clica em botão "Sair" no menu de usuário
2. Sistema solicita confirmação: "Deseja realmente sair?"
3. Usuário confirma
4. Sistema executa função `logout()`:
   - Remove `currentUser` de `localStorage`
   - Limpa variável global `currentUser = null`
   - Oculta todas as páginas internas
   - Exibe tela de login
5. Sistema exibe mensagem: "✅ Logout realizado com sucesso."

**Fluxos Alternativos:**

**FA-1: Cancelar logout**
- 3a. Usuário clica em "Cancelar" no diálogo de confirmação
- 3b. Sistema mantém usuário autenticado
- 3c. Sistema permanece na página atual
- 3d. Caso de uso termina

**FA-2: Logout automático (timeout - futuro)**
- 1a. Sistema detecta inatividade de 8 horas
- 1b. Sistema exibe alerta: "⚠️ Sessão expirada por inatividade."
- 1c. Sistema executa logout automaticamente
- 1d. Caso de uso termina

**Pós-condições:**
- ✅ Sessão encerrada
- ✅ `localStorage.currentUser` removido
- ✅ Tela de login exibida
- ✅ Dados sensíveis em memória limpos

**Critérios de Aceite:**

**CA-1: Confirmação de logout**
- [ ] Sistema exibe diálogo de confirmação antes de executar logout
- [ ] Botão "Confirmar" executa logout
- [ ] Botão "Cancelar" mantém sessão ativa

**CA-2: Limpeza de dados**
- [ ] `localStorage.currentUser` é removido
- [ ] Variável global `currentUser` definida como `null`
- [ ] Menu lateral volta ao estado inicial (sem itens destacados)

**CA-3: Redirecionamento**
- [ ] Após logout, sistema exibe tela de login
- [ ] Tentativa de acessar página interna redireciona para login
- [ ] URL resetada para raiz (index.html, sem hash)

**CA-4: Segurança**
- [ ] Dados de correções e proposições permanecem em `localStorage` (não são limpos)
- [ ] Apenas dados de sessão são removidos
- [ ] Novo login permite acesso aos dados previamente salvos

**Regras de Negócio:**

**RN-008:** Logout **não deve limpar** dados de correções e proposições armazenados em `localStorage`, apenas dados de sessão.

**RN-009:** Após logout, **qualquer tentativa de navegação** deve redirecionar para tela de login.

**RN-010:** Em produção, implementar **logout server-side** invalidando token JWT.

---

## 4. Casos de Uso - Gestão de Correições

### UC-004: Cadastrar Nova Correição

**Ator Principal:** Corregedor Nacional, Assessor (Admin)

**Objetivo:** Registrar uma nova correição no sistema com todos os metadados necessários.

**Pré-condições:**
- Usuário autenticado como Admin
- Usuário na página "Cadastrar Correição"

**Fluxo Principal:**

1. Usuário acessa menu "Cadastrar Correição"
2. Sistema exibe formulário com campos:
   - **Número da Correição** (obrigatório, ex: COR-2024-01)
   - **Temática** (obrigatório, textarea, ex: "Direitos fundamentais e meio ambiente")
   - **Número ELO** (obrigatório, formato NNNNNNN-DD.AAAA.J.TT.OOOO)
   - **Tipo** (obrigatório, combo: Ordinária, Extraordinária, OCD, Inspeção)
   - **MP** (obrigatório, combo: MPE, MPU)
   - **UF** (obrigatório, select múltiplo para MPU, único para MPE)
   - **Ramo do MP** (obrigatório, combo com 27 MPs)
   - **Data de Início** (obrigatório, date picker)
   - **Data de Fim** (obrigatório, date picker)
   - **Observações** (opcional, textarea até 2.000 caracteres)
3. Usuário preenche campo "Número da Correição"
4. Usuário preenche "Temática" descrevendo o tema da correição
5. Usuário preenche "Número ELO" seguindo formato padrão
6. Usuário seleciona "Tipo" (ex: Ordinária)
7. Usuário seleciona "MP":
   - Se MPE → sistema ajusta UF para seleção única (size=1)
   - Se MPU → sistema ajusta UF para seleção múltipla (size=5)
8. Usuário seleciona UF(s)
9. Usuário seleciona "Ramo do MP" (ex: MPBA)
10. Usuário define "Data de Início"
11. Usuário define "Data de Fim"
12. Usuário preenche "Observações" (opcional)
13. Usuário clica em "Cadastrar"
14. Sistema valida campos obrigatórios
15. Sistema valida formato do Número ELO (regex)
16. Sistema valida unicidade do número da correição
17. Sistema cria novo objeto correição:
    ```javascript
    {
      id: 6,  // auto-incremento
      numero: 'COR-2024-06',
      tematica: 'Direitos fundamentais e meio ambiente',
      numeroElo: '1234567-89.2024.1.01.0001',
      tipo: 'Ordinária',
      mp: 'MPE',
      uf: ['BA'],
      ramoMP: 'MPBA',
      ramoMPNome: 'Ministério Público do Estado da Bahia',
      dataInicio: '2024-01-15',
      dataFim: '2024-03-20',
      status: 'ativo',  // calculado automaticamente
      observacoes: '...'
    }
    ```
18. Sistema adiciona correição ao array `correicoes[]`
19. Sistema salva em `localStorage`
20. Sistema atualiza dropdowns de filtro em todas as páginas
21. Sistema exibe mensagem: "✅ Correição cadastrada com sucesso!"
22. Sistema limpa formulário
23. Sistema atualiza dashboard e tabelas

**Fluxos Alternativos:**

**FA-1: Número duplicado**
- 16a. Sistema detecta que número já existe
- 16b. Sistema exibe alerta: "⚠️ Número da correição já cadastrado. Use outro número."
- 16c. Sistema destaca campo "Número" em vermelho
- 16d. Caso de uso retorna ao passo 3

**FA-2: Formato inválido do Número ELO**
- 15a. Sistema detecta formato inválido (não segue NNNNNNN-DD.AAAA.J.TT.OOOO)
- 15b. Sistema exibe alerta: "⚠️ Número ELO inválido. Use formato: 1234567-89.2024.1.01.0001"
- 15c. Sistema destaca campo "Número ELO" em vermelho
- 15d. Caso de uso retorna ao passo 5

**FA-3: Seleção MPU com múltiplas UFs**
- 7a. Usuário seleciona "MPU"
- 7b. Sistema habilita seleção múltipla de UFs (Ctrl+Click)
- 7c. Usuário seleciona múltiplas UFs (ex: DF, SP, RJ)
- 7d. Sistema armazena array de UFs: `['DF', 'SP', 'RJ']`
- 7e. Fluxo continua no passo 9

**FA-4: Data de fim anterior à data de início**
- 11a. Usuário define data de fim anterior à data de início
- 11b. Sistema exibe alerta: "⚠️ Data de fim não pode ser anterior à data de início."
- 11c. Sistema limpa campo "Data de Fim"
- 11d. Caso de uso retorna ao passo 11

**Pós-condições:**
- ✅ Nova correição adicionada ao sistema
- ✅ Dados persistidos em `localStorage`
- ✅ Correição aparece em tabelas e filtros
- ✅ Formulário limpo e pronto para novo cadastro

**Critérios de Aceite:**

**CA-1: Validação de campos obrigatórios**
- [ ] Todos os campos marcados como obrigatórios impedem submit se vazios
- [ ] HTML5 validation ativa (atributo `required`)
- [ ] Mensagens de erro claras indicam qual campo está inválido

**CA-2: Formato do Número ELO**
- [ ] Regex valida formato: `/^\d{7}-\d{2}\.\d{4}\.\d{1}\.\d{2}\.\d{4}$/`
- [ ] Exemplos válidos: 1234567-89.2024.1.01.0001
- [ ] Exemplos inválidos: 123456-89.2024.1.01.0001 (faltam dígitos)

**CA-3: Seleção de UF dinâmica**
- [ ] MP=MPE → campo UF com `size=1` (seleção única)
- [ ] MP=MPU → campo UF com `size=5` e `multiple` (seleção múltipla)
- [ ] Mudança de MP para MPU reseta seleção de UF

**CA-4: Auto-cálculo de status**
- [ ] Correição recém-cadastrada inicia com `status: 'ativo'`
- [ ] Status recalculado automaticamente ao adicionar proposições
- [ ] Status = 'inativo' quando todas as proposições são 'finalizada' ou 'prejudicada'

**CA-5: Persistência**
- [ ] Correição salva em `localStorage.correicoes`
- [ ] ID auto-incrementado (max(ids) + 1)
- [ ] Dados recuperados após refresh da página

**CA-6: Atualizações em cascata**
- [ ] Correição aparece imediatamente em "Lista de Correições"
- [ ] Correição disponível em dropdown de filtros (Dashboard, Proposições)
- [ ] Correição disponível em dropdown "Correição Vinculada" (Cadastro de Proposição)

**Regras de Negócio:**

**RN-011:** Número da correição deve ser **único** no sistema. Não permitir duplicação.

**RN-012:** Número ELO segue padrão do **sistema ELO do CNMP**: NNNNNNN-DD.AAAA.J.TT.OOOO (N=número, D=dígito, A=ano, J=justiça, T=tipo, O=órgão).

**RN-013:** Correições do tipo **MPE** (estadual) podem ter apenas **1 UF**. Correições do tipo **MPU** (federal) podem ter **múltiplas UFs**.

**RN-014:** Status da correição é **calculado automaticamente** com base no status das proposições vinculadas, nunca editado manualmente.

**RN-015:** Data de início deve ser **anterior ou igual** à data de fim.

---

### UC-005: Consultar Lista de Correições

**Ator Principal:** Todos os usuários autenticados

**Objetivo:** Visualizar lista de correições cadastradas com filtros e ordenação.

**Pré-condições:**
- Usuário autenticado
- Usuário na página "Correições"

**Fluxo Principal:**

1. Usuário acessa menu "Correições"
2. Sistema exibe tabela com 13 colunas:
   - Número (sortable)
   - Temática
   - Número ELO
   - Tipo
   - MP
   - UF
   - Ramo do MP
   - Total de Proposições (sortable)
   - Pendente (sortable)
   - Em Análise (sortable)
   - Prazo Vencido (sortable)
   - Status
   - Ações
3. Sistema carrega todas as correições:
   - Admin: todas as correições (sem filtro)
   - User: apenas correições do seu ramo do MP
4. Sistema exibe correições ordenadas por número (crescente)
5. Sistema calcula estatísticas para cada correição:
   - Total de proposições vinculadas
   - Quantidade com status processual = 'pendente'
   - Quantidade com status processual = 'em_analise'
   - Quantidade com prazo de comprovação vencido
6. Sistema aplica destaque visual:
   - Pendente > 0 → célula amarela
   - Em Análise > 0 → célula azul
   - Prazo Vencido > 0 → célula vermelha
7. Sistema exibe controles de filtro:
   - Campo de busca (temática, número, ramoMP)
   - Dropdown de status (Todas, Ativas, Inativas)
8. Usuário visualiza lista completa

**Fluxos Alternativos:**

**FA-1: Ordenar por coluna**
- 8a. Usuário clica no header de coluna sortable (ex: "Total de Proposições")
- 8b. Sistema ordena crescente (▲)
- 8c. Sistema atualiza indicador visual no header
- 8d. Usuário clica novamente no mesmo header
- 8e. Sistema ordena decrescente (▼)
- 8f. Usuário clica em header diferente
- 8g. Sistema remove ordenação anterior e aplica nova
- 8h. Fluxo retorna ao passo 8

**FA-2: Filtrar por texto**
- 8a. Usuário digita no campo de busca (ex: "meio ambiente")
- 8b. Sistema filtra correições onde temática, número ou ramoMP contém texto
- 8c. Sistema atualiza tabela mostrando apenas resultados filtrados
- 8d. Sistema exibe contador: "Exibindo X de Y correições"
- 8e. Fluxo retorna ao passo 8

**FA-3: Filtrar por status**
- 8a. Usuário seleciona "Apenas Ativas" no dropdown
- 8b. Sistema filtra apenas correições com `status === 'ativo'`
- 8c. Sistema atualiza tabela
- 8d. Usuário seleciona "Apenas Inativas"
- 8e. Sistema filtra apenas correições com `status === 'inativo'`
- 8f. Fluxo retorna ao passo 8

**FA-4: Combinar filtros**
- 8a. Usuário digita texto no campo de busca
- 8b. Usuário seleciona status no dropdown
- 8c. Sistema aplica ambos os filtros (lógica AND)
- 8d. Sistema exibe resultados que atendem ambas as condições
- 8e. Fluxo retorna ao passo 8

**FA-5: Nenhuma correição encontrada**
- 8a. Filtros aplicados não retornam resultados
- 8b. Sistema exibe mensagem: "Nenhuma correição encontrada com os filtros aplicados."
- 8c. Sistema exibe botão "Limpar Filtros"
- 8d. Fluxo retorna ao passo 8

**Pós-condições:**
- ✅ Lista de correições exibida na tela
- ✅ Estatísticas calculadas corretamente
- ✅ Filtros e ordenação funcionando
- ✅ Destaque visual aplicado conforme regras

**Critérios de Aceite:**

**CA-1: Tabela responsiva**
- [ ] Desktop (>768px): tabela com 13 colunas visíveis
- [ ] Mobile (≤768px): scroll horizontal habilitado
- [ ] Colunas mantêm largura mínima para legibilidade

**CA-2: Ordenação**
- [ ] 5 colunas sortable: Número, Total Proposições, Pendente, Em Análise, Prazo Vencido
- [ ] Clique no header alterna entre ASC → DESC → ASC
- [ ] Indicador visual (▲/▼) mostra direção atual
- [ ] Apenas 1 coluna ordenada por vez

**CA-3: Cálculo de estatísticas**
- [ ] Total de Proposições = count de proposições com `correicaoId` igual
- [ ] Pendente = count de proposições com `status[0] === 'pendente'`
- [ ] Em Análise = count de proposições com `status[0] === 'em_analise'`
- [ ] Prazo Vencido = count de proposições com `prazoComprovacao < hoje` e `status[0] === 'aguardando_comprovacao'`

**CA-4: Destaque visual**
- [ ] Pendente > 0 → background amarelo (#ffc107), font-weight bold
- [ ] Em Análise > 0 → background azul (#0066cc), texto branco, font-weight bold
- [ ] Prazo Vencido > 0 → background vermelho (#dc3545), texto branco, font-weight bold
- [ ] Valores = 0 → sem destaque

**CA-5: Filtros**
- [ ] Busca case-insensitive
- [ ] Busca em temática, número e ramoMP (3 campos)
- [ ] Filtro de status com 3 opções: Todas, Ativas, Inativas
- [ ] Filtros aplicados em conjunto (AND)
- [ ] Contador de resultados atualizado dinamicamente

**CA-6: Permissões**
- [ ] Admin vê todas as correições (27 MPs)
- [ ] User vê apenas correições do seu ramoMP
- [ ] Filtro automático aplicado sem intervenção do usuário

**Regras de Negócio:**

**RN-016:** Usuários do tipo **User** só visualizam correições vinculadas ao seu ramo do MP (`correicao.ramoMP === currentUser.ramoMP`).

**RN-017:** Estatísticas devem ser **calculadas em tempo real**, não armazenadas. Garantir consistência com estado atual das proposições.

**RN-018:** Ordenação padrão é por **número da correição crescente** (COR-2024-01, COR-2024-02, ...).

**RN-019:** Prazo vencido considera **apenas proposições em status `aguardando_comprovacao`**. Proposições com outros status não contam mesmo se prazo expirou.

---

### UC-006: Visualizar Detalhes de Correição

**Ator Principal:** Todos os usuários autenticados

**Objetivo:** Acessar modal com informações completas de uma correição e distribuição de proposições.

**Pré-condições:**
- Usuário na página "Correições" (UC-005)
- Pelo menos uma correição cadastrada

**Fluxo Principal:**

1. Usuário identifica correição de interesse na tabela
2. Usuário clica em botão "Ver" na coluna "Ações"
3. Sistema abre modal sobrepondo conteúdo da página
4. Sistema exibe 3 seções organizadas:

   **Seção 1: Informações da Correição**
   - Número
   - Temática (texto completo)
   - Número ELO
   - Tipo (Ordinária, Extraordinária, OCD, Inspeção)
   - MP (MPE ou MPU)
   - UF (lista separada por vírgula se múltiplas)
   - Ramo do MP
   - Data de Início (formato DD/MM/AAAA)
   - Data de Fim (formato DD/MM/AAAA)
   - Status (badge colorido: verde=ativo, cinza=inativo)
   - Observações (se houver)

   **Seção 2: Status Processual**
   - Pendente: X proposições (badge amarelo)
   - Aguardando Comprovação: Y proposições (badge laranja)
   - Em Análise: Z proposições (badge azul)
   - Encerrada: W proposições (badge azul escuro)

   **Seção 3: Valoração**
   - Nova: A proposições (badge cinza)
   - Finalizada: B proposições (badge verde)
   - Parcial: C proposições (badge laranja)
   - Em Andamento: D proposições (badge vermelho)
   - Prejudicada: E proposições (badge cinza escuro)

5. Sistema calcula totais em tempo real
6. Usuário visualiza informações completas
7. Usuário clica em "Fechar" ou clica fora do modal
8. Sistema fecha modal e retorna à tabela

**Fluxos Alternativos:**

**FA-1: Correição sem proposições**
- 5a. Correição não possui proposições vinculadas
- 5b. Seções 2 e 3 exibem "0 proposições" em todas as categorias
- 5c. Sistema exibe mensagem informativa: "Esta correição ainda não possui proposições cadastradas."
- 5d. Fluxo continua no passo 6

**FA-2: Fechar modal com tecla ESC**
- 7a. Usuário pressiona tecla ESC
- 7b. Sistema fecha modal
- 7c. Caso de uso termina

**FA-3: Fechar modal clicando no backdrop**
- 7a. Usuário clica na área escura fora do modal (backdrop)
- 7b. Sistema detecta clique no backdrop (não no conteúdo)
- 7c. Sistema fecha modal
- 7d. Caso de uso termina

**Pós-condições:**
- ✅ Usuário visualizou informações completas
- ✅ Modal fechado após visualização
- ✅ Estado da tabela preservado (filtros, ordenação)

**Critérios de Aceite:**

**CA-1: Layout do modal**
- [ ] Modal centralizado na tela
- [ ] Largura máxima de 800px
- [ ] Backdrop semi-transparente (rgba(0,0,0,0.5))
- [ ] Scroll vertical se conteúdo exceder altura da viewport
- [ ] Botão "Fechar" visível no canto superior direito

**CA-2: Seção 1 - Informações da Correição**
- [ ] Todos os campos da correição exibidos
- [ ] Datas formatadas em DD/MM/AAAA
- [ ] UF exibida como lista separada por vírgula (ex: "DF, SP, RJ")
- [ ] Status exibido como badge colorido
- [ ] Observações exibidas se houver, ou "-" se vazio

**CA-3: Seção 2 - Status Processual**
- [ ] 4 contadores: Pendente, Aguardando Comprovação, Em Análise, Encerrada
- [ ] Cada contador com badge colorido correspondente
- [ ] Valores calculados em tempo real (não armazenados)
- [ ] Soma dos 4 valores = Total de Proposições

**CA-4: Seção 3 - Valoração**
- [ ] 5 contadores: Nova, Finalizada, Parcial, Em Andamento, Prejudicada
- [ ] Cada contador com badge colorido correspondente
- [ ] Valores calculados em tempo real
- [ ] Soma dos 5 valores = Total de Proposições

**CA-5: Interação**
- [ ] Clique em "Fechar" fecha modal
- [ ] Clique no backdrop fecha modal
- [ ] Tecla ESC fecha modal
- [ ] Clique dentro do conteúdo do modal NÃO fecha

**CA-6: Performance**
- [ ] Modal abre em < 100ms
- [ ] Cálculos de estatísticas não causam travamento
- [ ] Animação suave de abertura/fechamento (fade in/out)

**Regras de Negócio:**

**RN-020:** Contadores de status processual e valoração devem **sempre somar o total de proposições** da correição.

**RN-021:** Se correição não possui proposições, status deve ser exibido como **"ativo" por padrão**, mas com aviso de que não há proposições cadastradas.

**RN-022:** Modal deve ser **acessível via teclado** (Tab, Shift+Tab, ESC).

---

### UC-007: Editar Correição Existente

**Ator Principal:** Corregedor Nacional, Assessor (Admin)

**Objetivo:** Modificar informações de uma correição já cadastrada.

**Pré-condições:**
- Usuário autenticado como Admin
- Usuário na página "Correições"
- Pelo menos uma correição cadastrada

**Fluxo Principal:**

1. Usuário identifica correição a ser editada na tabela
2. Usuário clica em botão "Editar" na coluna "Ações"
3. Sistema abre modal de edição
4. Sistema pré-preenche formulário com dados atuais da correição:
   - Número (readonly)
   - Temática
   - Número ELO
   - Tipo
   - MP
   - UF (seleção única ou múltipla conforme MP)
   - Ramo do MP
   - Data de Início
   - Data de Fim
   - Observações
5. Usuário modifica campos desejados (exceto número)
6. Usuário clica em "Salvar Alterações"
7. Sistema valida campos obrigatórios
8. Sistema valida formato do Número ELO
9. Sistema valida datas (fim >= início)
10. Sistema atualiza objeto correição no array `correicoes[]`
11. Sistema recalcula status da correição
12. Sistema salva em `localStorage`
13. Sistema fecha modal
14. Sistema atualiza tabela de correições
15. Sistema exibe mensagem: "✅ Correição atualizada com sucesso!"

**Fluxos Alternativos:**

**FA-1: Cancelar edição**
- 6a. Usuário clica em "Cancelar"
- 6b. Sistema fecha modal sem salvar alterações
- 6c. Sistema exibe mensagem: "Edição cancelada."
- 6d. Caso de uso termina

**FA-2: Validação falha**
- 7a. Sistema detecta campo obrigatório vazio
- 7b. Sistema exibe alerta: "⚠️ Preencha todos os campos obrigatórios."
- 7c. Sistema destaca campo inválido em vermelho
- 7d. Caso de uso retorna ao passo 5

**FA-3: Número ELO inválido**
- 8a. Sistema detecta formato inválido
- 8b. Sistema exibe alerta: "⚠️ Número ELO inválido."
- 8c. Caso de uso retorna ao passo 5

**FA-4: Data de fim anterior ao início**
- 9a. Sistema detecta data de fim < data de início
- 9b. Sistema exibe alerta: "⚠️ Data de fim não pode ser anterior à data de início."
- 9c. Caso de uso retorna ao passo 5

**FA-5: Mudança de MP (MPE ↔ MPU)**
- 5a. Usuário altera MP de MPE para MPU
- 5b. Sistema habilita seleção múltipla de UF
- 5c. Sistema limpa seleção atual de UF
- 5d. Usuário seleciona novas UFs
- 5e. Fluxo continua no passo 6

**Pós-condições:**
- ✅ Correição atualizada no sistema
- ✅ Dados persistidos em `localStorage`
- ✅ Tabela atualizada com novos valores
- ✅ Status recalculado (se necessário)

**Critérios de Aceite:**

**CA-1: Campo número readonly**
- [ ] Campo "Número" exibido mas desabilitado (readonly)
- [ ] Usuário não consegue editar número da correição
- [ ] Tooltip explica: "Número não pode ser alterado após cadastro"

**CA-2: Pré-preenchimento**
- [ ] Todos os campos carregados com valores atuais
- [ ] Seleção de MP correta (MPE ou MPU)
- [ ] UF pré-selecionada (única ou múltipla)
- [ ] Datas formatadas corretamente em inputs tipo date

**CA-3: Validação em tempo real**
- [ ] Mudança de MP atualiza modo de seleção de UF imediatamente
- [ ] Seleção de data de fim < data de início exibe erro instantaneamente
- [ ] Contador de caracteres em "Observações" atualiza em tempo real

**CA-4: Persistência**
- [ ] Alterações salvas em `localStorage` imediatamente
- [ ] Tabela re-renderizada mostrando novos valores
- [ ] Proposições vinculadas mantêm referência (correicaoId)

**CA-5: Recálculo de status**
- [ ] Se status anterior era 'ativo', recalculado após edição
- [ ] Se status anterior era 'inativo', recalculado após edição
- [ ] Status reflete estado atual das proposições vinculadas

**CA-6: Impacto em proposições**
- [ ] Edição de correição NÃO afeta proposições vinculadas
- [ ] ramoMPNome atualizado em todas as proposições se ramoMP mudou
- [ ] Integridade referencial mantida (correicaoId)

**Regras de Negócio:**

**RN-023:** Número da correição é **imutável** após cadastro. Não permitir edição.

**RN-024:** Edição de correição **não deve afetar** proposições já publicadas ou em andamento. Apenas metadados da correição podem ser alterados.

**RN-025:** Se `ramoMP` for alterado, sistema deve **atualizar ramoMPNome** em todas as proposições vinculadas para manter consistência.

**RN-026:** Status deve ser **recalculado automaticamente** após edição, mesmo que não haja mudança nas proposições.

---

### UC-008: Excluir Correição

**Ator Principal:** Corregedor Nacional (Admin)

**Objetivo:** Remover uma correição do sistema.

**Pré-condições:**
- Usuário autenticado como Admin com perfil de Corregedor Nacional
- Usuário na página "Correições"
- Correição a ser excluída não possui proposições vinculadas

**Fluxo Principal:**

1. Usuário identifica correição a ser excluída na tabela
2. Usuário clica em botão "Excluir" na coluna "Ações"
3. Sistema verifica se correição possui proposições vinculadas
4. Sistema exibe diálogo de confirmação:
   ```
   ⚠️ Atenção!
   Deseja realmente excluir a correição "COR-2024-06"?
   Esta ação não pode ser desfeita.

   [Cancelar] [Confirmar Exclusão]
   ```
5. Usuário clica em "Confirmar Exclusão"
6. Sistema remove correição do array `correicoes[]`
7. Sistema salva em `localStorage`
8. Sistema atualiza tabela removendo linha
9. Sistema atualiza dropdowns de filtro (remove correição)
10. Sistema exibe mensagem: "✅ Correição excluída com sucesso!"

**Fluxos Alternativos:**

**FA-1: Cancelar exclusão**
- 5a. Usuário clica em "Cancelar"
- 5b. Sistema fecha diálogo sem executar exclusão
- 5c. Sistema exibe mensagem: "Exclusão cancelada."
- 5d. Caso de uso termina

**FA-2: Correição com proposições vinculadas**
- 3a. Sistema detecta que correição possui proposições vinculadas
- 3b. Sistema exibe alerta:
   ```
   ❌ Exclusão bloqueada
   Esta correição possui X proposições vinculadas.
   Não é possível excluir correições com proposições.

   Ações recomendadas:
   - Exclua todas as proposições vinculadas primeiro
   - Ou cancele a exclusão

   [Entendi]
   ```
- 3c. Usuário clica em "Entendi"
- 3d. Sistema mantém correição no sistema
- 3e. Caso de uso termina

**FA-3: Correição com proposições em andamento**
- 3a. Sistema detecta proposições com status diferente de 'pendente' ou 'encerrada'
- 3b. Sistema exibe alerta:
   ```
   ❌ Exclusão bloqueada
   Esta correição possui proposições em andamento:
   - X em "Aguardando Comprovação"
   - Y em "Em Análise"

   Não é possível excluir correições com processos ativos.

   [Entendi]
   ```
- 3c. Caso de uso termina

**Pós-condições:**
- ✅ Correição removida do sistema
- ✅ `localStorage` atualizado
- ✅ Tabela e filtros atualizados
- ✅ Nenhuma proposição órfã (sem correição vinculada)

**Critérios de Aceite:**

**CA-1: Verificação de proposições vinculadas**
- [ ] Sistema impede exclusão se `proposicoes.filter(p => p.correicaoId === id).length > 0`
- [ ] Mensagem de erro clara indica quantas proposições estão vinculadas
- [ ] Usuário orientado sobre ações necessárias (excluir proposições primeiro)

**CA-2: Confirmação de exclusão**
- [ ] Diálogo de confirmação exibido antes de executar
- [ ] Botão "Confirmar Exclusão" em cor vermelha (danger)
- [ ] Botão "Cancelar" em cor neutra
- [ ] Mensagem de aviso clara sobre irreversibilidade

**CA-3: Exclusão efetiva**
- [ ] Correição removida do array `correicoes[]`
- [ ] `localStorage.correicoes` atualizado
- [ ] Linha removida da tabela sem reload
- [ ] Dropdowns de filtro atualizados (correição não aparece mais)

**CA-4: Integridade referencial**
- [ ] Após exclusão, nenhuma proposição deve ter `correicaoId` apontando para ID excluído
- [ ] Sistema garante que proposições são excluídas/remanejadas antes
- [ ] Não permitir estado inconsistente (proposições órfãs)

**CA-5: Permissão**
- [ ] Apenas usuários Admin podem ver botão "Excluir"
- [ ] Idealmente, apenas Corregedor Nacional (não assessores)
- [ ] Confirmação dupla para ações críticas

**Regras de Negócio:**

**RN-027:** **Exclusão de correição é irreversível**. Sistema deve solicitar confirmação explícita do usuário.

**RN-028:** **Não permitir exclusão de correições com proposições vinculadas**. Usuário deve primeiro excluir ou realocar proposições.

**RN-029:** **Apenas Corregedor Nacional** deve ter permissão para excluir correições. Assessores podem editar, mas não excluir.

**RN-030:** Em ambiente de **produção**, exclusão deve ser **soft delete** (flag `deleted: true`), nunca remoção física do banco de dados. Protótipo usa hard delete.

---

**Fim da Parte 6.1**

---

## PARTE 6.2 - PROPOSIÇÕES, PUBLICAÇÃO E COMPROVAÇÃO

## 5. Casos de Uso - Gestão de Proposições

### UC-009: Cadastrar Nova Proposição

**Ator Principal:** Corregedor Nacional, Assessor (Admin)

**Objetivo:** Registrar uma nova proposição (determinação ou recomendação) vinculada a uma correição.

**Pré-condições:**
- Usuário autenticado como Admin
- Usuário na página "Cadastrar Proposição"
- Pelo menos uma correição cadastrada no sistema

**Fluxo Principal:**

1. Usuário acessa menu "Cadastrar Proposição"
2. Sistema exibe formulário com campos:
   - **Número da Proposição** (obrigatório, ex: PROP-2024-0001)
   - **Correição Vinculada** (obrigatório, dropdown)
   - **Tipo** (obrigatório, combo: Determinação, Recomendação)
   - **Unidade** (obrigatório, text, ex: "Promotoria de Justiça de Cachoeira")
   - **Membro** (obrigatório, text, ex: "Dr. João Silva Santos")
   - **Descrição** (obrigatório, textarea até 5.000 caracteres)
   - **Prioridade** (obrigatório, combo: urgente, alta, normal)
   - **Tags** (opcional, checkboxes: 11 categorias)
3. Usuário preenche "Número da Proposição"
4. Usuário seleciona "Correição Vinculada" no dropdown
5. Usuário seleciona "Tipo" (Determinação ou Recomendação)
6. Usuário preenche "Unidade" (nome da unidade do MP responsável)
7. Usuário preenche "Membro" (nome do membro designado)
8. Usuário preenche "Descrição" detalhando a proposição
9. Sistema exibe contador de caracteres em tempo real (X/5000)
10. Usuário seleciona "Prioridade"
11. Usuário seleciona tags aplicáveis (0 a 11 tags)
12. Usuário clica em "Cadastrar"
13. Sistema valida campos obrigatórios
14. Sistema valida formato do número (PROP-AAAA-NNNN)
15. Sistema valida unicidade do número
16. Sistema valida tamanho da descrição (≤ 5.000 caracteres)
17. Sistema cria novo objeto proposição:
    ```javascript
    {
      id: 14,  // auto-incremento
      numero: 'PROP-2024-0014',
      correicaoId: 1,
      tipo: 'Determinação',
      unidade: 'Promotoria de Justiça de Cachoeira',
      membro: 'Dr. João Silva Santos',
      descricao: '...',
      prioridade: 'normal',
      status: ['pendente', 'nova'],  // bidimensional
      prazoComprovacao: null,
      dataPublicacao: null,
      tags: ['tecnologia', 'administrativo'],
      rascunhos: [],
      historico: []
    }
    ```
18. Sistema adiciona proposição ao array `proposicoes[]`
19. Sistema salva em `localStorage`
20. Sistema atualiza status da correição vinculada (recalcula)
21. Sistema atualiza dropdowns e tabelas
22. Sistema exibe mensagem: "✅ Proposição cadastrada com sucesso!"
23. Sistema limpa formulário

**Fluxos Alternativos:**

**FA-1: Número duplicado**
- 15a. Sistema detecta número já cadastrado
- 15b. Sistema exibe alerta: "⚠️ Número da proposição já cadastrado."
- 15c. Sistema destaca campo "Número" em vermelho
- 15d. Caso de uso retorna ao passo 3

**FA-2: Formato inválido do número**
- 14a. Sistema detecta formato diferente de PROP-AAAA-NNNN
- 14b. Sistema exibe alerta: "⚠️ Use formato: PROP-2024-0001"
- 14c. Caso de uso retorna ao passo 3

**FA-3: Descrição excede limite**
- 16a. Usuário tenta inserir mais de 5.000 caracteres
- 16b. Sistema impede digitação adicional
- 16c. Contador exibe texto vermelho: "5000/5000 - Limite atingido!"
- 16d. Caso de uso retorna ao passo 8

**FA-4: Nenhuma tag selecionada**
- 11a. Usuário não seleciona nenhuma tag
- 11b. Sistema aceita (tags são opcionais)
- 11c. Sistema armazena array vazio: `tags: []`
- 11d. Fluxo continua no passo 12

**FA-5: Múltiplas tags selecionadas**
- 11a. Usuário seleciona 5 tags
- 11b. Sistema armazena array com IDs: `tags: ['tecnologia', 'administrativo', 'compliance', 'financeiro', 'gestao-documental']`
- 11c. Fluxo continua no passo 12

**Pós-condições:**
- ✅ Nova proposição adicionada ao sistema
- ✅ Proposição vinculada à correição via `correicaoId`
- ✅ Status inicial: `['pendente', 'nova']`
- ✅ Dados persistidos em `localStorage`
- ✅ Status da correição recalculado

**Critérios de Aceite:**

**CA-1: Validação de campos obrigatórios**
- [ ] Campos obrigatórios: número, correicaoId, tipo, unidade, membro, descrição, prioridade
- [ ] HTML5 validation ativa (`required` attribute)
- [ ] Submit bloqueado se campos vazios

**CA-2: Formato do número**
- [ ] Regex valida formato: `/^PROP-\d{4}-\d{4}$/`
- [ ] Exemplos válidos: PROP-2024-0001, PROP-2025-0123
- [ ] Exemplos inválidos: PROP-24-001, PROP-2024-01

**CA-3: Contador de caracteres**
- [ ] Exibe "X/5000" em tempo real
- [ ] Verde quando < 4.500 caracteres
- [ ] Amarelo quando 4.500-4.900
- [ ] Vermelho quando ≥ 4.900
- [ ] Impede digitação após 5.000

**CA-4: Dropdown de correições**
- [ ] Popula com todas as correições cadastradas
- [ ] Formato: "COR-2024-01 - Temática..."
- [ ] Ordenado por número crescente
- [ ] Mostra no mínimo 5 opções visíveis (size=5)

**CA-5: Tipo de proposição**
- [ ] Exatamente 2 opções: Determinação, Recomendação
- [ ] Determinação → caráter obrigatório (compliance mandatório)
- [ ] Recomendação → caráter consultivo (compliance desejável)

**CA-6: Tags**
- [ ] 11 checkboxes com badges coloridos
- [ ] Seleção múltipla permitida (0 a 11)
- [ ] Tags disponíveis: administrativo, recursos-humanos, infraestrutura, tecnologia, processual, financeiro, capacitacao, gestao-documental, compliance, transparencia, outros

**CA-7: Status inicial**
- [ ] Status processual: 'pendente'
- [ ] Valoração: 'nova'
- [ ] `prazoComprovacao`: null
- [ ] `dataPublicacao`: null
- [ ] `historico`: array vazio []
- [ ] `rascunhos`: array vazio []

**Regras de Negócio:**

**RN-031:** Proposições **sempre iniciam** com status `['pendente', 'nova']`. Status processual muda apenas após publicação.

**RN-032:** **Determinação** possui caráter obrigatório e **requer compliance**. **Recomendação** possui caráter consultivo.

**RN-033:** Proposição **deve estar vinculada a uma correição** válida. Não permitir proposições órfãs.

**RN-034:** Descrição da proposição deve ser **clara e objetiva**, indicando exatamente o que deve ser comprovado.

**RN-035:** Tags são **opcionais** mas fortemente recomendadas para organização e filtros.

---

### UC-010: Consultar Lista de Proposições

**Ator Principal:** Todos os usuários autenticados

**Objetivo:** Visualizar lista de proposições com filtros avançados em página standalone.

**Pré-condições:**
- Usuário autenticado
- Usuário acessa `proposicoes.html`

**Fluxo Principal:**

1. Usuário clica em "Proposições" no menu lateral
2. Sistema redireciona para `proposicoes.html`
3. Sistema carrega sessão de `localStorage`
4. Sistema exibe **placeholder** com mensagem: "Selecione uma Correição para visualizar suas proposições"
5. Sistema oculta seções de filtros e tabela
6. Sistema popula dropdown "Correição":
   - Admin: todas as correições
   - User: apenas correições do seu ramoMP
7. Usuário seleciona correição no dropdown
8. Sistema exibe **painel informativo** da correição:
   - Temática
   - Período (dataInicio - dataFim)
   - Total de proposições
9. Sistema exibe **seção de filtros**:
   - Busca (texto livre)
   - Tipo (Determinação/Recomendação)
   - Status Processual (4 opções)
   - Valoração (5 opções)
   - Tag (11 opções)
   - Prioridade (3 opções)
   - Botão "Limpar Filtros"
10. Sistema exibe **tabela** com 7 colunas:
    - Número
    - Tipo
    - Unidade
    - Descrição (truncada)
    - Tags (badges)
    - Status (2 badges empilhados)
    - Ações (3 botões: Visualizar, Avaliar, Editar)
11. Sistema filtra proposições: `proposicoes.filter(p => p.correicaoId === correicaoSelecionada.id)`
12. Sistema aplica filtros adicionais se houver
13. Sistema exibe contador: "Exibindo X proposições"
14. Usuário visualiza lista

**Fluxos Alternativos:**

**FA-1: Aplicar filtro de busca**
- 14a. Usuário digita texto no campo de busca
- 14b. Sistema filtra por: número, unidade, membro, descrição
- 14c. Sistema atualiza tabela e contador em tempo real
- 14d. Fluxo retorna ao passo 14

**FA-2: Filtrar por tipo**
- 14a. Usuário seleciona "Determinação"
- 14b. Sistema filtra `proposicoes.filter(p => p.tipo === 'Determinação')`
- 14c. Sistema atualiza tabela
- 14d. Fluxo retorna ao passo 14

**FA-3: Filtrar por status**
- 14a. Usuário seleciona status processual "Aguardando Comprovação"
- 14b. Sistema filtra `proposicoes.filter(p => p.status[0] === 'aguardando_comprovacao')`
- 14c. Sistema atualiza tabela
- 14d. Fluxo retorna ao passo 14

**FA-4: Filtrar por tag**
- 14a. Usuário seleciona tag "tecnologia"
- 14b. Sistema filtra `proposicoes.filter(p => p.tags.includes('tecnologia'))`
- 14c. Sistema atualiza tabela
- 14d. Fluxo retorna ao passo 14

**FA-5: Combinar múltiplos filtros**
- 14a. Usuário aplica busca + tipo + status + tag
- 14b. Sistema aplica lógica AND (todos os filtros simultaneamente)
- 14c. Sistema atualiza tabela com resultados que atendem TODOS os critérios
- 14d. Fluxo retorna ao passo 14

**FA-6: Limpar filtros**
- 14a. Usuário clica em "Limpar Filtros"
- 14b. Sistema reseta todos os dropdowns e campo de busca
- 14c. Sistema exibe todas as proposições da correição selecionada
- 14d. Fluxo retorna ao passo 14

**FA-7: Nenhuma proposição encontrada**
- 13a. Filtros não retornam resultados
- 13b. Sistema exibe mensagem: "Nenhuma proposição encontrada com os filtros aplicados."
- 13c. Sistema sugere: "Tente limpar os filtros ou selecionar outra correição."
- 13d. Fluxo retorna ao passo 14

**FA-8: Visualizar detalhes**
- 14a. Usuário clica em botão "👁️ Visualizar"
- 14b. Sistema abre modal com informações completas da proposição
- 14c. Modal exibe timeline completo do histórico
- 14d. Usuário clica em "Fechar"
- 14e. Fluxo retorna ao passo 14

**FA-9: Avaliar proposição**
- 14a. Usuário (Admin) clica em botão "⚖️ Avaliar"
- 14b. Sistema redireciona para `avaliacao.html?id={proposicaoId}`
- 14c. Caso de uso UC-023 é executado
- 14d. Após avaliação, usuário retorna para proposicoes.html

**FA-10: Editar proposição**
- 14a. Usuário (Admin) clica em botão "✏️ Editar"
- 14b. Sistema abre modal de edição
- 14c. Caso de uso UC-011 é executado
- 14d. Após salvar, modal fecha e tabela atualiza

**Pós-condições:**
- ✅ Lista de proposições exibida
- ✅ Filtros funcionando corretamente
- ✅ Contador preciso de resultados
- ✅ Seleção de correição mantida

**Critérios de Aceite:**

**CA-1: Progressive disclosure**
- [ ] Ao carregar página: apenas placeholder e dropdown de correição visíveis
- [ ] Após selecionar correição: painel informativo, filtros e tabela aparecem
- [ ] Mudança de correição recarrega proposições e reseta filtros

**CA-2: Seleção de correição obrigatória**
- [ ] Usuário não consegue visualizar proposições sem selecionar correição
- [ ] Dropdown de correição sempre visível no topo
- [ ] Opção vazia ("") no dropdown exibe placeholder novamente

**CA-3: Tabela de 7 colunas**
- [ ] Colunas: Número, Tipo, Unidade, Descrição, Tags, Status, Ações
- [ ] Descrição truncada em ~100 caracteres com "..." se maior
- [ ] Tags exibidas como badges coloridos inline
- [ ] Status: 2 badges empilhados verticalmente (processual acima, valoração abaixo)

**CA-4: Ações por proposição**
- [ ] 3 botões por linha: Visualizar, Avaliar, Editar
- [ ] Visualizar: disponível para todos
- [ ] Avaliar: visível sempre, redireciona para avaliacao.html
- [ ] Editar: apenas Admin, abre modal inline

**CA-5: Filtros avançados**
- [ ] 6 filtros independentes: busca, tipo, status processual, valoração, tag, prioridade
- [ ] Filtros aplicados em conjunto (AND)
- [ ] Botão "Limpar Filtros" reseta todos de uma vez
- [ ] Contador atualiza dinamicamente

**CA-6: Permissões**
- [ ] Admin vê todas as proposições de qualquer correição
- [ ] User vê apenas proposições de correições do seu ramoMP
- [ ] Filtro automático aplicado no dropdown de correições

**CA-7: Performance**
- [ ] Filtros aplicados em < 50ms (debounce de 300ms no campo de busca)
- [ ] Mudança de correição carrega proposições em < 100ms
- [ ] Tabela responsiva em mobile (scroll horizontal)

**Regras de Negócio:**

**RN-036:** Seleção de correição é **obrigatória** antes de visualizar proposições. Implementar progressive disclosure.

**RN-037:** Filtros devem aplicar lógica **AND** (interseção). Proposição deve atender TODOS os critérios selecionados.

**RN-038:** Botão "Avaliar" deve estar **sempre visível**, independente do status processual. Sistema permite avaliação a qualquer momento.

**RN-039:** User só visualiza proposições de correições vinculadas ao seu **ramoMP**. Filtro automático e transparente.

---

### UC-011: Editar Proposição

**Ator Principal:** Corregedor Nacional, Assessor (Admin)

**Objetivo:** Modificar metadados de uma proposição já cadastrada.

**Pré-condições:**
- Usuário autenticado como Admin
- Usuário em `proposicoes.html` visualizando lista (UC-010)
- Proposição com status processual 'pendente' ou 'encerrada'

**Fluxo Principal:**

1. Usuário identifica proposição a ser editada na tabela
2. Usuário clica em botão "✏️ Editar"
3. Sistema verifica status processual da proposição
4. Sistema abre modal de edição
5. Sistema pré-preenche formulário com dados atuais:
   - **Número** (readonly)
   - **Tipo** (combo: Determinação, Recomendação)
   - **Unidade** (text)
   - **Membro** (text)
   - **Descrição** (textarea com contador 0/5000)
   - **Prioridade** (combo: urgente, alta, normal)
   - **Tags** (checkboxes)
6. Usuário modifica campos desejados (exceto número)
7. Sistema atualiza contador de caracteres em tempo real
8. Usuário clica em "Salvar Alterações"
9. Sistema valida campos obrigatórios
10. Sistema valida tamanho da descrição (≤ 5.000)
11. Sistema atualiza objeto proposição:
    ```javascript
    proposicao.tipo = novoTipo;
    proposicao.unidade = novaUnidade;
    proposicao.membro = novoMembro;
    proposicao.descricao = novaDescricao;
    proposicao.prioridade = novaPrioridade;
    proposicao.tags = novasTags;
    // Status NÃO é editado aqui
    ```
12. Sistema salva em `localStorage`
13. Sistema fecha modal
14. Sistema atualiza linha na tabela
15. Sistema exibe mensagem: "✅ Proposição atualizada com sucesso!"

**Fluxos Alternativos:**

**FA-1: Proposição em andamento (não editável)**
- 3a. Sistema detecta status processual diferente de 'pendente' ou 'encerrada'
- 3b. Sistema exibe alerta:
   ```
   ⚠️ Edição Bloqueada
   Esta proposição está em andamento (status: Aguardando Comprovação / Em Análise).
   Não é possível editar metadados de proposições ativas.

   Ações permitidas:
   - Avaliar proposição (muda status)
   - Visualizar detalhes

   [Entendi]
   ```
- 3c. Caso de uso termina

**FA-2: Cancelar edição**
- 8a. Usuário clica em "Cancelar"
- 8b. Sistema fecha modal sem salvar
- 8c. Sistema exibe mensagem: "Edição cancelada."
- 8d. Caso de uso termina

**FA-3: Descrição excede limite**
- 10a. Sistema detecta descrição > 5.000 caracteres
- 10b. Sistema exibe alerta: "⚠️ Descrição excede limite de 5.000 caracteres."
- 10c. Sistema destaca textarea em vermelho
- 10d. Caso de uso retorna ao passo 6

**FA-4: Mudança de tipo**
- 6a. Usuário muda tipo de "Recomendação" para "Determinação"
- 6b. Sistema aceita mudança
- 6c. Sistema exibe aviso informativo: "ℹ️ Determinação possui caráter obrigatório."
- 6d. Fluxo continua no passo 7

**FA-5: Adicionar/remover tags**
- 6a. Usuário adiciona 3 novas tags
- 6b. Usuário remove 2 tags existentes
- 6c. Sistema atualiza array de tags dinamicamente
- 6d. Badges atualizam em tempo real no modal
- 6e. Fluxo continua no passo 7

**Pós-condições:**
- ✅ Proposição atualizada no sistema
- ✅ Dados persistidos em `localStorage`
- ✅ Tabela atualizada com novos valores
- ✅ Status processual e valoração **não alterados**

**Critérios de Aceite:**

**CA-1: Restrição por status**
- [ ] Edição permitida apenas se `status[0] === 'pendente' || status[0] === 'encerrada'`
- [ ] Edição bloqueada se `status[0] === 'aguardando_comprovacao' || status[0] === 'em_analise'`
- [ ] Mensagem de erro clara explica motivo do bloqueio

**CA-2: Campo número readonly**
- [ ] Número exibido mas desabilitado (atributo `readonly`)
- [ ] Tooltip: "Número não pode ser alterado"
- [ ] Estilo visual diferenciado (cinza)

**CA-3: Pré-preenchimento**
- [ ] Todos os campos carregados com valores atuais
- [ ] Tipo pré-selecionado corretamente
- [ ] Prioridade pré-selecionada
- [ ] Tags pré-selecionadas (checkboxes marcados)
- [ ] Contador de caracteres exibe contagem atual

**CA-4: Validação em tempo real**
- [ ] Contador de caracteres atualiza a cada keystroke
- [ ] Cor do contador muda conforme proximidade do limite
- [ ] Digitação bloqueada ao atingir 5.000 caracteres

**CA-5: Não editar status**
- [ ] Status processual NÃO aparece no formulário de edição
- [ ] Valoração NÃO aparece no formulário de edição
- [ ] Status só muda via publicação/avaliação (UC-014, UC-023)

**CA-6: Preservar histórico**
- [ ] Array `historico[]` não é modificado
- [ ] Edição de metadados NÃO gera entrada no histórico
- [ ] Apenas publicação/comprovacao/avaliacao geram histórico

**Regras de Negócio:**

**RN-040:** Proposições em status **'aguardando_comprovacao' ou 'em_analise'** não podem ter metadados editados. Bloqueio total.

**RN-041:** Edição de metadados **não gera entrada no histórico**. Apenas ações de workflow (publicação, comprovação, avaliação) são registradas.

**RN-042:** Número da proposição é **imutável**. Identificador único não pode ser alterado após cadastro.

**RN-043:** Mudança de tipo (Determinação ↔ Recomendação) deve exibir **aviso informativo** sobre implicações de compliance.

---

### UC-012: Visualizar Detalhes de Proposição

**Ator Principal:** Todos os usuários autenticados

**Objetivo:** Acessar modal com informações completas de uma proposição e timeline histórica.

**Pré-condições:**
- Usuário em qualquer página que liste proposições
- Pelo menos uma proposição cadastrada

**Fluxo Principal:**

1. Usuário identifica proposição de interesse
2. Usuário clica em botão "👁️ Visualizar" ou "Ver Detalhes"
3. Sistema abre modal sobrepondo conteúdo
4. Sistema busca correição vinculada: `correicoes.find(c => c.id === proposicao.correicaoId)`
5. Sistema exibe **Seção 1: Informações da Proposição**:
   - Número
   - Correição Vinculada (número + temática)
   - Tipo (badge: Determinação=azul, Recomendação=verde)
   - Unidade
   - Membro
   - Descrição (texto completo, sem truncamento)
   - Prioridade (badge: urgente=vermelho, alta=laranja, normal=cinza)
   - Tags (badges coloridos)
   - Status Processual (badge)
   - Valoração (badge)
   - Prazo de Comprovação (se houver, formato DD/MM/AAAA)
   - Data de Publicação (se houver, formato DD/MM/AAAA)
6. Sistema exibe **Seção 2: Timeline Histórica**:
   - Título: "Histórico de Interações (X entradas)"
   - Ordenação: cronológica (mais antiga no topo)
7. Sistema renderiza cada entrada do `historico[]`:
   - **Publicação** (ícone 📤, fundo laranja):
     - Data e hora
     - Usuário: "Corregedoria Nacional"
     - Descrição: "Proposição publicada para [ramoMP]"
     - Prazo de Comprovação: DD/MM/AAAA
     - Observações (se houver)
     - Status: anterior → novo
   - **Comprovação** (ícone 📎, fundo azul):
     - Data e hora
     - Usuário: "[ramoMP] - [ramoMPNome]"
     - Descrição do adimplemento (texto completo)
     - Observações adicionais (se houver)
     - Arquivos anexados (lista com ícones)
   - **Avaliação** (ícone ⚖️, fundo verde):
     - Data e hora
     - Usuário: "Corregedoria Nacional"
     - Decisão (badge da valoração)
     - Parecer técnico (texto completo)
     - Status: anterior → novo
8. Sistema exibe botão "Fechar" no canto superior direito
9. Usuário visualiza informações completas
10. Usuário clica em "Fechar"
11. Sistema fecha modal e retorna à página anterior

**Fluxos Alternativos:**

**FA-1: Proposição sem histórico**
- 7a. Array `historico[]` está vazio
- 7b. Sistema exibe mensagem: "Esta proposição ainda não possui histórico de interações."
- 7c. Sistema esconde Seção 2 (Timeline)
- 7d. Fluxo continua no passo 8

**FA-2: Proposição com múltiplas publicações**
- 7a. Histórico contém 3 entradas de publicação
- 7b. Sistema renderiza todas as 3 entradas na timeline
- 7c. Cada publicação exibe prazo específico
- 7d. Ordem cronológica preservada (1ª publicação no topo)
- 7e. Fluxo continua no passo 8

**FA-3: Proposição com comprovação pendente**
- 7a. Última entrada é uma publicação
- 7b. Não há comprovação subsequente
- 7c. Sistema destaca prazo de comprovação
- 7d. Se prazo vencido, exibe badge vermelho "⚠️ Prazo Vencido"
- 7e. Fluxo continua no passo 8

**FA-4: Fechar modal com ESC**
- 10a. Usuário pressiona tecla ESC
- 10b. Sistema fecha modal
- 10c. Caso de uso termina

**FA-5: Fechar modal clicando no backdrop**
- 10a. Usuário clica na área escura fora do modal
- 10b. Sistema detecta clique no backdrop
- 10c. Sistema fecha modal
- 10d. Caso de uso termina

**FA-6: Download de arquivo anexado**
- 9a. Usuário clica em nome de arquivo na comprovação
- 9b. Sistema exibe alerta: "⚠️ Funcionalidade de download não implementada no protótipo."
- 9c. Sistema sugere: "Em produção, arquivo seria baixado do servidor."
- 9d. Fluxo continua no passo 9

**Pós-condições:**
- ✅ Usuário visualizou informações completas
- ✅ Timeline histórica exibida corretamente
- ✅ Modal fechado após visualização
- ✅ Estado da página anterior preservado

**Critérios de Aceite:**

**CA-1: Layout do modal**
- [ ] Modal centralizado, largura máxima 900px
- [ ] Backdrop semi-transparente
- [ ] Scroll vertical se conteúdo exceder altura da viewport
- [ ] Botão "Fechar" (X) no canto superior direito

**CA-2: Seção 1 - Informações**
- [ ] Todos os campos da proposição exibidos
- [ ] Correição vinculada exibida (número + temática)
- [ ] Badges coloridos para tipo, prioridade, status
- [ ] Tags exibidas com badges coloridos inline
- [ ] Descrição completa (sem truncamento)
- [ ] Datas formatadas em DD/MM/AAAA

**CA-3: Seção 2 - Timeline**
- [ ] Título exibe contador de entradas: "Histórico de Interações (5 entradas)"
- [ ] Ordenação cronológica (mais antiga no topo, mais recente embaixo)
- [ ] Linha vertical conectando entradas (visual de timeline)
- [ ] Cada entrada com marcador colorido (círculo)

**CA-4: Entrada de Publicação**
- [ ] Ícone 📤 e fundo laranja claro
- [ ] Data/hora formatada (DD/MM/AAAA HH:mm)
- [ ] Usuário: "Corregedoria Nacional"
- [ ] Prazo de Comprovação destacado
- [ ] Observações exibidas se houver
- [ ] Status anterior → status novo (badges)

**CA-5: Entrada de Comprovação**
- [ ] Ícone 📎 e fundo azul claro
- [ ] Usuário: "[ramoMP] - [ramoMPNome]"
- [ ] Descrição do adimplemento (texto completo)
- [ ] Lista de arquivos anexados (ícone 📄 + nome)
- [ ] Observações adicionais (se houver)

**CA-6: Entrada de Avaliação**
- [ ] Ícone ⚖️ e fundo verde claro
- [ ] Usuário: "Corregedoria Nacional"
- [ ] Decisão exibida como badge colorido (finalizada/parcial/em_andamento/prejudicada)
- [ ] Parecer técnico (texto completo)
- [ ] Status anterior → status novo

**CA-7: Interação**
- [ ] Clique em "Fechar" fecha modal
- [ ] Tecla ESC fecha modal
- [ ] Clique no backdrop fecha modal
- [ ] Clique dentro do modal NÃO fecha

**Regras de Negócio:**

**RN-044:** Timeline deve exibir entradas em **ordem cronológica crescente** (mais antiga primeiro). Facilita compreensão do fluxo de trabalho.

**RN-045:** Cada tipo de entrada (publicação, comprovação, avaliação) deve ter **diferenciação visual clara** (cor, ícone).

**RN-046:** Modal de detalhes é **somente leitura**. Nenhuma ação de edição/exclusão disponível.

**RN-047:** Se proposição possui múltiplas publicações (republicações), **todas devem ser exibidas** na timeline. Não ocultar histórico.

---

### UC-013: Excluir Proposição

**Ator Principal:** Corregedor Nacional (Admin)

**Objetivo:** Remover uma proposição do sistema.

**Pré-condições:**
- Usuário autenticado como Admin (idealmente Corregedor Nacional)
- Proposição com status processual 'pendente' (nunca publicada)
- Proposição sem histórico de interações

**Fluxo Principal:**

1. Usuário identifica proposição a ser excluída
2. Usuário clica em botão "🗑️ Excluir" (visível apenas para proposições pendentes)
3. Sistema verifica status da proposição
4. Sistema verifica se `historico.length === 0`
5. Sistema exibe diálogo de confirmação:
   ```
   ⚠️ Atenção!
   Deseja realmente excluir a proposição "PROP-2024-0014"?
   Esta ação não pode ser desfeita.

   [Cancelar] [Confirmar Exclusão]
   ```
6. Usuário clica em "Confirmar Exclusão"
7. Sistema remove proposição do array `proposicoes[]`
8. Sistema salva em `localStorage`
9. Sistema recalcula status da correição vinculada
10. Sistema atualiza tabela removendo linha
11. Sistema exibe mensagem: "✅ Proposição excluída com sucesso!"

**Fluxos Alternativos:**

**FA-1: Cancelar exclusão**
- 6a. Usuário clica em "Cancelar"
- 6b. Sistema fecha diálogo
- 6c. Sistema exibe mensagem: "Exclusão cancelada."
- 6d. Caso de uso termina

**FA-2: Proposição já publicada (bloqueio)**
- 3a. Sistema detecta `status[0] !== 'pendente'`
- 3b. Sistema exibe alerta:
   ```
   ❌ Exclusão Bloqueada
   Esta proposição já foi publicada (status: Aguardando Comprovação).
   Não é possível excluir proposições publicadas.

   Proposições publicadas fazem parte do histórico oficial da correição
   e não podem ser removidas para preservar integridade da auditoria.

   [Entendi]
   ```
- 3c. Caso de uso termina

**FA-3: Proposição com histórico (bloqueio)**
- 4a. Sistema detecta `historico.length > 0`
- 4b. Sistema exibe alerta:
   ```
   ❌ Exclusão Bloqueada
   Esta proposição possui histórico de interações (X entradas).
   Não é possível excluir proposições com histórico.

   Histórico existente:
   - Publicações: Y
   - Comprovações: Z
   - Avaliações: W

   [Entendi]
   ```
- 4c. Caso de uso termina

**FA-4: Proposição encerrada**
- 3a. Sistema detecta `status[0] === 'encerrada'`
- 3b. Sistema permite exclusão (proposição finalizada)
- 3c. Sistema exibe confirmação adicional: "Esta proposição está encerrada. Tem certeza?"
- 3d. Fluxo continua no passo 6

**Pós-condições:**
- ✅ Proposição removida do sistema
- ✅ `localStorage` atualizado
- ✅ Status da correição recalculado
- ✅ Tabela atualizada

**Critérios de Aceite:**

**CA-1: Botão de exclusão condicional**
- [ ] Botão "Excluir" visível apenas se `status[0] === 'pendente'`
- [ ] Botão oculto para proposições em outros status
- [ ] Tooltip explica: "Apenas proposições pendentes podem ser excluídas"

**CA-2: Verificação de histórico**
- [ ] Sistema impede exclusão se `historico.length > 0`
- [ ] Mensagem de erro lista quantas entradas existem
- [ ] Mensagem separa por tipo (publicações, comprovações, avaliações)

**CA-3: Confirmação de exclusão**
- [ ] Diálogo de confirmação obrigatório
- [ ] Botão "Confirmar Exclusão" em vermelho (danger)
- [ ] Aviso sobre irreversibilidade

**CA-4: Exclusão efetiva**
- [ ] Proposição removida do array `proposicoes[]`
- [ ] `localStorage.proposicoes` atualizado
- [ ] Linha removida da tabela sem reload
- [ ] Contador de proposições da correição atualizado

**CA-5: Recálculo de status da correição**
- [ ] Status da correição recalculado após exclusão
- [ ] Se última proposição, correição pode mudar para 'inativo'
- [ ] Dashboard atualizado automaticamente

**Regras de Negócio:**

**RN-048:** **Apenas proposições pendentes** (nunca publicadas) podem ser excluídas. Preservar integridade de auditoria.

**RN-049:** Proposições com **histórico não podem ser excluídas**, mesmo se status for 'encerrada'. Preservar rastreabilidade.

**RN-050:** Exclusão de proposição é **irreversível**. Confirmação dupla obrigatória.

**RN-051:** Em produção, implementar **soft delete** (flag `deleted: true`). Protótipo usa hard delete.

---

## 6. Casos de Uso - Publicação

### UC-014: Publicar Proposições em Lote

**Ator Principal:** Corregedor Nacional, Assessor (Admin)

**Objetivo:** Publicar múltiplas proposições simultaneamente, definindo prazo de comprovação.

**Pré-condições:**
- Usuário autenticado como Admin
- Usuário acessa `publicacao.html`
- Pelo menos uma proposição com status 'pendente' cadastrada

**Fluxo Principal:**

1. Usuário clica em "Publicar Proposições" no menu lateral
2. Sistema redireciona para `publicacao.html`
3. Sistema valida acesso (apenas Admin)
4. Sistema carrega sessão de `localStorage`
5. Sistema exibe **placeholder**: "Selecione uma Correição para visualizar proposições pendentes"
6. Sistema oculta seções de filtros, tabela e formulário
7. Sistema popula dropdown "Correição" (todas as correições)
8. Usuário seleciona correição no dropdown
9. Sistema exibe **painel informativo**:
   - Temática
   - Órgão Correicionado (ramoMPNome)
   - Total de Proposições Pendentes
10. Sistema exibe **seção de filtros**:
    - Busca (texto livre)
    - Tipo (Determinação/Recomendação)
    - Tag (11 opções)
    - Prioridade (3 opções)
    - Botão "Limpar Filtros"
11. Sistema exibe **tabela com checkboxes** (8 colunas):
    - ☐ Checkbox (master checkbox no header)
    - Número
    - Tipo
    - Unidade
    - Descrição (truncada)
    - Tags (badges)
    - Prioridade (com cor)
    - Ações (botão "Ver")
12. Sistema filtra: `proposicoes.filter(p => p.correicaoId === id && p.status[0] === 'pendente')`
13. Sistema exibe contador: "X proposições pendentes"
14. Sistema exibe botões de seleção:
    - "☑️ Selecionar Todas"
    - "☐ Desmarcar Todas"
15. Sistema oculta formulário de publicação (aguarda seleção)
16. Usuário marca checkboxes (individual ou em lote)
17. Sistema atualiza contador: "X selecionada(s)"
18. Sistema exibe **formulário de publicação** (progressive disclosure):
    - Título: "Publicar X Proposição(ões)"
    - **Prazo de Comprovação** (obrigatório, date picker)
    - **Observações** (opcional, textarea até 1.000 caracteres)
    - Botões: "Cancelar" e "Publicar X Proposição(ões)"
19. Sistema faz auto-scroll para formulário
20. Usuário define prazo de comprovação (ex: 30 dias a partir de hoje)
21. Usuário preenche observações (opcional)
22. Usuário clica em "Publicar X Proposição(ões)"
23. Sistema exibe diálogo de confirmação:
    ```
    📤 Confirmar Publicação

    Você está prestes a publicar 5 proposições:
    - Prazo de Comprovação: 31/01/2025
    - Órgão Destinatário: MPBA

    As proposições serão enviadas automaticamente por e-mail.

    [Cancelar] [Confirmar Publicação]
    ```
24. Usuário confirma
25. Sistema itera sobre proposições selecionadas:
    - 25a. Atualiza `status[0] = 'aguardando_comprovacao'` (mantém valoração)
    - 25b. Define `prazoComprovacao` (mesma data para todas)
    - 25c. Define `dataPublicacao` (hoje)
    - 25d. Adiciona entrada em `historico[]`:
      ```javascript
      {
        tipo: 'publicacao',
        data: '2025-01-01T10:30:00Z',
        usuario: 'Corregedoria Nacional',
        descricao: 'Proposição publicada para MPBA - Ministério Público do Estado da Bahia',
        observacoes: '...',
        prazoComprovacao: '2025-01-31',
        statusAnterior: ['pendente', 'nova'],
        statusNovo: ['aguardando_comprovacao', 'nova']
      }
      ```
26. Sistema salva em `localStorage`
27. Sistema limpa seleção de checkboxes
28. Sistema oculta formulário de publicação
29. Sistema atualiza tabela (proposições publicadas removidas da lista de pendentes)
30. Sistema atualiza contador: "X proposições pendentes" (novo total)
31. Sistema exibe mensagem:
    ```
    ✅ Publicação Concluída!
    5 proposições foram publicadas com sucesso.

    O órgão correicionado receberá notificação automática por e-mail.
    Prazo de comprovação: 31/01/2025
    ```

**Fluxos Alternativos:**

**FA-1: Nenhuma proposição pendente**
- 12a. Filtro não retorna proposições com status 'pendente'
- 12b. Sistema exibe mensagem: "Esta correição não possui proposições pendentes para publicação."
- 12c. Sistema exibe sugestão: "Cadastre novas proposições ou selecione outra correição."
- 12d. Sistema oculta tabela e formulário
- 12e. Caso de uso termina

**FA-2: Cancelar publicação**
- 24a. Usuário clica em "Cancelar" no diálogo
- 24b. Sistema fecha diálogo
- 24c. Sistema mantém seleção e formulário
- 24d. Sistema exibe mensagem: "Publicação cancelada."
- 24e. Caso de uso retorna ao passo 22

**FA-3: Desmarcar todas**
- 18a. Usuário clica em "☐ Desmarcar Todas"
- 18b. Sistema desmarca todos os checkboxes
- 18c. Sistema atualiza contador: "0 selecionada(s)"
- 18d. Sistema oculta formulário de publicação
- 18e. Fluxo retorna ao passo 16

**FA-4: Master checkbox**
- 16a. Usuário clica no checkbox do header da tabela
- 16b. Sistema marca TODOS os checkboxes visíveis (filtrados)
- 16c. Sistema atualiza contador
- 16d. Sistema exibe formulário
- 16e. Usuário clica novamente no master checkbox
- 16f. Sistema desmarca todos
- 16g. Sistema oculta formulário
- 16h. Fluxo retorna ao passo 16

**FA-5: Filtrar antes de selecionar**
- 16a. Usuário aplica filtro por prioridade "urgente"
- 16b. Sistema exibe apenas proposições urgentes
- 16c. Usuário clica em "Selecionar Todas"
- 16d. Sistema seleciona apenas as filtradas (não todas as pendentes)
- 16e. Fluxo continua no passo 17

**FA-6: Republicação (proposição com histórico)**
- 25a. Proposição já foi publicada anteriormente (possui entrada 'publicacao' em historico)
- 25b. Sistema permite republicação normalmente
- 25c. Sistema adiciona NOVA entrada no historico (não substitui anterior)
- 25d. Sistema mantém histórico completo (múltiplas publicações)
- 25e. Fluxo continua no passo 26

**Pós-condições:**
- ✅ Proposições publicadas (status alterado)
- ✅ Prazo de comprovação definido (mesma data para todas)
- ✅ Histórico atualizado com entrada de publicação
- ✅ Dados persistidos em `localStorage`
- ✅ Tabela de pendentes atualizada
- ✅ Notificação de e-mail mencionada (implementação futura)

**Critérios de Aceite:**

**CA-1: Access control**
- [ ] Apenas Admin acessa publicacao.html
- [ ] User redirecionado para index.html com mensagem de erro
- [ ] Breadcrumb visível: "← Voltar ao Dashboard"

**CA-2: Progressive disclosure**
- [ ] Ao carregar: apenas placeholder e dropdown visíveis
- [ ] Após selecionar correição: painel info + filtros + tabela aparecem
- [ ] Após selecionar proposições: formulário aparece e auto-scroll

**CA-3: Seleção obrigatória de correição**
- [ ] Dropdown sempre visível no topo
- [ ] Opção vazia exibe placeholder novamente
- [ ] Mudança de correição limpa seleção de checkboxes

**CA-4: Filtro de proposições pendentes**
- [ ] Tabela exibe APENAS proposições com `status[0] === 'pendente'`
- [ ] Proposições em outros status NÃO aparecem
- [ ] Contador preciso de pendentes

**CA-5: Sistema de checkboxes**
- [ ] Checkbox individual em cada linha
- [ ] Master checkbox no header da tabela
- [ ] Botões "Selecionar Todas" e "Desmarcar Todas"
- [ ] Contador em tempo real: "X selecionada(s)"
- [ ] Row highlighting: linha selecionada com background azul claro

**CA-6: Formulário de publicação**
- [ ] Aparece apenas quando X > 0 proposições selecionadas
- [ ] Desaparece quando X = 0
- [ ] Auto-scroll suave para formulário ao aparecer
- [ ] Campo prazo obrigatório (HTML5 validation)
- [ ] Observações opcional, max 1.000 caracteres com contador

**CA-7: Confirmação de publicação**
- [ ] Diálogo exibe contagem de proposições
- [ ] Diálogo exibe prazo formatado (DD/MM/AAAA)
- [ ] Diálogo exibe órgão destinatário (ramoMPNome)
- [ ] Menciona envio automático de e-mail

**CA-8: Publicação em batch**
- [ ] Todas as proposições selecionadas processadas em único loop
- [ ] Mesma data de publicação (hoje)
- [ ] Mesmo prazo de comprovação
- [ ] Mesmas observações (se houver)
- [ ] Histórico individual por proposição (não compartilhado)

**CA-9: Atualização de UI pós-publicação**
- [ ] Checkboxes desmarcados
- [ ] Formulário oculto
- [ ] Tabela atualizada (proposições publicadas removidas)
- [ ] Contador de pendentes atualizado
- [ ] Mensagem de sucesso exibida

**CA-10: Republicação suportada**
- [ ] Sistema permite publicar proposição que já foi publicada antes
- [ ] Nova entrada adicionada ao historico (append)
- [ ] Entrada anterior preservada (não substituída)
- [ ] Novo prazo sobrescreve prazo anterior

**Regras de Negócio:**

**RN-052:** Publicação define **único prazo de comprovação** para TODAS as proposições selecionadas. Batch operation.

**RN-053:** Publicação **sempre adiciona** nova entrada ao historico, nunca substitui. Suporta múltiplas publicações (republicação).

**RN-054:** Proposições publicadas mudam status de **'pendente' → 'aguardando_comprovacao'**. Valoração permanece inalterada.

**RN-055:** Sistema menciona **notificação automática por e-mail** na mensagem de sucesso. Implementação futura com backend.

**RN-056:** Filtros aplicados na tabela **afetam** o comportamento de "Selecionar Todas". Apenas proposições visíveis são selecionadas.

---

### UC-015: Cancelar Publicação em Andamento

**Ator Principal:** Corregedor Nacional, Assessor (Admin)

**Objetivo:** Cancelar processo de publicação antes de confirmar, limpando seleção.

**Pré-condições:**
- Usuário em `publicacao.html` (UC-014)
- Pelo menos uma proposição selecionada
- Formulário de publicação visível

**Fluxo Principal:**

1. Usuário tem proposições selecionadas
2. Formulário de publicação está visível
3. Usuário clica em botão "Cancelar" no formulário
4. Sistema exibe diálogo de confirmação:
   ```
   ⚠️ Cancelar Publicação?

   Você possui 5 proposições selecionadas.
   Ao cancelar, a seleção será perdida e você precisará selecionar novamente.

   [Voltar] [Confirmar Cancelamento]
   ```
5. Usuário clica em "Confirmar Cancelamento"
6. Sistema desmarca todos os checkboxes
7. Sistema atualiza contador: "0 selecionada(s)"
8. Sistema oculta formulário de publicação
9. Sistema limpa campos do formulário
10. Sistema exibe mensagem: "Publicação cancelada. Seleção limpa."
11. Sistema mantém filtros e tabela (não reseta)

**Fluxos Alternativos:**

**FA-1: Voltar ao formulário**
- 5a. Usuário clica em "Voltar"
- 5b. Sistema fecha diálogo
- 5c. Sistema mantém seleção e formulário
- 5d. Caso de uso termina

**FA-2: Cancelar sem seleção**
- 1a. Formulário não está visível (nenhuma proposição selecionada)
- 1b. Botão "Cancelar" não existe
- 1c. Caso de uso não se aplica

**Pós-condições:**
- ✅ Seleção de checkboxes limpa
- ✅ Formulário oculto
- ✅ Contador zerado
- ✅ Tabela e filtros preservados

**Critérios de Aceite:**

**CA-1: Confirmação obrigatória**
- [ ] Diálogo de confirmação exibido antes de limpar
- [ ] Diálogo menciona quantidade de proposições selecionadas
- [ ] Usuário pode voltar sem perder seleção

**CA-2: Limpeza completa**
- [ ] Todos os checkboxes desmarcados
- [ ] Contador exibe "0 selecionada(s)"
- [ ] Formulário oculto
- [ ] Campos do formulário resetados

**CA-3: Preservação de contexto**
- [ ] Correição selecionada mantida
- [ ] Filtros aplicados preservados
- [ ] Tabela não recarregada
- [ ] Scroll position mantida

**Regras de Negócio:**

**RN-057:** Cancelamento deve ter **confirmação** para evitar perda acidental de seleção.

**RN-058:** Cancelamento **não afeta** filtros ou seleção de correição. Apenas limpa checkboxes.

---

### UC-016: Visualizar Proposições para Comprovação

**Ator Principal:** Procurador-Geral, Promotor (User)

**Objetivo:** Acessar lista de proposições aguardando comprovação do órgão do usuário.

**Pré-condições:**
- Usuário autenticado como User
- Usuário na página "Enviar Comprovação" (index.html#enviar)

**Fluxo Principal:**

1. Usuário clica em "Enviar Comprovação" no menu lateral
2. Sistema executa `showPage('enviar')`
3. Sistema carrega proposições do ramoMP do usuário:
   ```javascript
   const minhasProposicoes = proposicoes.filter(p => {
     const correicao = correicoes.find(c => c.id === p.correicaoId);
     return correicao.ramoMP === currentUser.ramoMP
       && p.status[0] === 'aguardando_comprovacao';
   });
   ```
4. Sistema exibe **tabela** com 6 colunas:
   - Número
   - Correição (número)
   - Descrição (truncada)
   - Prazo de Comprovação (com destaque se vencido)
   - Status (badges empilhados)
   - Ações (2 botões: Ver, Adicionar/Editar)
5. Sistema ordena por prazo crescente (mais urgentes primeiro)
6. Sistema exibe contador: "X proposições aguardando comprovação"
7. Sistema aplica destaque visual:
   - Prazo vencido: linha com fundo vermelho claro
   - Prazo próximo (< 7 dias): linha com fundo amarelo claro
   - Prazo normal: sem destaque
8. Usuário visualiza lista

**Fluxos Alternativos:**

**FA-1: Nenhuma proposição aguardando comprovação**
- 3a. Filtro não retorna proposições
- 3b. Sistema exibe mensagem:
   ```
   ✅ Nenhuma Comprovação Pendente

   Seu órgão não possui proposições aguardando comprovação no momento.

   Ações disponíveis:
   - Consultar histórico em "Proposições"
   - Verificar comprovações em análise
   ```
- 3c. Sistema exibe ícone celebrativo (🎉)
- 3d. Caso de uso termina

**FA-2: Visualizar detalhes**
- 8a. Usuário clica em botão "👁️ Ver"
- 8b. Sistema executa UC-012 (Visualizar Detalhes)
- 8c. Modal exibe informações completas + timeline
- 8d. Fluxo retorna ao passo 8

**FA-3: Adicionar comprovação**
- 8a. Usuário clica em botão "➕ Adicionar"
- 8b. Sistema verifica se já existe rascunho
- 8c. Sistema redireciona para `comprovacao.html?id={proposicaoId}`
- 8d. UC-018 é executado

**FA-4: Editar rascunho existente**
- 8a. Proposição possui rascunho (`rascunhos.length > 0`)
- 8b. Botão exibe "✏️ Editar" ao invés de "Adicionar"
- 8c. Usuário clica em "Editar"
- 8d. Sistema redireciona para `comprovacao.html?id={proposicaoId}`
- 8e. Sistema auto-carrega rascunho
- 8f. UC-018 é executado (modo edição)

**FA-5: Proposição com prazo vencido**
- 7a. Sistema detecta `prazoComprovacao < hoje`
- 7b. Sistema aplica fundo vermelho claro na linha
- 7c. Sistema exibe badge "⚠️ VENCIDO" ao lado da data
- 7d. Sistema exibe tooltip: "Prazo expirado há X dias. Envie comprovação com urgência."
- 7e. Fluxo continua no passo 8

**Pós-condições:**
- ✅ Lista de proposições exibida
- ✅ Proposições filtradas por ramoMP
- ✅ Apenas status 'aguardando_comprovacao' exibido
- ✅ Destaque visual para prazos aplicado

**Critérios de Aceite:**

**CA-1: Filtro automático por ramoMP**
- [ ] Usuário vê apenas proposições do seu MP
- [ ] Filtro aplicado transparentemente (sem UI explícita)
- [ ] Correições de outros MPs não aparecem

**CA-2: Filtro por status processual**
- [ ] Tabela exibe APENAS proposições com `status[0] === 'aguardando_comprovacao'`
- [ ] Proposições pendentes não aparecem
- [ ] Proposições em análise não aparecem
- [ ] Proposições encerradas não aparecem

**CA-3: Ordenação por prazo**
- [ ] Proposições ordenadas por `prazoComprovacao` crescente
- [ ] Proposição com prazo mais próximo aparece no topo
- [ ] Proposições vencidas aparecem primeiro (data mais antiga)

**CA-4: Destaque de prazo**
- [ ] Prazo vencido: fundo vermelho claro (#ffe5e5), badge "⚠️ VENCIDO"
- [ ] Prazo < 7 dias: fundo amarelo claro (#fff9e5), sem badge
- [ ] Prazo >= 7 dias: sem destaque

**CA-5: Coluna de ações**
- [ ] Botão "Ver" sempre visível
- [ ] Botão "Adicionar" se `rascunhos.length === 0`
- [ ] Botão "Editar" se `rascunhos.length > 0`
- [ ] Tooltip explica diferença entre Adicionar/Editar

**CA-6: Contador preciso**
- [ ] Contador exibe total de proposições aguardando comprovação
- [ ] Atualiza dinamicamente após envio de comprovação
- [ ] Formato: "X proposições aguardando comprovação"

**Regras de Negócio:**

**RN-059:** User visualiza **apenas proposições publicadas para seu ramoMP**. Filtro automático e transparente.

**RN-060:** Apenas proposições em status **'aguardando_comprovacao'** aparecem nesta lista. Outros status não são exibidos.

**RN-061:** Ordenação por **prazo crescente** prioriza proposições mais urgentes. Facilita priorização do trabalho.

**RN-062:** Destaque visual para **prazos vencidos** (vermelho) e **prazos próximos** (amarelo) alerta usuário sobre urgência.

---

## 7. Casos de Uso - Comprovação

### UC-017: Salvar Rascunho de Comprovação

**Ator Principal:** Procurador-Geral, Promotor (User)

**Objetivo:** Salvar progresso de uma comprovação para concluir posteriormente.

**Pré-condições:**
- Usuário autenticado como User
- Usuário em `comprovacao.html?id={proposicaoId}`
- Proposição com status 'aguardando_comprovacao'

**Fluxo Principal:**

1. Usuário está preenchendo formulário de comprovação
2. Sistema exibe formulário com campos:
   - **Descrição do Adimplemento** (obrigatório, textarea até 7.500 caracteres)
   - **Observações Adicionais** (opcional, textarea até 1.000 caracteres)
   - **Arquivos Anexados** (opcional, drag-and-drop area)
3. Usuário preenche parcialmente "Descrição do Adimplemento"
4. Sistema exibe contador de caracteres em tempo real
5. Usuário adiciona alguns arquivos (opcional)
6. Usuário preenche "Observações Adicionais" (opcional)
7. Usuário clica em botão "💾 Salvar como Rascunho"
8. Sistema valida que pelo menos descrição possui algum conteúdo
9. Sistema cria objeto rascunho:
   ```javascript
   const rascunho = {
     descricao: '...',
     observacoes: '...',
     arquivos: ['documento1.pdf', 'foto_evidencia.jpg'],
     dataModificacao: '2025-01-05T14:30:00Z'
   };
   ```
10. Sistema verifica se já existe rascunho anterior:
    - Se sim: substitui rascunho anterior
    - Se não: adiciona ao array `rascunhos[]`
11. Sistema salva proposição em `localStorage`
12. Sistema exibe mensagem: "💾 Rascunho salvo com sucesso! Última modificação: 05/01/2025 às 14:30"
13. Sistema mantém usuário na página (não redireciona)
14. Usuário pode continuar editando

**Fluxos Alternativos:**

**FA-1: Rascunho vazio (sem descrição)**
- 8a. Sistema detecta descrição vazia ou apenas espaços
- 8b. Sistema exibe alerta: "⚠️ Descrição do adimplemento é obrigatória. Preencha antes de salvar."
- 8c. Sistema destaca campo em vermelho
- 8d. Caso de uso retorna ao passo 3

**FA-2: Sobrescrever rascunho existente**
- 10a. Sistema detecta `rascunhos.length > 0`
- 10b. Sistema exibe diálogo:
   ```
   ℹ️ Rascunho Existente

   Já existe um rascunho salvo em 03/01/2025 às 10:15.
   Deseja substituir pelo rascunho atual?

   [Cancelar] [Substituir]
   ```
- 10c. Usuário confirma "Substituir"
- 10d. Sistema substitui `rascunhos[0]` com novo rascunho
- 10e. Fluxo continua no passo 11

**FA-3: Salvar sem arquivos**
- 5a. Usuário não anexa nenhum arquivo
- 5b. Sistema aceita (arquivos são opcionais)
- 5c. Sistema cria rascunho com `arquivos: []`
- 5d. Fluxo continua no passo 7

**FA-4: Auto-save periódico (futuro)**
- 3a. Sistema detecta 2 minutos de inatividade
- 3b. Sistema salva rascunho automaticamente
- 3c. Sistema exibe notificação discreta: "💾 Rascunho salvo automaticamente"
- 3d. Usuário continua editando
- 3e. Fluxo continua no passo 3

**Pós-condições:**
- ✅ Rascunho salvo em `proposicao.rascunhos[]`
- ✅ Dados persistidos em `localStorage`
- ✅ Usuário permanece na página
- ✅ Status da proposição **não alterado** (continua aguardando_comprovacao)

**Critérios de Aceite:**

**CA-1: Validação mínima**
- [ ] Descrição obrigatória (campo não vazio)
- [ ] Observações opcional (pode estar vazio)
- [ ] Arquivos opcional (array pode estar vazio)
- [ ] Salvar bloqueado se descrição vazia

**CA-2: Substituição de rascunho**
- [ ] Sistema mantém apenas 1 rascunho por proposição
- [ ] Rascunho novo substitui rascunho anterior
- [ ] Diálogo de confirmação antes de substituir
- [ ] Data de modificação atualizada

**CA-3: Persistência**
- [ ] Rascunho salvo em `proposicao.rascunhos[]`
- [ ] `localStorage.proposicoes` atualizado
- [ ] Rascunho recuperável após refresh da página
- [ ] Rascunho recuperável após fechar navegador

**CA-4: Feedback visual**
- [ ] Mensagem de sucesso exibida
- [ ] Timestamp da última modificação exibido
- [ ] Indicador visual "💾 Rascunho salvo" no header da página
- [ ] Botão "Salvar" muda texto para "Atualizar Rascunho" após primeiro save

**CA-5: Não alterar status**
- [ ] Status processual permanece 'aguardando_comprovacao'
- [ ] Valoração não é alterada
- [ ] Histórico não é modificado (rascunho não gera entrada)
- [ ] Proposição não sai da lista de "Enviar Comprovação"

**Regras de Negócio:**

**RN-063:** Rascunho **não altera status** da proposição. Apenas envio final muda para 'em_analise'.

**RN-064:** Rascunho **não gera entrada no histórico**. Apenas envio definitivo é registrado.

**RN-065:** Sistema mantém **apenas 1 rascunho por proposição**. Rascunho novo substitui anterior.

**RN-066:** Rascunho pode ser **editado múltiplas vezes**. Usuário pode salvar progresso incremental.

**RN-067:** Em produção, implementar **auto-save periódico** (a cada 2 minutos de inatividade) para evitar perda de dados.

---

### UC-018: Enviar Comprovação

**Ator Principal:** Procurador-Geral, Promotor (User)

**Objetivo:** Submeter comprovação final de cumprimento de proposição.

**Pré-condições:**
- Usuário autenticado como User
- Usuário em `comprovacao.html?id={proposicaoId}`
- Proposição com status 'aguardando_comprovacao'
- Formulário de comprovação preenchido

**Fluxo Principal:**

1. Usuário preencheu formulário de comprovação:
   - Descrição do Adimplemento (completa)
   - Observações Adicionais (opcional)
   - Arquivos Anexados (opcional)
2. Sistema exibe botão "📤 Enviar Comprovação"
3. Usuário clica em "Enviar Comprovação"
4. Sistema valida campos obrigatórios:
   - Descrição não vazia
   - Descrição ≤ 7.500 caracteres
   - Observações ≤ 1.000 caracteres (se preenchido)
5. Sistema exibe diálogo de confirmação:
   ```
   📤 Confirmar Envio de Comprovação

   Você está prestes a enviar a comprovação para:
   - Proposição: PROP-2024-0002
   - Correição: COR-2024-01
   - Prazo: 31/01/2025

   Após o envio, a Corregedoria Nacional será notificada e a proposição
   entrará em análise. Você poderá acompanhar o resultado posteriormente.

   Arquivos anexados: 2

   [Cancelar] [Confirmar Envio]
   ```
6. Usuário clica em "Confirmar Envio"
7. Sistema obtém correição vinculada: `correicoes.find(c => c.id === proposicao.correicaoId)`
8. Sistema cria entrada no histórico:
   ```javascript
   {
     tipo: 'comprovacao',
     data: '2025-01-06T16:45:00Z',
     usuario: 'MPBA - Ministério Público do Estado da Bahia',
     descricao: 'Implementamos sistema de gestão eletrônica de documentos...',
     observacoes: 'Treinamento da equipe concluído em dezembro/2024.',
     arquivos: ['sistema_ged_implantado.pdf', 'relatorio_treinamento.pdf']
   }
   ```
9. Sistema adiciona entrada ao `historico[]` da proposição
10. Sistema atualiza status: `proposicao.status[0] = 'em_analise'` (mantém valoração)
11. Sistema limpa rascunho: `proposicao.rascunhos = []`
12. Sistema salva em `localStorage`
13. Sistema exibe mensagem de sucesso:
    ```
    ✅ Comprovação Enviada com Sucesso!

    Sua comprovação foi registrada e a Corregedoria Nacional foi notificada.

    Próximos passos:
    - A proposição entrará em análise pela Corregedoria
    - Você receberá notificação quando houver avaliação
    - Acesse "Proposições" para acompanhar o status

    Enviado em: 06/01/2025 às 16:45
    ```
14. Sistema aguarda 3 segundos
15. Sistema redireciona para `index.html#enviar`
16. Usuário retorna à lista de proposições (proposição enviada não aparece mais)

**Fluxos Alternativos:**

**FA-1: Validação falha**
- 4a. Sistema detecta descrição vazia
- 4b. Sistema exibe alerta: "⚠️ Descrição do adimplemento é obrigatória."
- 4c. Sistema destaca campo em vermelho
- 4d. Caso de uso retorna ao passo 1

**FA-2: Descrição excede limite**
- 4a. Sistema detecta descrição > 7.500 caracteres
- 4b. Sistema exibe alerta: "⚠️ Descrição excede limite de 7.500 caracteres."
- 4c. Sistema exibe contador em vermelho: "7501/7500"
- 4d. Caso de uso retorna ao passo 1

**FA-3: Cancelar envio**
- 6a. Usuário clica em "Cancelar" no diálogo
- 6b. Sistema fecha diálogo
- 6c. Sistema mantém dados no formulário
- 6d. Sistema exibe mensagem: "Envio cancelado. Você pode revisar antes de enviar."
- 6e. Caso de uso retorna ao passo 3

**FA-4: Envio sem arquivos**
- 1a. Usuário não anexou nenhum arquivo
- 1b. Sistema aceita (arquivos são opcionais)
- 1c. Sistema cria historico com `arquivos: []`
- 1d. Fluxo continua no passo 3

**FA-5: Comprovação após prazo vencido**
- 7a. Sistema detecta `prazoComprovacao < hoje`
- 7b. Sistema permite envio normalmente
- 7c. Sistema adiciona nota no diálogo: "⚠️ Atenção: Prazo expirado há X dias."
- 7d. Sistema registra no historico com flag `atrasada: true` (futuro)
- 7e. Fluxo continua no passo 6

**FA-6: Enviar a partir de rascunho**
- 1a. Usuário editou rascunho existente
- 1b. Sistema carregou dados do rascunho automaticamente
- 1c. Usuário finalizou edição
- 1d. Fluxo continua no passo 3
- 11a. Sistema limpa rascunho após envio bem-sucedido

**Pós-condições:**
- ✅ Comprovação registrada no histórico
- ✅ Status alterado para 'em_analise'
- ✅ Rascunho limpo (se houver)
- ✅ Dados persistidos em `localStorage`
- ✅ Usuário redirecionado para lista
- ✅ Proposição não aparece mais em "Enviar Comprovação"

**Critérios de Aceite:**

**CA-1: Validação completa**
- [ ] Descrição obrigatória e não vazia
- [ ] Descrição ≤ 7.500 caracteres
- [ ] Observações ≤ 1.000 caracteres (se preenchido)
- [ ] Submit bloqueado se validação falha

**CA-2: Diálogo de confirmação**
- [ ] Exibe número da proposição
- [ ] Exibe prazo de comprovação
- [ ] Exibe contagem de arquivos anexados
- [ ] Menciona notificação à Corregedoria
- [ ] Botão "Confirmar Envio" destacado (verde)

**CA-3: Entrada no histórico**
- [ ] Tipo: 'comprovacao'
- [ ] Data/hora atual (ISO timestamp)
- [ ] Usuário: "ramoMP - ramoMPNome"
- [ ] Descrição completa preservada
- [ ] Observações preservadas (se houver)
- [ ] Lista de arquivos preservada

**CA-4: Mudança de status**
- [ ] Status processual: 'aguardando_comprovacao' → 'em_analise'
- [ ] Valoração permanece inalterada (geralmente 'nova')
- [ ] Proposição aparece na lista de avaliação do admin
- [ ] Proposição removida da lista "Enviar Comprovação" do user

**CA-5: Limpeza de rascunho**
- [ ] Array `rascunhos[]` esvaziado: `rascunhos = []`
- [ ] Rascunho não mais recuperável
- [ ] Botão "Editar" não aparece mais na lista

**CA-6: Mensagem de sucesso**
- [ ] Mensagem clara e positiva
- [ ] Menciona próximos passos
- [ ] Exibe timestamp do envio
- [ ] Permanece visível por 3 segundos antes de redirecionar

**CA-7: Redirecionamento**
- [ ] Após 3 segundos, redireciona para `index.html#enviar`
- [ ] Lista de "Enviar Comprovação" recarrega
- [ ] Proposição enviada não aparece mais
- [ ] Contador atualizado automaticamente

**CA-8: Comprovação após prazo**
- [ ] Sistema permite envio mesmo após prazo vencido
- [ ] Aviso exibido no diálogo de confirmação
- [ ] Histórico registra normalmente
- [ ] Admin pode avaliar considerando atraso

**Regras de Negócio:**

**RN-068:** Comprovação **altera status** de 'aguardando_comprovacao' → 'em_analise'. Trigger para fila de avaliação do admin.

**RN-069:** Comprovação **gera entrada no histórico** com tipo 'comprovacao'. Auditoria completa.

**RN-070:** Envio de comprovação **limpa rascunho** existente. Rascunho é descartado após envio bem-sucedido.

**RN-071:** Sistema **permite comprovação após prazo vencido**. Não bloqueia envio tardio (admin pode avaliar considerando atraso).

**RN-072:** Arquivos anexados são **opcionais**. Descrição textual pode ser suficiente para comprovação.

**RN-073:** Em produção, arquivos devem ser **enviados para servidor** (upload real). Protótipo apenas registra nomes.

---

**Fim da Parte 6.2**

---

## 8. Casos de Uso - Avaliação

### UC-019: Acessar Lista de Proposições em Análise

**Ator:** Admin (Corregedor Nacional, Assessor)

**Objetivo:** Visualizar fila de proposições aguardando avaliação após envio de comprovação pelos correicionados.

**Pré-condições:**
- Usuário autenticado como admin
- Pelo menos uma proposição com status `['em_analise', *]`

**Fluxo Principal:**

1. Admin clica em "Avaliar Comprovações" no menu lateral
2. Sistema exibe página "Avaliar Comprovações" (index.html#avaliar)
3. Sistema filtra proposições:
   ```javascript
   const proposicoesEmAnalise = proposicoes.filter(p => p.status[0] === 'em_analise');
   ```
4. Sistema renderiza tabela com 8 colunas:
   - Número
   - Correição (número + ramo do MP)
   - Tipo (badge: Determinação/Recomendação)
   - Descrição (truncada em 100 caracteres)
   - Data da Comprovação (último item do histórico tipo 'comprovacao')
   - Prazo (dataPublicacao + prazoComprovacao)
   - Status (2 badges: [em_analise][valoração])
   - Ações (botão "Avaliar")
5. Sistema ordena proposições por data de comprovação (mais antigas primeiro)
6. Sistema exibe contador: "X proposição(ões) aguardando avaliação"
7. Se prazo de comprovação vencido, exibe ícone ⚠️ e prazo em vermelho
8. Admin visualiza lista completa

**Fluxos Alternativos:**

**FA-1: Nenhuma proposição em análise**
- 3a. Sistema não encontra proposições com status `em_analise`
- 3b. Sistema exibe mensagem: "Nenhuma proposição aguardando avaliação no momento."
- 3c. Sistema exibe ilustração de lista vazia

**FA-2: Filtrar por correição**
- 4a. Admin seleciona correição no dropdown "Filtrar por Correição"
- 4b. Sistema filtra proposições pelo correicaoId
- 4c. Sistema atualiza tabela e contador

**FA-3: Busca textual**
- 4a. Admin digita texto no campo de busca
- 4b. Sistema filtra por número, descrição ou ramo do MP
- 4c. Sistema atualiza tabela em tempo real

**FA-4: Ordenar por prazo**
- 5a. Admin clica no cabeçalho "Prazo"
- 5b. Sistema ordena por prazo vencido primeiro (ordem crescente de data)

**Pós-condições:**
- Admin visualiza fila de avaliação atualizada
- Proposições com prazo vencido destacadas visualmente
- Sistema pronto para avaliação individual

**Critérios de Aceite:**

**CA-1: Filtro automático por status**
- [ ] Tabela exibe APENAS proposições com status `['em_analise', *]`
- [ ] Proposições `pendente`, `aguardando_comprovacao`, `encerrada` não aparecem

**CA-2: Ordenação por data**
- [ ] Proposições mais antigas (comprovação enviada há mais tempo) aparecem primeiro
- [ ] Facilita priorização por ordem de chegada

**CA-3: Indicador de prazo vencido**
- [ ] Ícone ⚠️ vermelho ao lado do prazo
- [ ] Prazo exibido em vermelho
- [ ] Cálculo: `Date.now() > prazoComprovacao`

**CA-4: Contador dinâmico**
- [ ] Atualiza automaticamente após filtros
- [ ] Formato: "X proposição(ões) aguardando avaliação"

**CA-5: Acesso admin-only**
- [ ] Menu "Avaliar Comprovações" oculto para usuário tipo `user`
- [ ] Tentativa de acesso direto via URL redireciona para dashboard

**Regras de Negócio:**

**RN-074:** Fila de avaliação exibe **apenas proposições em_analise**. Proposições pendentes ou aguardando_comprovacao não aparecem.

**RN-075:** Ordenação padrão é **cronológica** (FIFO - First In, First Out). Comprovações mais antigas têm prioridade.

**RN-076:** Prazo vencido é **alerta visual**, não bloqueio. Admin pode avaliar proposições atrasadas normalmente.

**RN-077:** Admin vê **todas as correições** na fila, independente do ramo do MP. Visibilidade total para Corregedoria Nacional.

---

### UC-020: Avaliar Comprovação Individual

**Ator:** Admin (Corregedor Nacional, Assessor)

**Objetivo:** Analisar comprovação enviada pelo correicionado e definir valoração (finalizada/parcial/em_andamento/prejudicada).

**Pré-condições:**
- Usuário autenticado como admin
- Proposição com status `['em_analise', *]`
- Histórico contém entrada tipo 'comprovacao'

**Fluxo Principal:**

1. Admin clica em "Avaliar" na linha da proposição (UC-019)
2. Sistema redireciona para `avaliacao.html?id={proposicaoId}`
3. Sistema carrega dados da proposição do localStorage
4. Sistema renderiza 3 seções na página:
   - **Seção 1: Informações da Proposição**
     - Correição vinculada (número, temática, órgão correicionado)
     - Número, tipo, unidade, membro
     - Descrição completa
     - Status atual (badges)
     - Tags
     - Prazo de comprovação (com destaque se vencido)
   - **Seção 2: Histórico Completo**
     - Timeline vertical com todas as interações (publicacao/comprovacao/avaliacao)
     - Código de cores: laranja (publicacao), azul (comprovacao), verde (avaliacao)
   - **Seção 3: Comprovação Atual (última do histórico)**
     - Data do envio
     - Usuário (ramo do MP)
     - Descrição do adimplemento
     - Observações adicionais
     - Lista de arquivos anexados (links para download)
5. Sistema exibe formulário de avaliação:
   - **Decisão (obrigatório):** Radio buttons com visual de cards
     - ✅ Finalizada (verde)
     - ⚠️ Parcial (laranja)
     - ❌ Em Andamento (vermelho)
     - ⊗ Prejudicada (cinza)
   - **Parecer (obrigatório):** Textarea com 7.500 caracteres máximo
     - Contador em tempo real (verde → amarelo → vermelho)
6. Admin analisa comprovação e anexos
7. Admin seleciona decisão (clique no card visual)
8. Admin redige parecer justificando decisão
9. Admin clica em "Enviar Avaliação"
10. Sistema valida campos obrigatórios
11. Sistema exibe diálogo de confirmação:
    - "Confirma avaliação como [DECISÃO] para proposição [NUMERO]?"
    - "Esta ação não poderá ser desfeita."
12. Admin confirma
13. Sistema atualiza proposição:
    ```javascript
    // Se decisão = 'parcial' ou 'em_andamento':
    proposicao.status = ['pendente', decisao];  // volta para publicação

    // Se decisão = 'finalizada' ou 'prejudicada':
    proposicao.status = ['encerrada', decisao];  // finaliza ciclo
    ```
14. Sistema cria entrada no histórico:
    ```javascript
    {
      tipo: 'avaliacao',
      data: '2025-01-10T09:15:00Z',
      usuario: 'Corregedoria Nacional',
      descricao: 'Avaliação realizada: Finalizada',
      observacoes: 'Parecer detalhado justificando decisão...',
      statusAnterior: ['em_analise', 'nova'],
      statusNovo: ['encerrada', 'finalizada']
    }
    ```
15. Sistema adiciona ao `historico[]` da proposição
16. Sistema salva no localStorage
17. Sistema exibe mensagem: "✅ Avaliação registrada com sucesso!"
18. Sistema redireciona para `index.html#avaliar` após 2 segundos
19. Fila de avaliação atualiza automaticamente

**Fluxos Alternativos:**

**FA-1: Campos obrigatórios não preenchidos**
- 10a. Sistema detecta decisão não selecionada OU parecer vazio
- 10b. Sistema exibe erro: "Selecione uma decisão e preencha o parecer."
- 10c. Sistema destaca campos obrigatórios em vermelho
- 10d. Retorna para o passo 7

**FA-2: Cancelar avaliação**
- 9a. Admin clica em "Voltar" ou breadcrumb
- 9b. Sistema exibe confirmação: "Descartar avaliação em andamento?"
- 9c. Admin confirma
- 9d. Sistema redireciona para `index.html#avaliar` sem salvar

**FA-3: Decisão Parcial - Republicação**
- 13a. Decisão selecionada = 'parcial'
- 13b. Sistema define `status = ['pendente', 'parcial']`
- 13c. Proposição retorna para fila de publicação
- 13d. Admin deverá republicar com novo prazo (UC-014)

**FA-4: Decisão Em Andamento - Republicação**
- 13a. Decisão selecionada = 'em_andamento'
- 13b. Sistema define `status = ['pendente', 'em_andamento']`
- 13c. Proposição retorna para fila de publicação
- 13d. Admin deverá republicar com novo prazo (UC-014)

**FA-5: Prazo vencido**
- 4a. Sistema detecta `Date.now() > prazoComprovacao`
- 4b. Sistema exibe alerta visual: "⚠️ Comprovação enviada após o prazo"
- 4c. Admin avalia normalmente (pode considerar atraso no parecer)

**FA-6: Download de arquivo anexado**
- 6a. Admin clica em arquivo na lista de anexos
- 6b. Sistema informa: "Download não disponível no protótipo"
- 6c. Sistema exibe nome do arquivo (simulação)

**Pós-condições:**
- Avaliação registrada permanentemente no histórico
- Status da proposição atualizado:
  - `['encerrada', 'finalizada']` → ciclo finalizado
  - `['encerrada', 'prejudicada']` → ciclo finalizado
  - `['pendente', 'parcial']` → aguarda republicação
  - `['pendente', 'em_andamento']` → aguarda republicação
- Proposição removida da fila de avaliação
- Correção status da correição recalculado automaticamente

**Critérios de Aceite:**

**CA-1: Validação de campos obrigatórios**
- [ ] Decisão não selecionada: erro exibido
- [ ] Parecer vazio: erro exibido
- [ ] Ambos preenchidos: permite envio

**CA-2: Visual de decisão (radio cards)**
- [ ] 4 cards com ícones e cores distintas
- [ ] Card selecionado destaca com borda azul
- [ ] Apenas 1 card selecionável por vez

**CA-3: Contador de caracteres**
- [ ] Verde: 0-5000 caracteres
- [ ] Amarelo: 5001-7000 caracteres
- [ ] Vermelho: 7001-7500 caracteres
- [ ] Bloqueia digitação após 7500

**CA-4: Status após avaliação - Encerrada**
- [ ] Finalizada → `['encerrada', 'finalizada']`
- [ ] Prejudicada → `['encerrada', 'prejudicada']`
- [ ] Não aparecem mais na fila de avaliação
- [ ] Não aparecem na fila de publicação

**CA-5: Status após avaliação - Pendente**
- [ ] Parcial → `['pendente', 'parcial']`
- [ ] Em Andamento → `['pendente', 'em_andamento']`
- [ ] Removida da fila de avaliação
- [ ] Aparece na fila de publicação (aguarda republicação)

**CA-6: Histórico append-only**
- [ ] Nova entrada adicionada ao final do array
- [ ] Entradas anteriores preservadas integralmente
- [ ] Timeline cronológica completa

**CA-7: Redirecionamento pós-avaliação**
- [ ] Mensagem de sucesso exibida por 2 segundos
- [ ] Redireciona para `index.html#avaliar`
- [ ] Fila atualizada automaticamente

**CA-8: Diálogo de confirmação**
- [ ] Exibe decisão selecionada no texto
- [ ] Exibe número da proposição
- [ ] Alerta sobre irreversibilidade
- [ ] Opção de cancelar antes de confirmar

**Regras de Negócio:**

**RN-078:** Avaliação **gera entrada no histórico** com tipo 'avaliacao'. Registro permanente e auditável.

**RN-079:** Decisão **finalizada ou prejudicada** encerra o ciclo. Status muda para 'encerrada', não aceita mais comprovações.

**RN-080:** Decisão **parcial ou em_andamento** retorna status para 'pendente'. Exige republicação com novo prazo antes de aceitar nova comprovação.

**RN-081:** Parecer é **obrigatório** e deve ter no mínimo 50 caracteres. Justificativa textual é essencial para auditoria.

**RN-082:** Avaliação é **irreversível**. Uma vez registrada, não pode ser editada ou excluída (apenas nova avaliação após republicação).

**RN-083:** Sistema **recalcula status da correição** automaticamente após avaliação. Se todas as proposições forem finalizadas/prejudicadas, correição torna-se 'inativa'.

---

### UC-021: Solicitar Complementação de Comprovação

**Ator:** Admin (Corregedor Nacional, Assessor)

**Objetivo:** Retornar proposição para correicionado solicitando informações/documentos adicionais sem definir valoração negativa.

**Pré-condições:**
- Usuário autenticado como admin
- Proposição com status `['em_analise', *]`
- Comprovação enviada pelo correicionado

**Fluxo Principal:**

1. Admin acessa página de avaliação (avaliacao.html?id={proposicaoId})
2. Sistema renderiza informações e formulário de avaliação
3. Admin analisa comprovação e identifica necessidade de complementação
4. Admin **não seleciona decisão final** (finalizada/parcial/em_andamento)
5. Admin clica em botão secundário: "🔄 Solicitar Complementação"
6. Sistema exibe modal "Solicitar Complementação":
   - Campo textarea: "Descreva o que precisa ser complementado" (obrigatório, max 2.000 caracteres)
   - Checkbox: "Manter proposição em análise" (marcado por padrão)
   - Botões: "Enviar Solicitação" e "Cancelar"
7. Admin descreve detalhadamente o que falta:
   - Documentos adicionais necessários
   - Esclarecimentos sobre pontos específicos
   - Evidências complementares
8. Admin clica em "Enviar Solicitação"
9. Sistema valida campo obrigatório
10. Sistema exibe confirmação: "Solicitar complementação ao correicionado?"
11. Admin confirma
12. Sistema cria entrada no histórico:
    ```javascript
    {
      tipo: 'complementacao',
      data: '2025-01-12T14:30:00Z',
      usuario: 'Corregedoria Nacional',
      descricao: 'Solicitação de complementação de comprovação',
      observacoes: 'Favor enviar: 1) Portaria de designação do servidor responsável...',
      statusAnterior: ['em_analise', 'nova'],
      statusNovo: ['aguardando_comprovacao', 'nova']  // volta para comprovação
    }
    ```
13. Sistema atualiza status: `proposicao.status = ['aguardando_comprovacao', valoracao_atual]`
14. Sistema mantém `prazoComprovacao` original (ou admin pode definir novo prazo)
15. Sistema salva no localStorage
16. Sistema envia notificação para correicionado (simulação)
17. Sistema exibe mensagem: "✅ Solicitação enviada! Correicionado será notificado."
18. Sistema redireciona para `index.html#avaliar`
19. Proposição sai da fila de avaliação e volta para "aguardando_comprovacao"
20. Correicionado recebe solicitação e pode enviar complementação

**Fluxos Alternativos:**

**FA-1: Campo de solicitação vazio**
- 9a. Sistema detecta textarea vazia
- 9b. Sistema exibe erro: "Descreva o que precisa ser complementado."
- 9c. Retorna para o passo 7

**FA-2: Cancelar solicitação**
- 8a. Admin clica em "Cancelar" no modal
- 8b. Sistema fecha modal sem salvar
- 8c. Retorna para página de avaliação

**FA-3: Definir novo prazo**
- 14a. Admin desmarca "Manter prazo original"
- 14b. Sistema exibe campo de data "Novo Prazo de Comprovação"
- 14c. Admin define nova data (mínimo: hoje + 1 dia)
- 14d. Sistema atualiza `prazoComprovacao` com novo valor

**FA-4: Correicionado já enviou complementações múltiplas**
- 3a. Sistema detecta 3+ entradas tipo 'complementacao' no histórico
- 3b. Sistema exibe alerta: "⚠️ Esta proposição já teve 3 solicitações de complementação. Considere avaliar definitivamente."
- 3c. Admin pode continuar normalmente ou avaliar com decisão final

**Pós-condições:**
- Solicitação registrada no histórico
- Status volta para `aguardando_comprovacao`
- Proposição reaparece na lista do correicionado (UC-016)
- Admin aguarda nova comprovação complementar

**Critérios de Aceite:**

**CA-1: Botão secundário visível**
- [ ] Botão "🔄 Solicitar Complementação" ao lado de "Enviar Avaliação"
- [ ] Estilo secundário (borda, não preenchido)

**CA-2: Modal de solicitação**
- [ ] Campo textarea com contador de caracteres
- [ ] Checkbox "Manter prazo original" marcado por padrão
- [ ] Validação de campo obrigatório

**CA-3: Status após solicitação**
- [ ] Status muda para `['aguardando_comprovacao', valoracao_atual]`
- [ ] Valoração anterior preservada
- [ ] Proposição sai da fila de avaliação

**CA-4: Histórico de complementação**
- [ ] Entrada tipo 'complementacao' adicionada
- [ ] Observações contêm descrição detalhada
- [ ] Timeline exibe com ícone diferenciado (🔄)

**CA-5: Correicionado pode enviar complemento**
- [ ] Proposição reaparece em "Enviar Comprovação"
- [ ] Timeline mostra solicitação de complementação
- [ ] Novo envio adiciona nova entrada tipo 'comprovacao'

**Regras de Negócio:**

**RN-084:** Solicitação de complementação **não é valoração negativa**. Não conta como parcial/em_andamento.

**RN-085:** Proposição retorna para status `aguardando_comprovacao`, permitindo novo envio sem republicação.

**RN-086:** Prazo pode ser **mantido ou redefinido**. Admin decide caso a caso.

**RN-087:** Número de complementações é **ilimitado**, mas sistema alerta após 3 solicitações.

**RN-088:** Cada complementação gera **nova entrada no histórico** tipo 'complementacao'. Timeline completa preservada.

---

### UC-022: Encerrar Proposição sem Comprovação

**Ator:** Admin (Corregedor Nacional)

**Objetivo:** Encerrar proposição como em_andamento quando correicionado não envia comprovação dentro do prazo.

**Pré-condições:**
- Usuário autenticado como admin (Corregedor Nacional)
- Proposição com status `['aguardando_comprovacao', *]`
- Prazo de comprovação vencido: `Date.now() > prazoComprovacao`
- Sem comprovação enviada após prazo

**Fluxo Principal:**

1. Admin acessa "Publicar Proposições" (publicacao.html)
2. Sistema exibe dropdown de correições
3. Admin seleciona correição
4. Sistema renderiza tabela de proposições pendentes
5. Sistema identifica proposições com prazo vencido:
   ```javascript
   const comPrazoVencido = proposicoes.filter(p =>
     p.status[0] === 'aguardando_comprovacao' &&
     new Date(p.prazoComprovacao) < new Date()
   );
   ```
6. Sistema exibe coluna adicional: "Prazo" com ícone ⚠️ vermelho para vencidas
7. Admin identifica proposição sem resposta após prazo
8. Admin clica no botão de ações (⋮) na linha da proposição
9. Sistema exibe menu dropdown:
   - "📋 Ver Detalhes"
   - "⚠️ Encerrar como Em Andamento"
10. Admin clica em "Encerrar como Em Andamento"
11. Sistema exibe modal de confirmação:
    - "⚠️ Encerrar sem comprovação?"
    - Informações: número, tipo, descrição, prazo vencido há X dias
    - Campo textarea: "Justificativa (obrigatório)" - min 100 caracteres
    - Checkbox: "Notificar correicionado sobre inadimplência"
    - Botões: "Confirmar Encerramento" e "Cancelar"
12. Admin preenche justificativa:
    - Ex: "Prazo vencido em DD/MM/AAAA. Sem manifestação do correicionado após 30 dias. Encerramento por descumprimento."
13. Admin mantém checkbox de notificação marcado
14. Admin clica em "Confirmar Encerramento"
15. Sistema valida justificativa (mínimo 100 caracteres)
16. Sistema exibe segunda confirmação: "Esta ação é irreversível. Confirma encerramento como em_andamento?"
17. Admin confirma
18. Sistema atualiza proposição:
    ```javascript
    proposicao.status = ['encerrada', 'em_andamento'];
    ```
19. Sistema cria entrada no histórico:
    ```javascript
    {
      tipo: 'encerramento_administrativo',
      data: '2025-01-15T16:00:00Z',
      usuario: 'Corregedoria Nacional',
      descricao: 'Proposição encerrada como em_andamento - Sem comprovação',
      observacoes: 'Prazo vencido em 31/12/2024. Sem manifestação após 30 dias...',
      statusAnterior: ['aguardando_comprovacao', 'nova'],
      statusNovo: ['encerrada', 'em_andamento']
    }
    ```
20. Sistema salva no localStorage
21. Sistema envia notificação ao correicionado (simulação)
22. Sistema exibe mensagem: "✅ Proposição encerrada como em_andamento."
23. Sistema remove proposição da lista de publicação
24. Correição atualiza contador de em_andamentos

**Fluxos Alternativos:**

**FA-1: Justificativa insuficiente**
- 15a. Sistema detecta justificativa com menos de 100 caracteres
- 15b. Sistema exibe erro: "Justificativa deve ter no mínimo 100 caracteres."
- 15c. Contador exibe caracteres restantes em vermelho
- 15d. Retorna para o passo 12

**FA-2: Cancelar encerramento**
- 14a. Admin clica em "Cancelar" no modal
- 14b. Sistema fecha modal sem salvar
- 14c. Proposição permanece com status `aguardando_comprovacao`

**FA-3: Prazo não vencido**
- 7a. Admin tenta encerrar proposição com prazo vigente
- 7b. Sistema exibe erro: "Não é possível encerrar. Prazo ainda não vencido."
- 7c. Opção "Encerrar como Em Andamento" desabilitada no menu

**FA-4: Comprovação enviada após prazo**
- 8a. Sistema detecta entrada tipo 'comprovacao' no histórico após prazo
- 8b. Sistema exibe alerta: "Esta proposição recebeu comprovação após o prazo. Avalie normalmente em vez de encerrar."
- 8c. Menu não exibe opção de encerramento administrativo

**Pós-condições:**
- Proposição encerrada definitivamente como em_andamento
- Histórico registra encerramento administrativo
- Correicionado notificado sobre inadimplência
- Proposição não aceita mais comprovações
- Status da correição recalculado

**Critérios de Aceite:**

**CA-1: Permissão restrita**
- [ ] Apenas Corregedor Nacional pode encerrar administrativamente
- [ ] Assessor não visualiza opção de encerramento

**CA-2: Validação de prazo**
- [ ] Opção habilitada apenas para proposições com prazo vencido
- [ ] Cálculo: `Date.now() > prazoComprovacao`
- [ ] Menu dropdown mostra status visual (ícone ⚠️)

**CA-3: Justificativa obrigatória**
- [ ] Campo textarea com mínimo 100 caracteres
- [ ] Contador em tempo real
- [ ] Validação antes de permitir confirmação

**CA-4: Dupla confirmação**
- [ ] Modal de confirmação com informações detalhadas
- [ ] Segunda confirmação sobre irreversibilidade
- [ ] Admin deve confirmar duas vezes

**CA-5: Status final**
- [ ] Status = `['encerrada', 'em_andamento']`
- [ ] Proposição não aceita mais comprovações
- [ ] Não aparece em nenhuma fila de trabalho

**CA-6: Notificação ao correicionado**
- [ ] Checkbox "Notificar correicionado" marcado por padrão
- [ ] Sistema simula envio de e-mail
- [ ] Mensagem inclui justificativa do encerramento

**Regras de Negócio:**

**RN-089:** Encerramento administrativo **só é permitido após prazo vencido** sem comprovação. Validação rigorosa de data.

**RN-090:** Justificativa deve ter **mínimo 100 caracteres**. Documentação detalhada é obrigatória para auditoria.

**RN-091:** Encerramento é **irreversível**. Uma vez encerrada como em_andamento, não pode ser reaberta (apenas nova proposição em correição futura).

**RN-092:** Permissão restrita ao **Corregedor Nacional**. Assessores não têm autoridade para encerramento administrativo.

**RN-093:** Sistema deve **verificar histórico** antes de permitir encerramento. Se há comprovação após prazo, deve ser avaliada normalmente (não encerrada administrativamente).

---

## 9. Casos de Uso - Consultas e Relatórios

### UC-023: Consultar Dashboard Consolidado

**Ator:** Admin, User

**Objetivo:** Visualizar indicadores consolidados de correições e proposições com filtros dinâmicos e gráficos.

**Pré-condições:**
- Usuário autenticado (qualquer tipo)
- Dados de correições e proposições em localStorage

**Fluxo Principal:**

1. Usuário faz login no sistema
2. Sistema exibe dashboard automaticamente (index.html#dashboard)
3. Sistema renderiza 5 cartões de estatísticas:
   - 🏛️ **Correições Realizadas:** Total de correições cadastradas
   - 🔄 **Correições Ativas:** Correições com proposições pendentes
   - 📄 **Total de Proposições:** Todas as proposições cadastradas
   - 🔥 **Proposições Ativas:** Proposições não encerradas
   - ⚠️ **Prazo Vencido:** Comprovações atrasadas
4. Sistema aplica filtro de permissão:
   - **Admin:** Visualiza dados de todas as correições
   - **User:** Visualiza apenas correições do seu ramoMP
5. Sistema exibe dropdown "Filtrar por Correição":
   - Opção padrão: "Todas as Correições"
   - Lista de correições disponíveis (filtradas por permissão)
6. Sistema renderiza dois gráficos lado a lado:
   - **Gráfico 1: Fluxo de Trabalho** (4 barras)
     - Pendente (amarelo)
     - Aguardando Comprovação (laranja escuro)
     - Em Análise (azul)
     - Encerrada (azul escuro)
   - **Gráfico 2: Valoração** (5 barras)
     - Nova (cinza)
     - Finalizada (verde)
     - Parcial (laranja)
     - Em Andamento (vermelho)
     - Prejudicada (cinza escuro)
7. Sistema calcula valores dinamicamente:
   ```javascript
   const stats = {
     correicoesRealizadas: correicoes.length,
     correicoesAtivas: correicoes.filter(c => c.status === 'ativo').length,
     totalProposicoes: proposicoes.length,
     proposicoesAtivas: proposicoes.filter(p => p.status[0] !== 'encerrada').length,
     prazoVencido: proposicoes.filter(p =>
       p.status[0] === 'aguardando_comprovacao' &&
       new Date(p.prazoComprovacao) < new Date()
     ).length
   };
   ```
8. Usuário visualiza dashboard completo

**Fluxos Alternativos:**

**FA-1: Filtrar por correição específica**
- 5a. Usuário seleciona correição no dropdown
- 5b. Sistema armazena filtro: `dashboardCorreicaoFilter = correicaoId`
- 5c. Sistema recalcula todos os cartões para correição selecionada:
   ```javascript
   const proposicoesFiltradas = proposicoes.filter(p => p.correicaoId === filtroId);
   ```
- 5d. Sistema atualiza ambos os gráficos
- 5e. Dashboard exibe dados apenas da correição selecionada

**FA-2: Limpar filtro**
- 5a. Usuário seleciona "Todas as Correições" novamente
- 5b. Sistema limpa filtro: `dashboardCorreicaoFilter = null`
- 5c. Sistema recalcula métricas agregadas
- 5d. Gráficos atualizam com todos os dados

**FA-3: Sem dados cadastrados**
- 3a. Sistema detecta `correicoes.length === 0`
- 3b. Sistema exibe mensagem: "Nenhuma correição cadastrada ainda."
- 3c. Sistema exibe botão: "Cadastrar Primeira Correição" (admin only)
- 3d. Cartões exibem valor 0
- 3e. Gráficos exibem mensagem "Sem dados"

**FA-4: User sem correições do seu MP**
- 4a. Sistema filtra correições: `correicoes.filter(c => c.ramoMP === user.ramoMP)`
- 4b. Resultado vazio
- 4c. Sistema exibe: "Nenhuma correição cadastrada para o seu órgão."
- 4d. Cartões e gráficos zerados

**FA-5: Clique em cartão**
- 3a. Usuário clica em cartão "Prazo Vencido"
- 3b. Sistema navega para lista de proposições com filtro pré-aplicado
- 3c. Exibe apenas proposições com prazo vencido

**Pós-condições:**
- Dashboard atualizado com dados em tempo real
- Filtros aplicados persistem durante navegação
- Gráficos renderizados com animação

**Critérios de Aceite:**

**CA-1: Cartões responsivos**
- [ ] Desktop: 5 cartões em grid de 3-2
- [ ] Mobile: 5 cartões empilhados verticalmente
- [ ] Valores animados ao carregar (contagem crescente)

**CA-2: Dropdown de correição**
- [ ] Opção padrão "Todas as Correições" sempre presente
- [ ] Admin vê todas as correições
- [ ] User vê apenas correições do seu ramoMP
- [ ] Ordenação alfabética por número de correição

**CA-3: Gráfico Fluxo de Trabalho**
- [ ] 4 barras verticais com cores distintas
- [ ] Largura das barras: 25% cada (100% / 4)
- [ ] Altura proporcional ao valor (escala automática)
- [ ] Label com valor acima de cada barra
- [ ] Tooltip ao passar mouse (número + percentual)

**CA-4: Gráfico Valoração**
- [ ] 5 barras verticais com cores distintas
- [ ] Largura das barras: 20% cada (100% / 5)
- [ ] Altura proporcional ao valor (escala automática)
- [ ] Label com valor acima de cada barra
- [ ] Tooltip ao passar mouse (número + percentual)

**CA-5: Filtro dinâmico**
- [ ] Mudança no dropdown atualiza cartões imediatamente
- [ ] Ambos os gráficos redesenhados simultaneamente
- [ ] Sem necessidade de recarregar página
- [ ] Animação suave de transição (fade)

**CA-6: Responsividade de gráficos**
- [ ] Desktop (>768px): 2 gráficos lado a lado (grid 2 colunas)
- [ ] Mobile (≤768px): 2 gráficos empilhados (grid 1 coluna)
- [ ] Canvas redimensionável mantém proporção

**CA-7: Permissões aplicadas**
- [ ] Admin vê todos os dados sem restrição
- [ ] User vê apenas dados do seu ramoMP
- [ ] Filtro invisível aplicado antes de cálculos

**Regras de Negócio:**

**RN-094:** Dashboard aplica **filtro automático de permissão**. User vê apenas correições do seu ramoMP, admin vê tudo.

**RN-095:** Filtro por correição é **opcional** e pode ser combinado com filtro de permissão (AND lógico).

**RN-096:** Gráficos usam **cores consistentes** com sistema de badges. Não mudar paleta arbitrariamente.

**RN-097:** Cálculo de "Prazo Vencido" considera **apenas proposições em aguardando_comprovacao**. Proposições em_analise ou encerrada não contam.

**RN-098:** Cartões são **clicáveis** e navegam para páginas relevantes com filtros pré-aplicados (quick access).

---

### UC-024: Filtrar Proposições por Múltiplos Critérios

**Ator:** Admin, User

**Objetivo:** Aplicar filtros combinados para localizar proposições específicas rapidamente.

**Pré-condições:**
- Usuário autenticado
- Página proposicoes.html carregada
- Correição selecionada (obrigatório)

**Fluxo Principal:**

1. Usuário acessa proposicoes.html
2. Sistema exibe placeholder: "Selecione uma Correição"
3. Usuário seleciona correição no dropdown
4. Sistema exibe seção de filtros com 5 campos:
   - 🔍 **Busca:** Campo texto (número, unidade, membro, descrição)
   - 📋 **Tipo:** Dropdown (Todos, Determinação, Recomendação)
   - 🚦 **Status:** Dropdown multi-nível (Processual + Valoração)
   - 🏷️ **Tag:** Dropdown (11 categorias)
   - ⚡ **Prioridade:** Dropdown (Todas, Urgente, Alta, Normal)
5. Sistema exibe botão "🗑️ Limpar Filtros"
6. Usuário aplica filtro 1: seleciona "Tipo = Determinação"
7. Sistema aplica filtro em tempo real:
   ```javascript
   let filtrados = proposicoes.filter(p => p.correicaoId === correicaoSelecionada);
   if (filtroTipo) filtrados = filtrados.filter(p => p.tipo === filtroTipo);
   ```
8. Sistema atualiza tabela e contador: "X proposição(ões) encontrada(s)"
9. Usuário aplica filtro 2: seleciona "Tag = tecnologia"
10. Sistema adiciona filtro à cadeia (AND lógico):
    ```javascript
    if (filtroTag) filtrados = filtrados.filter(p => p.tags.includes(filtroTag));
    ```
11. Sistema atualiza tabela novamente (refinamento)
12. Usuário aplica filtro 3: digita "gestão" na busca
13. Sistema aplica filtro textual (busca em 4 campos):
    ```javascript
    const termo = buscaTexto.toLowerCase();
    filtrados = filtrados.filter(p =>
      p.numero.toLowerCase().includes(termo) ||
      p.unidade.toLowerCase().includes(termo) ||
      p.membro.toLowerCase().includes(termo) ||
      p.descricao.toLowerCase().includes(termo)
    );
    ```
14. Sistema exibe resultado final: "2 proposição(ões) encontrada(s)"
15. Usuário visualiza apenas proposições que atendem TODOS os filtros simultaneamente

**Fluxos Alternativos:**

**FA-1: Nenhuma proposição encontrada**
- 13a. Sistema aplica filtros e `filtrados.length === 0`
- 13b. Sistema exibe mensagem na tabela: "Nenhuma proposição encontrada com os filtros aplicados."
- 13c. Sistema exibe ilustração de busca vazia
- 13d. Contador exibe: "0 proposição(ões) encontrada(s)"

**FA-2: Limpar todos os filtros**
- 6a. Usuário clica em "🗑️ Limpar Filtros"
- 6b. Sistema reseta todos os dropdowns para valor padrão:
   - Tipo: "Todos"
   - Status: "Todos"
   - Tag: "Todas"
   - Prioridade: "Todas"
- 6c. Sistema limpa campo de busca
- 6d. Sistema re-renderiza tabela com todas as proposições da correição
- 6e. Contador atualizado com total sem filtros

**FA-3: Filtro de status - Processual**
- 9a. Usuário seleciona "Status Processual: Pendente"
- 9b. Sistema filtra: `p.status[0] === 'pendente'`
- 9c. Tabela exibe apenas proposições pendentes

**FA-4: Filtro de status - Valoração**
- 9a. Usuário seleciona "Valoração: Finalizada"
- 9b. Sistema filtra: `p.status[1] === 'finalizada'`
- 9c. Tabela exibe apenas proposições finalizadas (independente do status processual)

**FA-5: Filtro de status - Combinado**
- 9a. Usuário seleciona "Processual: Em Análise" E "Valoração: Nova"
- 9b. Sistema filtra: `p.status[0] === 'em_analise' && p.status[1] === 'nova'`
- 9c. Tabela exibe interseção dos dois filtros

**FA-6: Busca sem correição selecionada**
- 2a. Usuário tenta aplicar filtro sem selecionar correição
- 2b. Sistema exibe mensagem: "Selecione uma correição primeiro."
- 2c. Filtros permanecem desabilitados

**FA-7: Filtro por prioridade urgente**
- 9a. Usuário seleciona "Prioridade: Urgente"
- 9b. Sistema filtra: `p.prioridade === 'urgente'`
- 9c. Tabela exibe apenas proposições urgentes (com destaque visual vermelho)

**Pós-condições:**
- Tabela atualizada com proposições filtradas
- Contador reflete número de resultados
- Filtros aplicados preservados durante navegação
- Estado dos filtros salvo em variáveis globais

**Critérios de Aceite:**

**CA-1: Filtros combinados (AND lógico)**
- [ ] Múltiplos filtros aplicados simultaneamente
- [ ] Lógica AND: proposição deve atender TODOS os critérios
- [ ] Ordem de aplicação não altera resultado

**CA-2: Busca textual em tempo real**
- [ ] Atualização a cada tecla digitada (debounce 300ms)
- [ ] Busca case-insensitive
- [ ] Busca em 4 campos: número, unidade, membro, descrição
- [ ] Operador OR entre os 4 campos

**CA-3: Dropdown de status multinível**
- [ ] Opção "Todos" (padrão)
- [ ] Grupo "Status Processual": 4 opções
- [ ] Grupo "Valoração": 5 opções
- [ ] Separador visual entre grupos
- [ ] Pode selecionar de ambos os grupos simultaneamente

**CA-4: Botão Limpar Filtros**
- [ ] Reseta TODOS os filtros para padrão
- [ ] Limpa campo de busca
- [ ] Re-renderiza tabela completa
- [ ] Ícone 🗑️ e texto "Limpar Filtros"

**CA-5: Contador dinâmico**
- [ ] Formato: "X proposição(ões) encontrada(s)"
- [ ] Plural/singular correto
- [ ] Atualização automática a cada filtro
- [ ] Cor: azul quando filtros ativos, preto quando limpo

**CA-6: Estado dos filtros persistente**
- [ ] Filtros mantidos ao navegar entre páginas (mesma sessão)
- [ ] Após reload: filtros resetados (não persistem em localStorage)
- [ ] Variáveis globais armazenam estado atual

**CA-7: Desempenho**
- [ ] Filtro de 1000+ proposições: < 100ms
- [ ] Sem travamento de UI durante filtragem
- [ ] Debounce na busca textual para evitar múltiplas renderizações

**Regras de Negócio:**

**RN-099:** Filtros usam lógica **AND** (interseção). Proposição deve atender a todos os critérios simultaneamente.

**RN-100:** Busca textual usa lógica **OR** entre campos. Basta o termo aparecer em 1 dos 4 campos.

**RN-101:** Seleção de correição é **obrigatória** antes de aplicar filtros. Validação UX.

**RN-102:** Filtros de status podem ser **combinados** (processual + valoração). Ambas as dimensões do array verificadas.

**RN-103:** Botão "Limpar Filtros" **não desmarca correição selecionada**. Apenas reseta filtros secundários.

---

### UC-025: Exportar Dados em JSON

**Ator:** Admin, User

**Objetivo:** Exportar dados de correições ou proposições em formato JSON para análise externa ou backup.

**Pré-condições:**
- Usuário autenticado
- Dados disponíveis na página (correições ou proposições)

**Fluxo Principal:**

1. Usuário acessa página com dados (dashboard, proposicoes.html, etc.)
2. Sistema exibe botão "📥 Exportar" no cabeçalho da página
3. Usuário clica em "📥 Exportar"
4. Sistema exibe menu dropdown com opções:
   - "📄 Exportar JSON" (sempre disponível)
   - "📊 Exportar PDF" (se aplicável)
   - "📧 Exportar Ofício de Publicação" (apenas em publicacao.html)
5. Usuário clica em "📄 Exportar JSON"
6. Sistema identifica contexto e coleta dados:
   - **Dashboard:** Estatísticas + todas as correições + proposições (filtradas por permissão)
   - **Correições:** Lista de correições com estatísticas agregadas
   - **Proposições:** Lista de proposições da correição selecionada (com filtros aplicados)
   - **Publicação:** Proposições pendentes selecionadas para publicação
7. Sistema constrói objeto JSON estruturado:
   ```javascript
   const exportData = {
     titulo: 'Dashboard CNMP - Sistema de Acompanhamento de Proposições',
     dataExportacao: new Date().toISOString(),
     filtroAplicado: dashboardCorreicaoFilter || null,
     usuario: currentUser ? `${currentUser.ramoMP} - ${currentUser.ramoMPNome}` : 'Admin',
     estatisticas: { /* métricas calculadas */ },
     distribuicao: { /* breakdown por status */ },
     correicoes: [ /* array de objetos */ ],
     proposicoes: [ /* array de objetos com histórico completo */ ]
   };
   ```
8. Sistema cria Blob e inicia download:
   ```javascript
   const dataStr = JSON.stringify(exportData, null, 2);  // pretty-print
   const dataBlob = new Blob([dataStr], { type: 'application/json' });
   const url = URL.createObjectURL(dataBlob);
   const link = document.createElement('a');
   link.href = url;
   link.download = `cnmp-dashboard-${new Date().toISOString().split('T')[0]}.json`;
   link.click();
   URL.revokeObjectURL(url);  // limpeza de memória
   ```
9. Sistema exibe toast: "✅ Exportação JSON concluída!"
10. Arquivo baixado para pasta de Downloads do usuário
11. Menu dropdown fecha automaticamente

**Fluxos Alternativos:**

**FA-1: Nenhum dado disponível**
- 6a. Sistema detecta array vazio (correições ou proposições)
- 6b. Sistema exibe alerta: "Nenhum dado disponível para exportação."
- 6c. Menu dropdown fecha sem iniciar download

**FA-2: Exportar proposições filtradas**
- 6a. Usuário está em proposicoes.html com filtros ativos
- 6b. Sistema exporta APENAS proposições visíveis na tabela (respeitando filtros)
- 6c. JSON inclui metadados dos filtros aplicados:
   ```javascript
   filtrosAplicados: {
     busca: 'gestão',
     tipo: 'Determinação',
     status: 'em_analise',
     tag: 'tecnologia',
     prioridade: 'urgente'
   }
   ```

**FA-3: Exportar seleção de publicação**
- 6a. Usuário está em publicacao.html com proposições selecionadas
- 6b. Sistema exporta APENAS proposições marcadas (checkboxes ativos)
- 6c. JSON inclui campo: `totalSelecionadas: 5`

**FA-4: Permissão de user - Filtro automático**
- 6a. Usuário tipo `user` exporta dashboard
- 6b. Sistema aplica filtro: `correicoes.filter(c => c.ramoMP === user.ramoMP)`
- 6c. JSON inclui apenas correições do órgão do usuário
- 6d. Metadados indicam: `usuario: "MPBA - Ministério Público do Estado da Bahia"`

**FA-5: Erro no download**
- 8a. Navegador bloqueia download automático (popup blocker)
- 8b. Sistema exibe instrução: "Permita popups para baixar o arquivo."
- 8c. Usuário ajusta configuração e tenta novamente

**Pós-condições:**
- Arquivo JSON salvo no sistema de arquivos local
- Formato JSON válido (validável via jsonlint.com)
- Pretty-print com indentação de 2 espaços
- Dados completos incluindo histórico de proposições

**Critérios de Aceite:**

**CA-1: Estrutura JSON válida**
- [ ] JSON parseable sem erros
- [ ] Indentação de 2 espaços (legibilidade)
- [ ] Encoding UTF-8 (suporte a caracteres especiais)
- [ ] Campos consistentes em todas as exportações

**CA-2: Metadados completos**
- [ ] `titulo`: Descrição clara da exportação
- [ ] `dataExportacao`: ISO 8601 timestamp
- [ ] `usuario`: Identificação do exportador
- [ ] `filtroAplicado`: Registro de filtros ativos

**CA-3: Histórico completo**
- [ ] Array `historico[]` preservado integralmente
- [ ] Todas as entradas (publicacao/comprovacao/avaliacao)
- [ ] Timestamps e usuários registrados
- [ ] Arquivos anexados listados

**CA-4: Nomenclatura do arquivo**
- [ ] Padrão: `cnmp-{contexto}-{YYYY-MM-DD}.json`
- [ ] Contexto: dashboard, correicoes, proposicoes, publicacao
- [ ] Data no formato ISO (AAAA-MM-DD)
- [ ] Exemplo: `cnmp-dashboard-2025-01-15.json`

**CA-5: Limpeza de memória**
- [ ] `URL.revokeObjectURL()` chamado após download
- [ ] Blob descartado corretamente
- [ ] Sem memory leaks em exportações repetidas

**CA-6: Toast de confirmação**
- [ ] Mensagem: "✅ Exportação JSON concluída!"
- [ ] Duração: 3 segundos
- [ ] Posição: canto superior direito
- [ ] Auto-dismiss após timeout

**Regras de Negócio:**

**RN-104:** Exportação JSON **respeita filtros de permissão**. User exporta apenas dados do seu MP.

**RN-105:** Exportação inclui **histórico completo** de proposições. Auditoria integral preservada.

**RN-106:** Filtros ativos são **registrados nos metadados**. Usuário sabe exatamente o que foi exportado.

**RN-107:** Arquivos anexados são **listados por nome**. Download real dos arquivos não está disponível no protótipo.

**RN-108:** Formato JSON facilita **integração com outras ferramentas**. Pode ser importado em Excel, Power BI, Python, etc.

---

### UC-026: Exportar Relatório em PDF

**Ator:** Admin, User

**Objetivo:** Gerar relatório visual em PDF para impressão ou compartilhamento institucional.

**Pré-condições:**
- Usuário autenticado
- Dados disponíveis na página

**Fluxo Principal:**

1. Usuário acessa página com opção de exportação PDF
2. Sistema exibe botão "📥 Exportar" no cabeçalho
3. Usuário clica em "📥 Exportar"
4. Sistema exibe menu dropdown
5. Usuário clica em "📊 Exportar PDF"
6. Sistema identifica contexto e tipo de relatório:
   - **Dashboard:** Relatório executivo com gráficos
   - **Correições:** Tabela de correições ou relatório detalhado
   - **Proposições:** Relatório completo com timeline
   - **Detalhes:** Relatório de proposição individual
7. Sistema abre nova janela do navegador (popup)
8. Sistema gera HTML estruturado para impressão:
   ```html
   <!DOCTYPE html>
   <html>
   <head>
     <meta charset="UTF-8">
     <title>Relatório CNMP</title>
     <style>
       /* Estilos otimizados para impressão */
       @media print {
         body { padding: 10px; }
         .page-break { page-break-after: always; }
       }
     </style>
   </head>
   <body>
     <div class="header">
       <h1>CONSELHO NACIONAL DO MINISTÉRIO PÚBLICO</h1>
       <p>Relatório Gerado em: ${new Date().toLocaleString('pt-BR')}</p>
     </div>
     <!-- Conteúdo dinâmico -->
   </body>
   </html>
   ```
9. Sistema renderiza conteúdo específico:
   - **Dashboard PDF:** 5 cartões + 2 gráficos (Canvas to Image)
   - **Correições PDF:** Tabela com 13 colunas formatada
   - **Proposições PDF:** Lista de proposições com timeline completa
10. Sistema injeta HTML na nova janela
11. Sistema aguarda renderização completa (onload)
12. Sistema dispara diálogo de impressão: `window.print()`
13. Usuário visualiza preview de impressão do navegador
14. Usuário pode:
    - Salvar como PDF (opção "Salvar como PDF" no diálogo)
    - Imprimir fisicamente
    - Cancelar
15. Após ação, janela popup fecha automaticamente

**Fluxos Alternativos:**

**FA-1: Cancelar impressão**
- 14a. Usuário clica em "Cancelar" no diálogo de impressão
- 14b. Janela popup fecha automaticamente
- 14c. Nenhum arquivo gerado

**FA-2: Relatório detalhado de correições**
- 6a. Usuário seleciona "Exportar Relatório Detalhado" no menu
- 6b. Sistema gera PDF com breakdown completo:
   - Seção por correição
   - Estatísticas de status processual (4 categorias)
   - Estatísticas de valoração (5 categorias)
   - Lista de proposições por correição
- 6c. PDF pode ter múltiplas páginas (page-break automático)

**FA-3: Timeline de proposição individual**
- 6a. Usuário está em modal de detalhes de proposição
- 6b. Usuário clica em "📊 Exportar PDF" no header do modal
- 6c. Sistema gera PDF focado em timeline:
   - Informações da proposição (header)
   - Timeline vertical colorida (laranja/azul/verde)
   - Cada entrada do histórico detalhada
   - Arquivos anexados listados

**FA-4: Ofício de Publicação (publicacao.html)**
- 6a. Usuário está em publicacao.html com proposições selecionadas
- 6b. Menu dropdown exibe opção extra: "📧 Exportar Ofício de Publicação"
- 6c. Sistema gera documento oficial em PDF:
   - Header institucional: CNMP + Corregedoria Nacional
   - Identificação: Ofício nº _____ /CNMP-CN
   - Destinatário: ramoMPNome
   - Corpo formal com referências legais
   - Lista numerada de proposições publicadas
   - Prazo de comprovação destacado
   - Linha de assinatura: Corregedor Nacional
- 6d. Fonte: Times New Roman 12pt (padrão institucional)
- 6e. Espaçamento: line-height 1.8 (documento formal)

**FA-5: Gráficos no PDF Dashboard**
- 9a. Sistema precisa converter canvas de gráficos para imagem
- 9b. Sistema usa `canvas.toDataURL('image/png')`
- 9c. Gráficos inseridos como `<img src="data:image/png;base64,...">` no HTML
- 9d. PDF preserva qualidade visual dos gráficos

**FA-6: Popup bloqueado pelo navegador**
- 7a. Navegador bloqueia abertura de popup
- 7b. Sistema exibe alerta: "Permita popups para gerar PDF."
- 7c. Usuário ajusta configuração e tenta novamente

**Pós-condições:**
- PDF gerado no formato do navegador (via diálogo de impressão)
- Layout otimizado para impressão (media query @print aplicada)
- Documento profissional com branding CNMP
- Janela popup fechada após ação

**Critérios de Aceite:**

**CA-1: Header institucional**
- [ ] Logo CNMP (placeholder ou texto estilizado)
- [ ] Título: "CONSELHO NACIONAL DO MINISTÉRIO PÚBLICO"
- [ ] Subtítulo: "Corregedoria Nacional" ou contexto específico
- [ ] Data e hora de geração

**CA-2: Estilos de impressão**
- [ ] Media query @media print implementada
- [ ] Remoção de elementos de UI (botões, sidebar)
- [ ] Ajuste de margens e padding
- [ ] Page-break para conteúdo longo
- [ ] Cores otimizadas (contraste para impressão P&B)

**CA-3: Gráficos preservados**
- [ ] Canvas convertido para PNG base64
- [ ] Resolução adequada (mínimo 300dpi)
- [ ] Cores mantidas (não degradam em P&B)
- [ ] Labels legíveis

**CA-4: Ofício de Publicação**
- [ ] Formato oficial com Times New Roman 12pt
- [ ] Identificação de ofício (número placeholder)
- [ ] Destinatário correto (ramoMPNome)
- [ ] Lista numerada de proposições
- [ ] Prazo de comprovação em destaque
- [ ] Linha de assinatura formatada

**CA-5: Timeline visual**
- [ ] Cores preservadas: laranja (publicacao), azul (comprovacao), verde (avaliacao)
- [ ] Ícones ou marcadores visuais
- [ ] Cronologia de cima para baixo
- [ ] Arquivos listados com ícone 📎

**CA-6: Auto-fechamento de popup**
- [ ] Após impressão concluída: fecha automaticamente
- [ ] Após cancelar: fecha automaticamente
- [ ] Event listener: `window.onafterprint`

**CA-7: Responsividade de tabelas**
- [ ] Tabelas grandes quebram em múltiplas páginas
- [ ] Headers repetidos em cada página (optional)
- [ ] Sem corte de linhas no meio

**Regras de Negócio:**

**RN-109:** PDFs devem seguir **identidade visual CNMP**. Logo, cores institucionais (azul #003366), tipografia adequada.

**RN-110:** Ofício de Publicação usa **Times New Roman** e formatação formal. Documento tem valor oficial.

**RN-111:** Gráficos são convertidos para **imagem estática** (PNG base64). Canvas não é printable diretamente.

**RN-112:** Timeline preserva **código de cores** mesmo em impressão P&B. Usar bordas e ícones como alternativa.

**RN-113:** PDF gerado via **diálogo nativo do navegador**. Não há biblioteca externa (jsPDF, pdfmake) no protótipo.

---

### UC-027: Visualizar Histórico de Interações

**Ator:** Admin, User

**Objetivo:** Consultar timeline completa de uma proposição com todas as publicações, comprovações e avaliações.

**Pré-condições:**
- Usuário autenticado
- Proposição com histórico existente (`historico.length > 0`)

**Fluxo Principal:**

1. Usuário acessa lista de proposições ou detalhes de proposição
2. Sistema exibe botão "👁️ Visualizar" ou "📋 Ver Detalhes"
3. Usuário clica no botão
4. Sistema abre modal de detalhes (ou navega para página dedicada)
5. Sistema renderiza seção "Histórico de Interações" com timeline vertical
6. Sistema ordena histórico cronologicamente:
   ```javascript
   const historicoOrdenado = proposicao.historico.sort((a, b) =>
     new Date(a.data) - new Date(b.data)
   );
   ```
7. Sistema renderiza cada entrada do histórico:
   - **Publicação (laranja):**
     - Ícone: 📤
     - Data formatada: DD/MM/AAAA HH:MM
     - Usuário: "Corregedoria Nacional"
     - Descrição: "Proposição publicada para [MP]"
     - Observações (se existirem)
     - **Prazo de Comprovação destacado:** "Prazo: DD/MM/AAAA"
     - Status: `['pendente', *]` → `['aguardando_comprovacao', *]`
   - **Comprovação (azul):**
     - Ícone: 📎
     - Data formatada
     - Usuário: "MPBA - Ministério Público do Estado da Bahia"
     - Descrição do adimplemento (textarea completa)
     - Observações adicionais
     - **Lista de arquivos anexados:**
       - Ícone 📄 + nome do arquivo
       - Link (simulado no protótipo)
     - Status: `['aguardando_comprovacao', *]` → `['em_analise', *]`
   - **Avaliação (verde):**
     - Ícone: ⚖️
     - Data formatada
     - Usuário: "Corregedoria Nacional"
     - Descrição: "Avaliação realizada: [Finalizada/Parcial/Em Andamento/Prejudicada]"
     - Parecer do avaliador (textarea completa)
     - Status: `['em_analise', *]` → `['encerrada', 'finalizada']` (ou pendente se parcial/em_andamento)
   - **Complementação (roxo):**
     - Ícone: 🔄
     - Data formatada
     - Usuário: "Corregedoria Nacional"
     - Descrição: "Solicitação de complementação"
     - Observações: Detalhamento do que falta
     - Status: `['em_analise', *]` → `['aguardando_comprovacao', *]`
8. Sistema exibe marcador de "Hoje" se houver interações recentes
9. Sistema destaca última interação com borda mais grossa
10. Usuário visualiza cronologia completa

**Fluxos Alternativos:**

**FA-1: Histórico vazio**
- 5a. Sistema detecta `historico.length === 0`
- 5b. Sistema exibe mensagem: "Nenhuma interação registrada para esta proposição."
- 5c. Sistema exibe ilustração de timeline vazia

**FA-2: Múltiplas publicações (republicação)**
- 7a. Sistema detecta 2+ entradas tipo 'publicacao' no histórico
- 7b. Sistema numera publicações: "1ª Publicação", "2ª Publicação (Republicação)", etc.
- 7c. Cada publicação exibe seu respectivo prazoComprovacao
- 7d. Timeline mostra claramente fluxo: publicacao → comprovacao → avaliacao parcial → republicacao → ...

**FA-3: Comprovação com múltiplos arquivos**
- 7a. Entrada tipo 'comprovacao' tem `arquivos.length > 1`
- 7b. Sistema renderiza lista vertical de arquivos:
   ```html
   <div class="arquivos-lista">
     <p>📎 documento1.pdf</p>
     <p>📎 relatorio_evidencias.docx</p>
     <p>📎 fotos_comprobatorias.zip</p>
   </div>
   ```
- 7c. Ícone 📎 diferenciado para cada tipo de arquivo (opcional)

**FA-4: Filtrar histórico por tipo**
- 5a. Sistema exibe botões de filtro acima da timeline:
   - "Todos" (padrão)
   - "Publicações"
   - "Comprovações"
   - "Avaliações"
- 5b. Usuário clica em "Comprovações"
- 5c. Sistema filtra: `historico.filter(h => h.tipo === 'comprovacao')`
- 5d. Timeline exibe apenas comprovações

**FA-5: Expandir/colapsar entrada**
- 7a. Entradas com descrições longas (>300 caracteres) exibem "Ver mais"
- 7b. Usuário clica em "Ver mais"
- 7c. Texto expande completamente
- 7d. Botão muda para "Ver menos"

**FA-6: Copiar timeline para área de transferência**
- 10a. Usuário clica em botão "📋 Copiar Histórico"
- 10b. Sistema gera texto formatado da timeline:
   ```
   Histórico da Proposição PROP-2024-0001

   📤 Publicação - 01/11/2024 10:00
   Usuário: Corregedoria Nacional
   Prazo: 31/12/2024
   Observações: ...

   📎 Comprovação - 15/12/2024 14:30
   Usuário: MPBA
   Arquivos: documento1.pdf, foto.jpg
   Descrição: ...
   ```
- 10c. Sistema copia para clipboard
- 10d. Sistema exibe toast: "✅ Histórico copiado!"

**Pós-condições:**
- Timeline renderizada cronologicamente
- Todas as interações visíveis
- Código de cores aplicado corretamente
- Modal/página permanece aberta para consulta

**Critérios de Aceite:**

**CA-1: Timeline vertical**
- [ ] Linha vertical esquerda conectando entradas
- [ ] Marcador circular colorido por tipo
- [ ] Espaçamento consistente entre entradas (20px)

**CA-2: Código de cores**
- [ ] Publicação: laranja (#ff9800) - marcador e borda
- [ ] Comprovação: azul (#2196f3) - marcador e borda
- [ ] Avaliação: verde (#4caf50) - marcador e borda
- [ ] Complementação: roxo (#9c27b0) - marcador e borda

**CA-3: Ordenação cronológica**
- [ ] Entrada mais antiga no topo
- [ ] Entrada mais recente no final
- [ ] Ordenação por campo `data` (ISO timestamp)

**CA-4: Formatação de data**
- [ ] Padrão brasileiro: DD/MM/AAAA HH:MM
- [ ] Hora exibida para distinguir eventos do mesmo dia
- [ ] Timezone considerado (se aplicável)

**CA-5: Prazo destacado em publicações**
- [ ] Campo "Prazo de Comprovação" em negrito
- [ ] Ícone ⚠️ se prazo vencido
- [ ] Cor vermelha se vencido, verde se vigente

**CA-6: Arquivos anexados**
- [ ] Lista vertical com ícone 📎
- [ ] Nome completo do arquivo exibido
- [ ] Link simulado (protótipo) ou real (produção)

**CA-7: Última entrada destacada**
- [ ] Borda mais grossa (3px vs 1px)
- [ ] Background levemente mais escuro
- [ ] Indicador "Última interação"

**CA-8: Responsividade**
- [ ] Desktop: timeline em coluna única centralizada
- [ ] Mobile: timeline ocupa 100% da largura
- [ ] Textos quebram adequadamente

**Regras de Negócio:**

**RN-114:** Timeline é **ordenada cronologicamente** (FIFO). Entradas mais antigas aparecem primeiro.

**RN-115:** Cada tipo de interação tem **cor única e consistente**. Não alterar paleta arbitrariamente.

**RN-116:** Publicações **sempre exibem prazoComprovacao** destacado. Campo crítico para workflow.

**RN-117:** Comprovações **listam todos os arquivos anexados**. Transparência total para auditoria.

**RN-118:** Histórico é **somente leitura** (append-only). Não há opção de editar ou excluir entradas.

---

## 10. Histórias de Usuário

### Tema: Gestão de Correições

**HU-001: Cadastro de Correição**

**Como** Corregedor Nacional (admin),
**Eu quero** cadastrar uma nova correição com todos os dados relevantes (número, temática, número ELO, tipo, MP, UF, ramo do MP, período),
**Para que** eu possa iniciar o processo de acompanhamento de proposições decorrentes dessa correição.

**Critérios de Aceitação:**

**Given** estou autenticado como admin
**And** estou na página "Nova Correição"
**When** preencho todos os campos obrigatórios:
- Número da Correição (formato COR-AAAA-XX)
- Temática (texto livre, max 500 caracteres)
- Número ELO (formato NNNNNNN-DD.AAAA.J.TT.OOOO)
- Tipo (Ordinária/Extraordinária/OCD/Inspeção)
- MP (MPE/MPU)
- UF (array: 1 estado se MPE, múltiplos se MPU)
- Ramo do MP (dropdown com 27 MPs)
- Data de Início e Data de Fim
**And** clico em "Salvar Correição"
**Then** sistema valida campos obrigatórios
**And** sistema gera ID único para a correição
**And** sistema salva no array `correicoes[]` em localStorage
**And** sistema exibe mensagem: "✅ Correição cadastrada com sucesso!"
**And** sistema redireciona para lista de correições
**And** nova correição aparece na tabela com status 'inativo' (sem proposições ainda)

**Prioridade:** **Must Have**
**Story Points:** 5
**Sprint:** Sprint 1
**Dependências:** Nenhuma (funcionalidade base)

---

**HU-002: Consulta de Correições com Filtros**

**Como** Assessor da Corregedoria (admin),
**Eu quero** visualizar lista de correições com filtros por status (ativo/inativo) e busca textual,
**Para que** eu possa localizar rapidamente correições específicas e monitorar seu andamento.

**Critérios de Aceitação:**

**Given** estou autenticado como admin
**And** estou na página "Correições"
**When** visualizo a tabela de correições
**Then** vejo 13 colunas:
- Número (sortável)
- Temática
- Número ELO
- Tipo
- MP
- UF
- Ramo do MP
- Total de Proposições (sortável)
- Pendente (sortável, colorido se > 0)
- Em Análise (sortável, colorido se > 0)
- Prazo Vencido (sortável, vermelho se > 0)
- Status (badge ativo/inativo)
- Ações (botão "Ver")

**And** posso aplicar filtro de status:
- "Todas (ativas e inativas)" - padrão
- "Apenas Ativas"
- "Apenas Inativas"

**And** posso digitar busca textual (filtra por número, temática, ramo do MP)

**And** posso ordenar por qualquer coluna sortável (clique no header alterna ASC/DESC)

**And** contador exibe: "X correição(ões) encontrada(s)"

**Prioridade:** **Must Have**
**Story Points:** 8
**Sprint:** Sprint 1
**Dependências:** HU-001

---

### Tema: Gestão de Proposições

**HU-003: Cadastro de Proposição**

**Como** Corregedor Nacional (admin),
**Eu quero** cadastrar proposições vinculadas a uma correição com tipo, unidade, membro, descrição, prioridade e tags,
**Para que** eu possa registrar determinações e recomendações a serem cumpridas pelos órgãos correicionados.

**Critérios de Aceitação:**

**Given** estou autenticado como admin
**And** existe pelo menos 1 correição cadastrada
**And** estou na página "Nova Proposição"
**When** preencho os campos:
- Correição (dropdown obrigatório)
- Número (auto-gerado PROP-AAAA-XXXX)
- Tipo (Determinação ou Recomendação)
- Unidade (texto livre, ex: "Promotoria de Justiça de Cachoeira")
- Membro (texto livre, ex: "Dr. João Silva Santos")
- Descrição (textarea, max 5.000 caracteres)
- Prioridade (urgente/alta/normal)
- Tags (checkboxes múltiplas, 11 categorias disponíveis)
**And** clico em "Salvar Proposição"
**Then** sistema valida campos obrigatórios
**And** sistema gera ID único e número sequencial
**And** sistema define status inicial: `['pendente', 'nova']`
**And** sistema inicializa arrays: `rascunhos: []`, `historico: []`
**And** sistema salva no array `proposicoes[]` em localStorage
**And** sistema exibe mensagem: "✅ Proposição cadastrada com sucesso!"
**And** proposição aparece na lista de proposições da correição
**And** contador "Pendente" da correição incrementa em 1

**Prioridade:** **Must Have**
**Story Points:** 5
**Sprint:** Sprint 2
**Dependências:** HU-001

---

**HU-004: Visualização de Proposições por Correição**

**Como** Procurador-Geral de Justiça (user),
**Eu quero** visualizar apenas proposições da minha correição com filtros avançados,
**Para que** eu possa acompanhar as determinações/recomendações aplicáveis ao meu órgão.

**Critérios de Aceitação:**

**Given** estou autenticado como user (ramoMP = MPBA)
**And** acesso página "Proposições" (proposicoes.html)
**When** página carrega
**Then** vejo placeholder: "Selecione uma Correição"
**And** dropdown de correições exibe apenas correições do meu ramoMP (MPBA)
**And** filtros e tabela estão ocultos

**When** seleciono correição "COR-2024-01"
**Then** sistema exibe painel informativo:
- Temática da correição
- Período (data início - data fim)
- Total de proposições

**And** sistema exibe seção de filtros avançados:
- Busca textual (número, unidade, membro, descrição)
- Tipo (Todos/Determinação/Recomendação)
- Status Processual (Todos/Pendente/Aguardando/Em Análise/Encerrada)
- Valoração (Todas/Nova/Finalizada/Parcial/Em Andamento/Prejudicada)
- Tag (11 categorias)
- Prioridade (Todas/Urgente/Alta/Normal)

**And** sistema exibe tabela com 7 colunas:
- Número
- Tipo (badge)
- Unidade
- Descrição (truncada 100 caracteres)
- Tags (badges coloridos)
- Status (2 badges: processual + valoração)
- Ações (👁️ Visualizar, ⚖️ Avaliar, ✏️ Editar)

**And** contador exibe: "X proposição(ões) encontrada(s)"

**Prioridade:** **Must Have**
**Story Points:** 13
**Sprint:** Sprint 2
**Dependências:** HU-003

---

### Tema: Publicação de Proposições

**HU-005: Publicação em Lote**

**Como** Corregedor Nacional (admin),
**Eu quero** publicar múltiplas proposições simultaneamente com um único prazo de comprovação,
**Para que** eu possa notificar os órgãos correicionados de forma eficiente.

**Critérios de Aceitação:**

**Given** estou autenticado como admin
**And** acesso página "Publicar Proposições" (publicacao.html)
**And** seleciono correição "COR-2024-01"
**When** sistema exibe tabela de proposições pendentes:
- Apenas proposições com status `['pendente', *]` aparecem
- Checkbox em cada linha para seleção individual
- Master checkbox no header da tabela
- Colunas: Checkbox, Número, Tipo, Unidade, Descrição, Tags, Prioridade, Ações

**And** marco 3 proposições (checkboxes individuais)
**Then** sistema exibe contador: "3 selecionada(s)"
**And** sistema exibe formulário de publicação:
- Campo "Prazo de Comprovação" (date, obrigatório, min: hoje + 1 dia)
- Campo "Observações" (textarea, opcional, max 1.000 caracteres)
- Botão "Publicar 3 Proposição(ões)"

**When** preencho prazo: "31/01/2025"
**And** adiciono observações: "Prazo para envio de comprovação documental"
**And** clico em "Publicar 3 Proposição(ões)"
**Then** sistema exibe diálogo de confirmação:
- "Confirma publicação de 3 proposições com prazo 31/01/2025?"

**When** confirmo
**Then** sistema itera sobre as 3 proposições selecionadas:
- Atualiza status: `['aguardando_comprovacao', valoracao_atual]`
- Define `prazoComprovacao: '2025-01-31'`
- Define `dataPublicacao: '2025-01-10'` (hoje)
- Adiciona entrada no `historico[]`:
  ```javascript
  {
    tipo: 'publicacao',
    data: '2025-01-10T10:00:00Z',
    usuario: 'Corregedoria Nacional',
    descricao: 'Proposição publicada para MPBA',
    observacoes: 'Prazo para envio de comprovação documental',
    prazoComprovacao: '2025-01-31',
    statusAnterior: ['pendente', 'nova'],
    statusNovo: ['aguardando_comprovacao', 'nova']
  }
  ```

**And** sistema salva no localStorage
**And** sistema exibe mensagem: "✅ 3 proposição(ões) publicadas! E-mail enviado automaticamente."
**And** sistema limpa seleção e reseta formulário
**And** tabela atualiza (3 proposições publicadas removidas da lista de pendentes)
**And** contador "Aguardando Comprovação" da correição incrementa em 3

**Prioridade:** **Must Have**
**Story Points:** 13
**Sprint:** Sprint 3
**Dependências:** HU-003

---

### Tema: Comprovação de Proposições

**HU-006: Envio de Comprovação pelo Correicionado**

**Como** Promotor de Justiça (user),
**Eu quero** enviar comprovação de cumprimento de proposição com descrição e anexos,
**Para que** eu possa demonstrar o adimplemento das determinações da Corregedoria.

**Critérios de Aceitação:**

**Given** estou autenticado como user (ramoMP = MPBA)
**And** existe proposição PROP-2024-0002 com status `['aguardando_comprovacao', 'nova']` vinculada ao MPBA
**And** clico em "Adicionar" na lista de "Enviar Comprovação"
**When** sistema redireciona para `comprovacao.html?id=2`
**Then** página exibe 3 seções:

**Seção 1: Informações da Proposição**
- Correição vinculada (número, temática, órgão)
- Número, tipo, unidade, membro
- Descrição completa
- Status atual (badges)
- Tags

**Seção 2: Alerta de Prazo**
- Data de publicação
- Prazo de comprovação: 31/01/2025
- Dias restantes: 21 dias
- Ícone ⚠️ vermelho se prazo < 7 dias

**Seção 3: Formulário de Comprovação**
- Campo "Descrição do Adimplemento" (textarea, obrigatório, max 7.500 caracteres)
- Contador de caracteres (verde → amarelo → vermelho)
- Campo "Observações Adicionais" (textarea, opcional, max 1.000 caracteres)
- Área de upload drag-and-drop:
  - "Arraste arquivos aqui ou clique para selecionar"
  - Lista de arquivos selecionados com tamanho e botão remover
- Botão "Salvar como Rascunho" (secundário)
- Botão "Enviar Comprovação" (primário)

**When** preencho descrição: "Implementamos sistema de gestão eletrônica de documentos (GED) em 100% das unidades..."
**And** adiciono observação: "Treinamento da equipe concluído em dezembro/2024"
**And** seleciono 2 arquivos: sistema_ged_implantado.pdf, relatorio_treinamento.pdf
**And** clico em "Enviar Comprovação"
**Then** sistema valida campos obrigatórios
**And** sistema exibe diálogo de confirmação:
- "Confirma envio de comprovação para proposição PROP-2024-0002?"
- "Após envio, a comprovação será analisada pela Corregedoria Nacional."

**When** confirmo
**Then** sistema cria entrada no histórico:
```javascript
{
  tipo: 'comprovacao',
  data: '2025-01-10T14:30:00Z',
  usuario: 'MPBA - Ministério Público do Estado da Bahia',
  descricao: 'Implementamos sistema de gestão eletrônica...',
  observacoes: 'Treinamento da equipe concluído...',
  arquivos: ['sistema_ged_implantado.pdf', 'relatorio_treinamento.pdf']
}
```

**And** sistema atualiza status: `proposicao.status = ['em_analise', 'nova']`
**And** sistema limpa rascunho: `proposicao.rascunhos = []`
**And** sistema salva no localStorage
**And** sistema exibe mensagem: "✅ Comprovação enviada com sucesso!"
**And** sistema redireciona para `index.html#enviar` após 2 segundos
**And** proposição não aparece mais na lista "Enviar Comprovação"
**And** proposição entra na fila de avaliação do admin

**Prioridade:** **Must Have**
**Story Points:** 13
**Sprint:** Sprint 4
**Dependências:** HU-005

---

**HU-007: Salvar Rascunho de Comprovação**

**Como** Promotor de Justiça (user),
**Eu quero** salvar progresso da comprovação como rascunho sem enviar definitivamente,
**Para que** eu possa reunir documentos adicionais antes do envio final.

**Critérios de Aceitação:**

**Given** estou preenchendo formulário de comprovação (comprovacao.html?id=2)
**And** descrição preenchida parcialmente: "Implementamos sistema GED..."
**And** 1 arquivo selecionado: sistema_implantacao.pdf
**When** clico em "Salvar como Rascunho"
**Then** sistema valida campo de descrição (mínimo 50 caracteres)
**And** sistema cria objeto rascunho:
```javascript
{
  descricao: 'Implementamos sistema GED...',
  observacoes: '',
  arquivos: ['sistema_implantacao.pdf'],
  dataModificacao: '2025-01-08T16:00:00Z'
}
```

**And** sistema verifica se já existe rascunho anterior:
- Se sim: substitui rascunho anterior
- Se não: adiciona ao array `proposicao.rascunhos`

**And** sistema **NÃO** altera status da proposição (permanece `aguardando_comprovacao`)
**And** sistema **NÃO** cria entrada no histórico
**And** sistema salva no localStorage
**And** sistema exibe mensagem: "✅ Rascunho salvo com sucesso!"
**And** sistema redireciona para `index.html#enviar`

**When** retorno para "Enviar Comprovação"
**Then** botão da proposição muda de "Adicionar" para "Editar"
**And** badge "Rascunho" aparece ao lado do número da proposição

**When** clico em "Editar"
**Then** formulário carrega com dados do rascunho:
- Descrição pré-preenchida
- Observações pré-preenchidas
- Arquivos listados
- Indicador visual: "📝 Editando rascunho salvo em 08/01/2025 16:00"

**Prioridade:** **Should Have**
**Story Points:** 8
**Sprint:** Sprint 4
**Dependências:** HU-006

---

### Tema: Avaliação de Comprovações

**HU-008: Avaliar Comprovação como Finalizada**

**Como** Assessor da Corregedoria (admin),
**Eu quero** avaliar comprovação enviada e defini-la como finalizada,
**Para que** o ciclo da proposição seja encerrado com sucesso.

**Critérios de Aceitação:**

**Given** estou autenticado como admin
**And** existe proposição PROP-2024-0009 com status `['em_analise', 'nova']`
**And** histórico contém comprovação enviada pelo correicionado
**And** acesso página "Avaliar Comprovações"
**When** clico em "Avaliar" na linha da proposição
**Then** sistema redireciona para `avaliacao.html?id=9`
**And** página exibe:

**Seção 1: Informações da Proposição**
- Todos os metadados da proposição

**Seção 2: Histórico Completo**
- Timeline vertical com publicacao + comprovacao (colorido)

**Seção 3: Comprovação Atual**
- Data do envio: 15/12/2024 14:30
- Usuário: MPRJ - Ministério Público do Estado do Rio de Janeiro
- Descrição do adimplemento (texto completo)
- Observações adicionais
- Arquivos anexados: relatorio_sistema.pdf, prints_evidencias.png

**Seção 4: Formulário de Avaliação**
- **Decisão (radio buttons em cards visuais):**
  - ✅ Finalizada (verde)
  - ⚠️ Parcial (laranja)
  - ❌ Em Andamento (vermelho)
  - ⊗ Prejudicada (cinza)
- **Parecer (textarea obrigatório, max 7.500 caracteres):**
  - Contador em tempo real
  - Placeholder: "Justifique sua decisão detalhadamente..."

**When** seleciono "✅ Finalizada"
**And** redijo parecer: "Comprovação analisada e considerada satisfatória. O sistema GED foi implementado conforme determinado, com evidências claras de operação em 100% das unidades. Treinamento da equipe realizado e documentado. Determinação cumprida integralmente."
**And** clico em "Enviar Avaliação"
**Then** sistema valida campos obrigatórios
**And** sistema exibe diálogo de confirmação:
- "Confirma avaliação como FINALIZADA para proposição PROP-2024-0009?"
- "Esta ação não poderá ser desfeita."

**When** confirmo
**Then** sistema atualiza status: `proposicao.status = ['encerrada', 'finalizada']`
**And** sistema cria entrada no histórico:
```javascript
{
  tipo: 'avaliacao',
  data: '2025-01-10T09:15:00Z',
  usuario: 'Corregedoria Nacional',
  descricao: 'Avaliação realizada: Finalizada',
  observacoes: 'Comprovação analisada e considerada satisfatória...',
  statusAnterior: ['em_analise', 'nova'],
  statusNovo: ['encerrada', 'finalizada']
}
```

**And** sistema salva no localStorage
**And** sistema exibe mensagem: "✅ Avaliação registrada com sucesso!"
**And** sistema redireciona para `index.html#avaliar` após 2 segundos
**And** proposição não aparece mais na fila de avaliação
**And** contador "Encerrada" da correição incrementa em 1
**And** status da correição recalculado automaticamente

**Prioridade:** **Must Have**
**Story Points:** 13
**Sprint:** Sprint 5
**Dependências:** HU-006

---

**HU-009: Avaliar Comprovação como Parcial e Republicar**

**Como** Corregedor Nacional (admin),
**Eu quero** avaliar comprovação como parcial e republicar com novo prazo,
**Para que** o correicionado possa complementar o cumprimento da proposição.

**Critérios de Aceitação:**

**Given** estou avaliando proposição PROP-2024-0004 em `avaliacao.html?id=4`
**And** comprovação enviada está incompleta
**When** seleciono "⚠️ Parcial"
**And** redijo parecer: "Comprovação parcialmente aceita. Sistema implementado em apenas 60% das unidades. Necessária conclusão do rollout nas unidades restantes e envio de relatório atualizado."
**And** clico em "Enviar Avaliação"
**And** confirmo diálogo
**Then** sistema atualiza status: `proposicao.status = ['pendente', 'parcial']`
**And** sistema adiciona avaliação ao histórico:
```javascript
{
  tipo: 'avaliacao',
  data: '2025-01-10T10:00:00Z',
  usuario: 'Corregedoria Nacional',
  descricao: 'Avaliação realizada: Parcial',
  observacoes: 'Comprovação parcialmente aceita...',
  statusAnterior: ['em_analise', 'nova'],
  statusNovo: ['pendente', 'parcial']
}
```

**And** sistema salva no localStorage
**And** proposição **sai da fila de avaliação**
**And** proposição **entra na fila de publicação** (status pendente)

**When** acesso "Publicar Proposições" (publicacao.html)
**And** seleciono correição da proposição
**Then** proposição PROP-2024-0004 aparece na lista de pendentes
**And** badge de valoração exibe "Parcial" (laranja)

**When** marco checkbox da proposição
**And** defino novo prazo: "28/02/2025"
**And** adiciono observação: "Republicação para conclusão do rollout restante"
**And** clico em "Publicar 1 Proposição"
**And** confirmo
**Then** sistema cria **nova entrada de publicação** no histórico:
```javascript
{
  tipo: 'publicacao',
  data: '2025-01-10T11:00:00Z',
  usuario: 'Corregedoria Nacional',
  descricao: 'Proposição republicada para MPBA',
  observacoes: 'Republicação para conclusão do rollout restante',
  prazoComprovacao: '2025-02-28',
  statusAnterior: ['pendente', 'parcial'],
  statusNovo: ['aguardando_comprovacao', 'parcial']
}
```

**And** sistema atualiza status: `proposicao.status = ['aguardando_comprovacao', 'parcial']`
**And** histórico agora tem: publicacao inicial → comprovacao → avaliacao parcial → **republicacao** (4 entradas)
**And** proposição volta para lista "Enviar Comprovação" do correicionado
**And** correicionado pode enviar nova comprovação complementar

**Prioridade:** **Must Have**
**Story Points:** 13
**Sprint:** Sprint 5
**Dependências:** HU-008, HU-005

---

### Tema: Dashboard e Relatórios

**HU-010: Visualizar Dashboard Consolidado com Filtro**

**Como** Corregedor Nacional (admin),
**Eu quero** visualizar dashboard com métricas consolidadas e gráficos filtráveis por correição,
**Para que** eu possa monitorar o andamento geral do sistema ou focar em correição específica.

**Critérios de Aceitação:**

**Given** estou autenticado como admin
**And** sistema possui:
- 5 correições cadastradas
- 13 proposições distribuídas entre elas
**And** acesso página inicial (dashboard)
**When** página carrega
**Then** vejo dropdown "Filtrar por Correição":
- Opção padrão selecionada: "Todas as Correições"
- Lista com 5 correições disponíveis (COR-2024-01 a COR-2024-05)

**And** vejo 5 cartões de estatísticas:
- 🏛️ **Correições Realizadas:** 5
- 🔄 **Correições Ativas:** 3
- 📄 **Total de Proposições:** 13
- 🔥 **Proposições Ativas:** 9 (não encerradas)
- ⚠️ **Prazo Vencido:** 2 (comprovações atrasadas)

**And** vejo 2 gráficos lado a lado:

**Gráfico 1: Fluxo de Trabalho (4 barras)**
- Pendente: 4 (amarelo)
- Aguardando Comprovação: 5 (laranja escuro)
- Em Análise: 1 (azul)
- Encerrada: 3 (azul escuro)

**Gráfico 2: Valoração (5 barras)**
- Nova: 8 (cinza)
- Finalizada: 2 (verde)
- Parcial: 1 (laranja)
- Em Andamento: 0 (vermelho)
- Prejudicada: 2 (cinza escuro)

**When** seleciono "COR-2024-01 - MPBA" no dropdown de filtro
**Then** sistema recalcula TODAS as métricas para apenas essa correição:

**Cartões atualizados:**
- 🏛️ Correições Realizadas: 1
- 🔄 Correições Ativas: 1
- 📄 Total de Proposições: 3
- 🔥 Proposições Ativas: 2
- ⚠️ Prazo Vencido: 0

**Gráfico 1 atualizado (apenas proposições da COR-2024-01):**
- Pendente: 1
- Aguardando Comprovação: 1
- Em Análise: 0
- Encerrada: 1

**Gráfico 2 atualizado:**
- Nova: 2
- Finalizada: 1
- Parcial: 0
- Em Andamento: 0
- Prejudicada: 0

**And** ambos os gráficos redesenham com animação suave
**And** filtro persiste ao navegar entre páginas (mesma sessão)

**When** seleciono "Todas as Correições" novamente
**Then** métricas voltam para valores agregados
**And** gráficos atualizam para dados completos

**Prioridade:** **Should Have**
**Story Points:** 13
**Sprint:** Sprint 6
**Dependências:** HU-001, HU-003, HU-005, HU-006, HU-008

---

## 11. Matriz de Rastreabilidade

### Requisitos Funcionais → Casos de Uso → Interfaces

| **ID Requisito** | **Requisito Funcional** | **Casos de Uso** | **Interfaces** | **Status** |
|------------------|-------------------------|------------------|----------------|------------|
| **RF-001** | Sistema deve permitir login de usuários com dois perfis (admin/user) | UC-001 | index.html (modal login) | ✅ Implementado |
| **RF-002** | Sistema deve cadastrar correições com todos os campos (número, temática, ELO, tipo, MP, UF, ramo, período) | UC-004 | index.html#cadastroCorreicao | ✅ Implementado |
| **RF-003** | Sistema deve listar correições com filtros e ordenação | UC-005 | index.html#correicoes | ✅ Implementado |
| **RF-004** | Sistema deve exibir detalhes de correição com breakdown de status | UC-006 | Modal de detalhes | ✅ Implementado |
| **RF-005** | Sistema deve permitir edição de correições | UC-007 | Modal de edição | ⚠️ Parcial |
| **RF-006** | Sistema deve permitir exclusão de correições | UC-008 | Modal de confirmação | ⚠️ Parcial |
| **RF-007** | Sistema deve cadastrar proposições vinculadas a correições | UC-009 | index.html#cadastro | ✅ Implementado |
| **RF-008** | Sistema deve listar proposições por correição com filtros avançados | UC-010 | proposicoes.html | ✅ Implementado |
| **RF-009** | Sistema deve permitir edição de proposições | UC-011 | proposicoes.html (modal) | ✅ Implementado |
| **RF-010** | Sistema deve exibir detalhes de proposição com timeline | UC-012 | proposicoes.html (modal) | ✅ Implementado |
| **RF-011** | Sistema deve permitir exclusão de proposições | UC-013 | Modal de confirmação | ⚠️ Parcial |
| **RF-012** | Sistema deve publicar proposições em lote com prazo único | UC-014 | publicacao.html | ✅ Implementado |
| **RF-013** | Sistema deve permitir cancelamento de publicação | UC-015 | publicacao.html | ⚠️ Parcial |
| **RF-014** | Sistema deve exibir proposições aguardando comprovação para user | UC-016 | index.html#enviar | ✅ Implementado |
| **RF-015** | Sistema deve permitir salvar rascunho de comprovação | UC-017 | comprovacao.html | ✅ Implementado |
| **RF-016** | Sistema deve permitir envio de comprovação com anexos | UC-018 | comprovacao.html | ✅ Implementado |
| **RF-017** | Sistema deve listar proposições em análise para admin | UC-019 | index.html#avaliar | ✅ Implementado |
| **RF-018** | Sistema deve permitir avaliação com 4 valorações | UC-020 | avaliacao.html | ✅ Implementado |
| **RF-019** | Sistema deve permitir solicitação de complementação | UC-021 | avaliacao.html | ❌ Não implementado |
| **RF-020** | Sistema deve permitir encerramento administrativo | UC-022 | publicacao.html | ❌ Não implementado |
| **RF-021** | Sistema deve exibir dashboard consolidado | UC-023 | index.html#dashboard | ✅ Implementado |
| **RF-022** | Sistema deve permitir filtros combinados | UC-024 | proposicoes.html | ✅ Implementado |
| **RF-023** | Sistema deve exportar dados em JSON | UC-025 | Múltiplas páginas | ✅ Implementado |
| **RF-024** | Sistema deve exportar relatórios em PDF | UC-026 | Múltiplas páginas | ✅ Implementado |
| **RF-025** | Sistema deve exibir timeline de histórico | UC-027 | Modal de detalhes | ✅ Implementado |

**Legenda:**
- ✅ **Implementado:** Funcionalidade completa e testada
- ⚠️ **Parcial:** Funcionalidade básica implementada, mas falta polimento
- ❌ **Não implementado:** Funcionalidade planejada mas não desenvolvida no protótipo

---

### Histórias de Usuário → Casos de Uso

| **História** | **Caso de Uso** | **Sprint** | **Prioridade** | **Status** |
|--------------|-----------------|------------|----------------|------------|
| HU-001 | UC-004 | Sprint 1 | Must Have | ✅ Completo |
| HU-002 | UC-005, UC-006 | Sprint 1 | Must Have | ✅ Completo |
| HU-003 | UC-009 | Sprint 2 | Must Have | ✅ Completo |
| HU-004 | UC-010, UC-024 | Sprint 2 | Must Have | ✅ Completo |
| HU-005 | UC-014 | Sprint 3 | Must Have | ✅ Completo |
| HU-006 | UC-018 | Sprint 4 | Must Have | ✅ Completo |
| HU-007 | UC-017 | Sprint 4 | Should Have | ✅ Completo |
| HU-008 | UC-020 | Sprint 5 | Must Have | ✅ Completo |
| HU-009 | UC-020, UC-014 | Sprint 5 | Must Have | ✅ Completo |
| HU-010 | UC-023 | Sprint 6 | Should Have | ✅ Completo |

---

### Regras de Negócio → Casos de Uso

| **ID Regra** | **Regra de Negócio** | **Casos de Uso** |
|--------------|----------------------|------------------|
| RN-001 a RN-010 | Autenticação e navegação | UC-001, UC-002, UC-003 |
| RN-011 a RN-030 | Gestão de correições | UC-004, UC-005, UC-006, UC-007, UC-008 |
| RN-031 a RN-051 | Gestão de proposições | UC-009, UC-010, UC-011, UC-012, UC-013 |
| RN-052 a RN-058 | Publicação em lote | UC-014, UC-015 |
| RN-059 a RN-073 | Comprovação | UC-016, UC-017, UC-018 |
| RN-074 a RN-093 | Avaliação | UC-019, UC-020, UC-021, UC-022 |
| RN-094 a RN-118 | Consultas e relatórios | UC-023, UC-024, UC-025, UC-026, UC-027 |

---

**Fim da Parte 6.3**

---

**🎉 Item 6 - Casos de Uso e Histórias de Usuário: COMPLETO**
